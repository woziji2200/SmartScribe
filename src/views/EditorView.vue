<template>
    <div style="display: flex;flex-direction: column;  position: relative;" class="editview">
        <div class="tools print">
            <transition>
                <div v-show="store.isAI" class='ai-tip'>
                    Ê≠£Âú®ÁîüÊàê‰∏≠üöÄ
                    <el-button @click="store.ctrl.abort(); store.isAI = false">ÂÅúÊ≠¢ËæìÂá∫</el-button>
                </div>
            </transition>


            <div class="top">
                <el-tabs type="border-card">
                    <el-tab-pane class="top-item">
                        <template #label>
                            <font-awesome-icon icon="home" style="margin-right: 10px;" />È¶ñÈ°µ
                        </template>
                        <span class="top-button" @click="GotoHome()">
                            <svg t="1720251596014" class="icon" viewBox="0 0 1024 1024" version="1.1"
                                xmlns="http://www.w3.org/2000/svg" p-id="12898" width="200" height="200">
                                <path
                                    d="M646.4 992H377.6v-339.2c0-19.2 19.2-32 38.4-32h185.6c19.2 0 38.4 12.8 38.4 32v339.2h6.4z"
                                    fill="#BAD4FF" p-id="12899"></path>
                                <path
                                    d="M672 1011.2H358.4v-358.4c0-32 25.6-51.2 64-51.2h185.6c32 0 64 25.6 64 51.2v358.4z m-268.8-44.8h224v-313.6s-6.4-6.4-19.2-6.4H422.4c-12.8 0-19.2 6.4-19.2 6.4v313.6z"
                                    fill="#4E8CEE" p-id="12900"></path>
                                <path
                                    d="M512 6.4l505.6 454.4-32 32-76.8-70.4v595.2H115.2V428.8l-76.8 64-25.6-32L512 6.4zM857.6 384L512 64 160 384v588.8h704L857.6 384z"
                                    fill="#4E8CEE" p-id="12901"></path>
                                <path
                                    d="M915.2 1024H108.8V441.6l-70.4 64-38.4-44.8 6.4-6.4 492.8-448 6.4-6.4 6.4 6.4 512 454.4-38.4 44.8-70.4-64V1024z m-793.6-12.8H896V409.6l83.2 76.8 19.2-19.2L512 19.2 19.2 460.8l19.2 25.6 83.2-76.8v601.6z m748.8-32H147.2V384L512 51.2l352 320h6.4v608z m-704-12.8h691.2V384L512 76.8 166.4 390.4v576z"
                                    fill="#4E8CEE" p-id="12902"></path>
                                <path
                                    d="M390.4 403.2H217.6c-6.4 0-6.4 0-6.4 6.4v96h179.2c6.4 0 6.4 0 6.4-6.4l-6.4-96c6.4 6.4 6.4 0 0 0z"
                                    fill="#BAD4FF" p-id="12903"></path>
                            </svg>
                            È¶ñÈ°µ
                        </span>
                        <span class="top-button" @click="NewFile">
                            <svg t="1720251817605" class="icon" viewBox="0 0 1024 1024" version="1.1"
                                xmlns="http://www.w3.org/2000/svg" p-id="22599" width="200" height="200">
                                <path
                                    d="M1024 512c0 282.72-229.28 512-512 512S0 794.72 0 512 229.28 0 512 0s512 229.28 512 512"
                                    fill="#5A89FF" p-id="22600"></path>
                                <path d="M471.552 685.056l0.32-243.52 48.64 0.064-0.32 243.52z" fill="#FFFFFF"
                                    p-id="22601"></path>
                                <path d="M373.92 538.88h243.52v48.64H373.92z" fill="#FFFFFF" p-id="22602"></path>
                                <path
                                    d="M771.84 861.12H252.16c-13.44 0-24.32-10.88-24.32-24.32V187.2c0-13.44 10.88-24.32 24.32-24.32h379.04c6.88 0 13.28 2.88 17.92 7.84l140.64 153.12c4.16 4.48 6.4 10.4 6.4 16.48V836.8c0 13.44-10.88 24.32-24.32 24.32z m-495.36-48.64h470.88V349.92l-126.88-138.24h-344v600.8z"
                                    fill="#FFFFFF" p-id="22603"></path>
                                <path
                                    d="M771.84 364.8l-140.64-0.16c-13.44 0-24.32-10.88-24.32-24.32v-152.96h48.64v128.64l116.32 0.16v48.64z"
                                    fill="#FFFFFF" p-id="22604"></path>
                            </svg>
                            Êñ∞Âª∫
                        </span>
                        <span class="top-button" @click="SaveServer">
                            <svg t="1720251860839" class="icon" viewBox="0 0 1024 1024" version="1.1"
                                xmlns="http://www.w3.org/2000/svg" p-id="25652" width="200" height="200">
                                <path
                                    d="M137.90231 0C110.10583 0.70144 87.74167 23.10144 87.04023 50.93376V968.3456a48.70656 48.70656 0 0 0 15.27296 35.6352 49.9712 49.9712 0 0 0 35.58912 15.29856h746.33728a48.64 48.64 0 0 0 35.58912-15.29344 50.37056 50.37056 0 0 0 15.27296-35.64032V288.7168L646.72791 0H137.90231z"
                                    fill="#6CCBFF" p-id="25653"></path>
                                <path
                                    d="M935.10167 288.7168h-237.44512c-27.82208-0.6656-50.2272-23.07584-50.92864-50.93376V0l288.37376 288.7168z"
                                    fill="#C4EAFF" p-id="25654"></path>
                                <path
                                    d="M354.16599 542.78656h89.04192v144.3584a17.47456 17.47456 0 0 0 16.9984 17.01888h101.72928a17.47456 17.47456 0 0 0 16.9984-17.01888v-144.3584h89.0368a7.3728 7.3728 0 0 0 7.63904-5.12c1.1776-3.18464 0.512-6.7584-1.72544-9.30816L522.95703 383.86688a19.10784 19.10784 0 0 0-11.88352-5.12 15.39584 15.39584 0 0 0-11.88864 5.12L348.26263 528.22528a7.58784 7.58784 0 0 0-1.72544 9.30816c1.23904 3.1232 4.2752 5.16608 7.63392 5.12v0.13312z m368.9216 220.8256H299.05431a16.99328 16.99328 0 0 0-15.60064 8.17152 17.04448 17.04448 0 0 0 0 17.63328 16.99328 16.99328 0 0 0 15.60064 8.17152h424.03328a17.01376 17.01376 0 0 0 15.93344-16.98816 17.01376 17.01376 0 0 0-15.93344-16.98816z"
                                    fill="#FFFFFF" p-id="25655"></path>
                            </svg>
                            ‰øùÂ≠ò
                        </span>
                        <span class="top-button" @click="SaveLocal">
                            <svg t="1720251915330" class="icon" viewBox="0 0 1024 1024" version="1.1"
                                xmlns="http://www.w3.org/2000/svg" p-id="28593" width="200" height="200">
                                <path d="M896 514.2V896H128V514.2H64V960h896V514.2z" fill="#727272" p-id="28594"></path>
                                <path d="M480 644.4V64h64v580.3l182.8-196.5 46.9 43.7L512 772.6 250.3 491.5l46.9-43.7z"
                                    fill="#5280C1" p-id="28595"></path>
                            </svg>
                            ‰∏ãËΩΩ
                        </span>
                        <span class="top-button" @click="OpenLocal">
                            <svg t="1720251984080" class="icon" viewBox="0 0 1024 1024" version="1.1"
                                xmlns="http://www.w3.org/2000/svg" p-id="39112" width="200" height="200">
                                <path
                                    d="M108.251429 0C77.531429 0 51.2 26.331429 51.2 58.514286v904.045714c0 32.182857 26.331429 58.514286 57.051429 58.514286H914.285714c32.182857 0 57.051429-26.331429 57.051429-58.514286V235.52L741.668571 0H108.251429z"
                                    fill="#1890FF" opacity=".795" p-id="39113"></path>
                                <path
                                    d="M487.131429 365.714286H314.514286c-16.091429 0-29.257143-13.165714-29.257143-29.257143s13.165714-29.257143 29.257143-29.257143h172.617143c16.091429 0 29.257143 13.165714 29.257142 29.257143-1.462857 16.091429-13.165714 29.257143-29.257142 29.257143z m229.668571 177.005714H314.514286c-16.091429 0-29.257143-13.165714-29.257143-29.257143s13.165714-29.257143 29.257143-29.257143h402.285714c16.091429 0 29.257143 13.165714 29.257143 29.257143s-13.165714 29.257143-29.257143 29.257143z m0 177.005714H314.514286c-16.091429 0-29.257143-13.165714-29.257143-29.257143s13.165714-29.257143 29.257143-29.257142h402.285714c16.091429 0 29.257143 13.165714 29.257143 29.257142s-13.165714 29.257143-29.257143 29.257143z"
                                    fill="#E4EEFF" p-id="39114"></path>
                                <path
                                    d="M972.8 236.982857H800.182857c-32.182857 0-57.051429-26.331429-57.051428-58.514286V0L972.8 236.982857z"
                                    fill="#E7F0FF" p-id="39115"></path>
                            </svg>
                            <input type="file" id="OpenLocal2" style="display: none" accept=".smd" @change="OpenLocal2">
                            ÊâìÂºÄ
                        </span>
                        <span class="top-button" @click="SavePDF">
                            <svg t="1720435127098" class="icon" viewBox="0 0 1228 1024" version="1.1"
                                xmlns="http://www.w3.org/2000/svg" p-id="5436" width="200" height="200">
                                <path d="M8.533333 0h1024v1024H8.533333z" fill="#D8D8D8" fill-opacity="0" p-id="5437">
                                </path>
                                <path
                                    d="M285.866667 85.333333H648.533333a149.333333 149.333333 0 0 1 149.333334 149.333334V341.333333a42.666667 42.666667 0 0 1-42.666667 42.666667h-469.333333a42.666667 42.666667 0 0 1-42.666667-42.666667V128a42.666667 42.666667 0 0 1 42.666667-42.666667z"
                                    fill="#4A90E2" fill-opacity=".6" p-id="5438"></path>
                                <path
                                    d="M243.2 640m42.666667 0l469.333333 0q42.666667 0 42.666667 42.666667l0 213.333333q0 42.666667-42.666667 42.666667l-469.333333 0q-42.666667 0-42.666667-42.666667l0-213.333333q0-42.666667 42.666667-42.666667Z"
                                    fill="#4A90E2" p-id="5439"></path>
                                <path
                                    d="M833.408 768v-170.666667H207.658667v170.666667H93.866667a42.666667 42.666667 0 0 1-42.666667-42.666667V298.666667a42.666667 42.666667 0 0 1 42.666667-42.666667h113.792v170.666667h625.749333V256H947.2a42.666667 42.666667 0 0 1 42.666667 42.666667v426.666666a42.666667 42.666667 0 0 1-42.666667 42.666667h-113.792z"
                                    fill="#4A90E2" p-id="5440"></path>
                                <path
                                    d="M123.733333 328.533333m-42.666666 0a42.666667 42.666667 0 1 0 85.333333 0 42.666667 42.666667 0 1 0-85.333333 0Z"
                                    fill="#E02020" p-id="5441"></path>
                            </svg>
                            ÊâìÂç∞
                        </span>
                    </el-tab-pane>
                    <el-tab-pane class="top-item">
                        <template #label>
                            <font-awesome-icon icon="edit" style="margin-right: 10px;" />ÁºñËæë
                        </template>
                        <div class="top-item-class tools-2-1 large-flex" style="max-width: 270px;">
                            <span @click="ChangeShowTools" class="tools-show"><font-awesome-icon
                                    :icon='ShowTools ? "angle-up" : "angle-down"'></font-awesome-icon></span>
                            <span @click="undo" :disabled="!CanUndo"><font-awesome-icon
                                    icon='undo'></font-awesome-icon></span>
                            <span @click="redo" :disabled="!CanRedo"><font-awesome-icon
                                    icon='redo'></font-awesome-icon></span>
                            <span @click="bold" :class="!isBold ? '' : 'tools-select'"><font-awesome-icon
                                    icon='bold'></font-awesome-icon></span>
                            <span @click="italic" :class="!isItalic ? '' : 'tools-select'"><font-awesome-icon
                                    icon='italic'></font-awesome-icon></span>
                            <span @click="underline" :class="!isUnderline ? '' : 'tools-select'"><font-awesome-icon
                                    icon='underline'></font-awesome-icon></span>
                            <span @click="strikethrough"
                                :class="!isStrikethrough ? '' : 'tools-select'"><font-awesome-icon
                                    icon='strikethrough'></font-awesome-icon></span>
                            <span style="width: 70px;">
                                <el-select @change="SetFontSize()" v-model="FontSize2" placeholder="Â≠ó‰ΩìÂ§ßÂ∞è" size="small">
                                    <el-option v-for="item in FontSizeList" :key="item" :label="item" :value="item" />
                                </el-select>
                            </span>
                            <span style="margin-left: 5px;">
                                <pick-colors @change="SetFontColor" v-model:value="FontColor"
                                    :colors="['#000000', '#ff4500', '#ffd700', '#00ced1', '#1e90ff', '#c71585',]" />
                            </span>
                            <span @click="SetLink()" :class="!isLink ? '' : 'tools-select'"><font-awesome-icon
                                    icon='link'></font-awesome-icon></span>
                            <span @click="SetSubscript()" :class="!isSubscript ? '' : 'tools-select'"><font-awesome-icon
                                    icon='subscript'></font-awesome-icon></span>
                            <span @click="SetSuperscript()"
                                :class="!isSuperscript ? '' : 'tools-select'"><font-awesome-icon
                                    icon='superscript'></font-awesome-icon></span>
                            <span @click="editor.commands.toggleBlockquote()" class="tools-span"
                                :class="!editor.isActive('blockquote') ? '' : 'tools-select'"><font-awesome-icon
                                    icon='quote-left'></font-awesome-icon></span>
                        </div>

                        <div class="top-item-class tools-2-1 large-flex" style="max-width: 230px;">
                            <span @click="SetTextAlign('left')"
                                :class="TextAlign2 != 'left' ? '' : 'tools-select'"><font-awesome-icon
                                    icon='align-left'></font-awesome-icon></span>
                            <span @click="SetTextAlign('center')"
                                :class="TextAlign2 != 'center' ? '' : 'tools-select'"><font-awesome-icon
                                    icon='align-center'></font-awesome-icon></span>
                            <span @click="SetTextAlign('right')"
                                :class="TextAlign2 != 'right' ? '' : 'tools-select'"><font-awesome-icon
                                    icon='align-right'></font-awesome-icon></span>
                            <span @click="SetTextAlign('justify')"
                                :class="TextAlign2 != 'justify' ? '' : 'tools-select'"><font-awesome-icon
                                    icon='align-justify'></font-awesome-icon></span>
                            <span @click="SetHeading(1)" :class="Heading2 != 1 ? '' : 'tools-select'">
                                <svg t="1716215843603" class="tools-svg" viewBox="0 0 1024 1024" version="1.1"
                                    xmlns="http://www.w3.org/2000/svg" p-id="1280" width="200" height="200">
                                    <path
                                        d="M584.9 445.3V142.6h86.5v735h-86.5V531.7H152.5v345.9H66.1v-735h86.5v302.6l432.3 0.1zM843.7 877.6v-0.3h-79.8V826h79.8V558.6c-22.5 23.4-49.9 40.4-79.8 49.3v-59.1c17.2-5.2 33.8-12.9 49.1-23 16.2-10.6 30.9-23.7 43.9-38.9h39.9V826h61.7v51.3h-61.7v0.3h-53.1z"
                                        p-id="1281"></path>
                                </svg>
                            </span>
                            <span @click="SetHeading(2)" :class="Heading2 != 2 ? '' : 'tools-select'">
                                <svg t="1716215857033" class="tools-svg" viewBox="0 0 1024 1024" version="1.1"
                                    xmlns="http://www.w3.org/2000/svg" p-id="1446" width="200" height="200">
                                    <path
                                        d="M88 448h400V172c0-24.3 19.7-44 44-44s44 19.7 44 44v680c0 24.3-19.7 44-44 44s-44-19.7-44-44V536H88v316c0 24.3-19.7 44-44 44S0 876.3 0 852V172c0-24.3 19.7-44 44-44s44 19.7 44 44v276z m935.282 448H680c0.479-41.591 10.533-77.923 30.163-108.997 19.63-31.074 46.44-58.084 80.434-81.031 16.279-11.952 33.275-23.544 50.99-34.779 17.714-11.234 33.993-23.305 48.835-36.213 14.842-12.907 27.05-26.89 36.626-41.95 9.576-15.058 14.603-32.388 15.081-51.988 0-9.083-1.077-18.764-3.231-29.042-2.155-10.278-6.344-19.84-12.568-28.683-6.224-8.845-14.842-16.254-25.854-22.23-11.012-5.976-25.375-8.964-43.09-8.964-16.278 0-29.803 3.227-40.576 9.68-10.772 6.455-19.39 15.299-25.854 26.533-6.463 11.235-11.251 24.5-14.363 39.798-3.112 15.298-4.908 31.791-5.386 49.48h-81.87c0-27.728 3.71-53.423 11.13-77.087 7.422-23.664 18.553-44.101 33.395-61.311 14.842-17.21 32.916-30.715 54.222-40.516 21.305-9.8 46.081-14.7 74.33-14.7 30.641 0 56.255 5.02 76.843 15.059 20.587 10.04 37.224 22.707 49.912 38.005 12.688 15.298 21.665 31.91 26.931 49.838 5.267 17.927 7.9 35.018 7.9 51.272 0 20.078-3.112 38.244-9.336 54.498-6.224 16.254-14.603 31.193-25.136 44.818-10.533 13.625-22.502 26.174-35.908 37.647a538.302 538.302 0 0 0-41.653 32.27 1122.27 1122.27 0 0 0-43.09 28.683c-14.364 9.083-27.65 18.166-39.858 27.249-12.209 9.083-22.862 18.525-31.958 28.325-9.097 9.8-15.321 20.198-18.673 31.193h244.894V896z"
                                        p-id="1447"></path>
                                </svg> </span>
                            <span @click="SetHeading(3)" :class="Heading2 != 3 ? '' : 'tools-select'">
                                <svg t="1716215866976" class="tools-svg" viewBox="0 0 1024 1024" version="1.1"
                                    xmlns="http://www.w3.org/2000/svg" p-id="1608" width="200" height="200">
                                    <path
                                        d="M88 448h400V172c0-24.3 19.7-44 44-44s44 19.7 44 44v680c0 24.3-19.7 44-44 44s-44-19.7-44-44V536H88v316c0 24.3-19.7 44-44 44S0 876.3 0 852V172c0-24.3 19.7-44 44-44s44 19.7 44 44v276zM815.551 597.802c13.128 0.47 26.257-0.469 39.385-2.813 13.129-2.344 24.85-6.447 35.165-12.308 10.316-5.86 18.638-13.948 24.968-24.263 6.33-10.315 9.494-22.975 9.494-37.978 0-21.1-7.15-37.978-21.45-50.638-14.301-12.66-32.704-18.989-55.21-18.989-14.066 0-26.257 2.813-36.572 8.44-10.315 5.626-18.872 13.245-25.67 22.857-6.799 9.612-11.84 20.395-15.121 32.352-3.283 11.956-4.69 24.263-4.22 36.923h-80.177c0.938-23.913 5.392-46.066 13.363-66.462 7.97-20.396 18.872-38.095 32.703-53.099 13.832-15.004 30.594-26.725 50.287-35.165C802.188 388.22 824.459 384 849.31 384c19.223 0 38.095 2.813 56.616 8.44 18.52 5.626 35.165 13.831 49.934 24.615 14.77 10.784 26.609 24.498 35.517 41.143 8.909 16.645 13.363 35.75 13.363 57.318 0 24.85-5.626 46.535-16.88 65.055-11.252 18.52-28.835 32-52.747 40.44v1.407c28.132 5.626 50.052 19.575 65.759 41.846 15.707 22.27 23.56 49.348 23.56 81.23 0 23.444-4.688 44.425-14.065 62.946-9.378 18.52-22.037 34.227-37.979 47.12-15.942 12.894-34.462 22.858-55.561 29.89-21.1 7.034-43.37 10.55-66.814 10.55-28.601 0-53.568-4.103-74.902-12.308-21.334-8.205-39.15-19.81-53.451-34.813-14.3-15.004-25.202-33.055-32.704-54.154-7.502-21.099-11.487-44.542-11.956-70.33h80.177c-0.938 30.008 6.447 54.975 22.154 74.902s39.268 29.89 70.682 29.89c26.726 0 49.114-7.62 67.166-22.857 18.051-15.239 27.077-36.923 27.077-65.055 0-19.224-3.751-34.462-11.253-45.715-7.502-11.252-17.348-19.81-29.539-25.67-12.19-5.86-25.905-9.494-41.143-10.901-15.239-1.407-30.828-1.875-46.77-1.407v-59.78z"
                                        p-id="1609"></path>
                                </svg>
                            </span>
                            <span @click="SetHeading(4)" :class="Heading2 != 4 ? '' : 'tools-select'">
                                <svg t="1716215885803" class="tools-svg" viewBox="0 0 1024 1024" version="1.1"
                                    xmlns="http://www.w3.org/2000/svg" p-id="1770" width="200" height="200">
                                    <path
                                        d="M88 448h400V172c0-24.3 19.7-44 44-44s44 19.7 44 44v680c0 24.3-19.7 44-44 44s-44-19.7-44-44V536H88v316c0 24.3-19.7 44-44 44S0 876.3 0 852V172c0-24.3 19.7-44 44-44s44 19.7 44 44v276z m936.246 331.56h-63.298v116.748h-75.957V779.56H674v-79.472L884.991 404h75.957v312.264h63.298v63.296zM735.89 716.264h149.1V499.648h-1.406L735.89 716.264z"
                                        p-id="1771"></path>
                                </svg>
                            </span>
                            <span @click="editor.commands.setHorizontalRule()">
                                <svg t="1720442589110" class="icon" viewBox="0 0 1024 1024" version="1.1"
                                    xmlns="http://www.w3.org/2000/svg" p-id="6077" width="200" height="200">
                                    <path
                                        d="M213.333333 554.666667a42.666667 42.666667 0 0 1 0-85.333334h597.333334a42.666667 42.666667 0 0 1 0 85.333334H213.333333z"
                                        p-id="6078"></path>
                                </svg>
                            </span>

                            <span @click="SetListul" :class="!isListul ? '' : 'tools-select'"><font-awesome-icon
                                    icon='list-ul'></font-awesome-icon></span>
                            <span @click="SetListol" :class="!isListol ? '' : 'tools-select'"><font-awesome-icon
                                    icon='list-ol'></font-awesome-icon></span>
                            <span @click="SetTasks" :class="!isTasks ? '' : 'tools-select'"><font-awesome-icon
                                    icon='tasks'></font-awesome-icon></span>
                            <span @click="SetCode" :class="!isCode ? '' : 'tools-select'"><font-awesome-icon
                                    icon='code'></font-awesome-icon></span>
                        </div>

                        <div class="top-item-class tools-2-1 small-flex"
                            style="width: auto;flex-direction: row;flex-wrap: nowrap;display: flex">
                            <span @click="undo" :disabled="!CanUndo"><font-awesome-icon
                                    icon='undo'></font-awesome-icon></span>
                            <span @click="redo" :disabled="!CanRedo"><font-awesome-icon
                                    icon='redo'></font-awesome-icon></span>
                            <el-dropdown :hide-on-click="false">
                                <span class="el-dropdown-link">
                                    <font-awesome-icon icon='font'></font-awesome-icon>
                                </span>
                                <template #dropdown>
                                    <el-dropdown-item>

                                        <span @click="bold" class="tools-span"
                                            :class="!isBold ? '' : 'tools-select'"><font-awesome-icon
                                                icon='bold'></font-awesome-icon></span>
                                        <span @click="italic" class="tools-span"
                                            :class="!isItalic ? '' : 'tools-select'"><font-awesome-icon
                                                icon='italic'></font-awesome-icon></span>
                                        <span @click="underline" class="tools-span"
                                            :class="!isUnderline ? '' : 'tools-select'"><font-awesome-icon
                                                icon='underline'></font-awesome-icon></span>
                                        <span @click="strikethrough" class="tools-span"
                                            :class="!isStrikethrough ? '' : 'tools-select'"><font-awesome-icon
                                                icon='strikethrough'></font-awesome-icon></span>
                                    </el-dropdown-item>
                                    <el-dropdown-item>
                                        <span style="width: 70px;">
                                            <el-select @change="SetFontSize()" v-model="FontSize2" placeholder="Â≠ó‰ΩìÂ§ßÂ∞è"
                                                size="small">
                                                <el-option v-for="item in FontSizeList" :key="item" :label="item"
                                                    :value="item" />
                                            </el-select>
                                            <span style="margin-left: 5px;">
                                                <pick-colors @change="SetFontColor" v-model:value="FontColor"
                                                    :colors="['#000000', '#ff4500', '#ffd700', '#00ced1', '#1e90ff', '#c71585',]" />
                                            </span>
                                        </span>
                                    </el-dropdown-item>
                                    <el-dropdown-item>

                                        <span @click="SetLink()" class="tools-span"
                                            :class="!isLink ? '' : 'tools-select'"><font-awesome-icon
                                                icon='link'></font-awesome-icon></span>
                                        <span @click="SetSubscript()" class="tools-span"
                                            :class="!isSubscript ? '' : 'tools-select'"><font-awesome-icon
                                                icon='subscript'></font-awesome-icon></span>
                                        <span @click="SetSuperscript()" class="tools-span"
                                            :class="!isSuperscript ? '' : 'tools-select'"><font-awesome-icon
                                                icon='superscript'></font-awesome-icon></span>
                                    </el-dropdown-item>
                                </template>
                            </el-dropdown>

                            <el-dropdown :hide-on-click="false">
                                <span class="el-dropdown-link">
                                    <font-awesome-icon icon='align-justify'></font-awesome-icon>
                                </span>
                                <template #dropdown>
                                    <el-dropdown-item>
                                        <span @click="SetTextAlign('left')" class="tools-span"
                                            :class="TextAlign2 != 'left' ? '' : 'tools-select'"><font-awesome-icon
                                                icon='align-left'></font-awesome-icon></span>
                                        <span @click="SetTextAlign('center')" class="tools-span"
                                            :class="TextAlign2 != 'center' ? '' : 'tools-select'"><font-awesome-icon
                                                icon='align-center'></font-awesome-icon></span>
                                        <span @click="SetTextAlign('right')" class="tools-span"
                                            :class="TextAlign2 != 'right' ? '' : 'tools-select'"><font-awesome-icon
                                                icon='align-right'></font-awesome-icon></span>
                                        <span @click="SetTextAlign('justify')" class="tools-span"
                                            :class="TextAlign2 != 'justify' ? '' : 'tools-select'"><font-awesome-icon
                                                icon='align-justify'></font-awesome-icon></span>
                                    </el-dropdown-item>

                                    <el-dropdown-item>
                                        <span @click="SetHeading(1)" class="tools-span"
                                            :class="Heading2 != 1 ? '' : 'tools-select'">
                                            <svg t="1716215843603" class="tools-svg" viewBox="0 0 1024 1024"
                                                version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="1280" width="200"
                                                height="200">
                                                <path
                                                    d="M584.9 445.3V142.6h86.5v735h-86.5V531.7H152.5v345.9H66.1v-735h86.5v302.6l432.3 0.1zM843.7 877.6v-0.3h-79.8V826h79.8V558.6c-22.5 23.4-49.9 40.4-79.8 49.3v-59.1c17.2-5.2 33.8-12.9 49.1-23 16.2-10.6 30.9-23.7 43.9-38.9h39.9V826h61.7v51.3h-61.7v0.3h-53.1z"
                                                    p-id="1281"></path>
                                            </svg>
                                        </span>
                                        <span @click="SetHeading(2)" class="tools-span"
                                            :class="Heading2 != 2 ? '' : 'tools-select'">
                                            <svg t="1716215857033" class="tools-svg" viewBox="0 0 1024 1024"
                                                version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="1446" width="200"
                                                height="200">
                                                <path
                                                    d="M88 448h400V172c0-24.3 19.7-44 44-44s44 19.7 44 44v680c0 24.3-19.7 44-44 44s-44-19.7-44-44V536H88v316c0 24.3-19.7 44-44 44S0 876.3 0 852V172c0-24.3 19.7-44 44-44s44 19.7 44 44v276z m935.282 448H680c0.479-41.591 10.533-77.923 30.163-108.997 19.63-31.074 46.44-58.084 80.434-81.031 16.279-11.952 33.275-23.544 50.99-34.779 17.714-11.234 33.993-23.305 48.835-36.213 14.842-12.907 27.05-26.89 36.626-41.95 9.576-15.058 14.603-32.388 15.081-51.988 0-9.083-1.077-18.764-3.231-29.042-2.155-10.278-6.344-19.84-12.568-28.683-6.224-8.845-14.842-16.254-25.854-22.23-11.012-5.976-25.375-8.964-43.09-8.964-16.278 0-29.803 3.227-40.576 9.68-10.772 6.455-19.39 15.299-25.854 26.533-6.463 11.235-11.251 24.5-14.363 39.798-3.112 15.298-4.908 31.791-5.386 49.48h-81.87c0-27.728 3.71-53.423 11.13-77.087 7.422-23.664 18.553-44.101 33.395-61.311 14.842-17.21 32.916-30.715 54.222-40.516 21.305-9.8 46.081-14.7 74.33-14.7 30.641 0 56.255 5.02 76.843 15.059 20.587 10.04 37.224 22.707 49.912 38.005 12.688 15.298 21.665 31.91 26.931 49.838 5.267 17.927 7.9 35.018 7.9 51.272 0 20.078-3.112 38.244-9.336 54.498-6.224 16.254-14.603 31.193-25.136 44.818-10.533 13.625-22.502 26.174-35.908 37.647a538.302 538.302 0 0 0-41.653 32.27 1122.27 1122.27 0 0 0-43.09 28.683c-14.364 9.083-27.65 18.166-39.858 27.249-12.209 9.083-22.862 18.525-31.958 28.325-9.097 9.8-15.321 20.198-18.673 31.193h244.894V896z"
                                                    p-id="1447"></path>
                                            </svg> </span>
                                        <span @click="SetHeading(3)" class="tools-span"
                                            :class="Heading2 != 3 ? '' : 'tools-select'">
                                            <svg t="1716215866976" class="tools-svg" viewBox="0 0 1024 1024"
                                                version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="1608" width="200"
                                                height="200">
                                                <path
                                                    d="M88 448h400V172c0-24.3 19.7-44 44-44s44 19.7 44 44v680c0 24.3-19.7 44-44 44s-44-19.7-44-44V536H88v316c0 24.3-19.7 44-44 44S0 876.3 0 852V172c0-24.3 19.7-44 44-44s44 19.7 44 44v276zM815.551 597.802c13.128 0.47 26.257-0.469 39.385-2.813 13.129-2.344 24.85-6.447 35.165-12.308 10.316-5.86 18.638-13.948 24.968-24.263 6.33-10.315 9.494-22.975 9.494-37.978 0-21.1-7.15-37.978-21.45-50.638-14.301-12.66-32.704-18.989-55.21-18.989-14.066 0-26.257 2.813-36.572 8.44-10.315 5.626-18.872 13.245-25.67 22.857-6.799 9.612-11.84 20.395-15.121 32.352-3.283 11.956-4.69 24.263-4.22 36.923h-80.177c0.938-23.913 5.392-46.066 13.363-66.462 7.97-20.396 18.872-38.095 32.703-53.099 13.832-15.004 30.594-26.725 50.287-35.165C802.188 388.22 824.459 384 849.31 384c19.223 0 38.095 2.813 56.616 8.44 18.52 5.626 35.165 13.831 49.934 24.615 14.77 10.784 26.609 24.498 35.517 41.143 8.909 16.645 13.363 35.75 13.363 57.318 0 24.85-5.626 46.535-16.88 65.055-11.252 18.52-28.835 32-52.747 40.44v1.407c28.132 5.626 50.052 19.575 65.759 41.846 15.707 22.27 23.56 49.348 23.56 81.23 0 23.444-4.688 44.425-14.065 62.946-9.378 18.52-22.037 34.227-37.979 47.12-15.942 12.894-34.462 22.858-55.561 29.89-21.1 7.034-43.37 10.55-66.814 10.55-28.601 0-53.568-4.103-74.902-12.308-21.334-8.205-39.15-19.81-53.451-34.813-14.3-15.004-25.202-33.055-32.704-54.154-7.502-21.099-11.487-44.542-11.956-70.33h80.177c-0.938 30.008 6.447 54.975 22.154 74.902s39.268 29.89 70.682 29.89c26.726 0 49.114-7.62 67.166-22.857 18.051-15.239 27.077-36.923 27.077-65.055 0-19.224-3.751-34.462-11.253-45.715-7.502-11.252-17.348-19.81-29.539-25.67-12.19-5.86-25.905-9.494-41.143-10.901-15.239-1.407-30.828-1.875-46.77-1.407v-59.78z"
                                                    p-id="1609"></path>
                                            </svg>
                                        </span>
                                        <span @click="SetHeading(4)" class="tools-span"
                                            :class="Heading2 != 4 ? '' : 'tools-select'">
                                            <svg t="1716215885803" class="tools-svg" viewBox="0 0 1024 1024"
                                                version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="1770" width="200"
                                                height="200">
                                                <path
                                                    d="M88 448h400V172c0-24.3 19.7-44 44-44s44 19.7 44 44v680c0 24.3-19.7 44-44 44s-44-19.7-44-44V536H88v316c0 24.3-19.7 44-44 44S0 876.3 0 852V172c0-24.3 19.7-44 44-44s44 19.7 44 44v276z m936.246 331.56h-63.298v116.748h-75.957V779.56H674v-79.472L884.991 404h75.957v312.264h63.298v63.296zM735.89 716.264h149.1V499.648h-1.406L735.89 716.264z"
                                                    p-id="1771"></path>
                                            </svg>
                                        </span>
                                    </el-dropdown-item>
                                    <el-dropdown-item>
                                        <span @click="SetListul" class="tools-span"
                                            :class="!isListul ? '' : 'tools-select'"><font-awesome-icon
                                                icon='list-ul'></font-awesome-icon></span>
                                        <span @click="SetListol" class="tools-span"
                                            :class="!isListol ? '' : 'tools-select'"><font-awesome-icon
                                                icon='list-ol'></font-awesome-icon></span>
                                        <span @click="SetTasks" class="tools-span"
                                            :class="!isTasks ? '' : 'tools-select'"><font-awesome-icon
                                                icon='tasks'></font-awesome-icon></span>
                                        <span @click="SetCode" class="tools-span"
                                            :class="!isCode ? '' : 'tools-select'"><font-awesome-icon
                                                icon='code'></font-awesome-icon></span>
                                    </el-dropdown-item>
                                    <el-dropdown-item>
                                        <span @click="editor.commands.setHorizontalRule();" class="tools-span">
                                            <svg t="1720442589110" class="tools-svg" viewBox="0 0 1024 1024"
                                                version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="6077" width="200"
                                                height="200">
                                                <path
                                                    d="M213.333333 554.666667a42.666667 42.666667 0 0 1 0-85.333334h597.333334a42.666667 42.666667 0 0 1 0 85.333334H213.333333z"
                                                    p-id="6078"></path>
                                            </svg>
                                        </span>
                                    </el-dropdown-item>

                                </template>
                            </el-dropdown>

                        </div>

                        <div class="top-item">
                            <span class="top-button" @click="ShowTree = !ShowTree">
                                <svg t="1720252147624" class="icon" viewBox="0 0 1024 1024" version="1.1"
                                    xmlns="http://www.w3.org/2000/svg" p-id="48899" width="200" height="200">
                                    <path
                                        d="M976 464a48 48 0 1 1 0 96H48a48 48 0 0 1 0-96h928z m0-336a48 48 0 1 1 0 96H48a48 48 0 0 1 0-96h928z"
                                        fill="#0084FF" p-id="48900"></path>
                                    <path
                                        d="M384 800m48 0l544 0q48 0 48 48l0 0q0 48-48 48l-544 0q-48 0-48-48l0 0q0-48 48-48Z"
                                        fill="#0084FF" fill-opacity=".598" p-id="48901"></path>
                                </svg>
                                ÊñáÊ°£Á¥¢Âºï
                            </span>

                            <el-dropdown size="large" :hide-timeout="300">
                                <span class="top-button" @click="isAIOpen = true">
                                    <svg t="1720252191818" class="icon" viewBox="0 0 1024 1024" version="1.1"
                                        xmlns="http://www.w3.org/2000/svg" p-id="53218" width="200" height="200">
                                        <path
                                            d="M424.703646 886.186782H32.55464A32.255973 32.255973 0 0 1 0 853.930808V508.16043c0-17.919985 14.506655-32.255973 32.55464-32.255973h392.106339c18.090652 0 32.55464 14.335988 32.55464 32.255973v345.770378c0.554666 17.407985-14.463988 32.255973-32.511973 32.255974z m-359.594367-65.023946H392.10634v-280.746433H65.109279v280.746433z m926.335228 65.023946h-392.10634a32.255973 32.255973 0 0 1-32.554639-32.255974V508.16043c0-17.919985 14.463988-32.255973 32.511973-32.255973h392.149006c18.090652 0 32.55464 14.335988 32.55464 32.255973v99.41325c0 17.919985-14.506655 32.213306-32.55464 32.213307a32.255973 32.255973 0 0 1-32.554639-32.255973v-67.114611H631.892807v280.746433h327.039727v-89.642592c0-17.919985 14.506655-32.29864 32.55464-32.29864 18.090652 0 32.55464 14.335988 32.554639 32.29864v122.410564c0 17.407985-14.506655 32.255973-32.554639 32.255974zM228.863809 540.416403a34.346638 34.346638 0 0 1-13.951988-3.071997 31.999973 31.999973 0 0 1-15.487987-43.007965L286.719761 310.955261a32.511973 32.511973 0 0 1 43.434631-15.359987 31.999973 31.999973 0 0 1 15.487987 43.007964l-87.338594 183.38118a32.810639 32.810639 0 0 1-29.439976 18.431985z m544.554213 0a31.701307 31.701307 0 0 1-29.439975-18.431985l-87.295928-183.89318a32.29864 32.29864 0 0 1 15.487988-43.050631 32.853306 32.853306 0 0 1 43.391963 15.359988l87.295928 183.423847a32.29864 32.29864 0 0 1-15.487987 43.007964 27.007977 27.007977 0 0 1-13.951989 3.583997zM228.863809 1015.808007a32.255973 32.255973 0 0 1-32.554639-32.255973v-129.621226c0-17.919985 14.506655-32.255973 32.554639-32.255973 18.090652 0 32.55464 14.335988 32.55464 32.255973v129.621226c0 17.919985-14.463988 32.255973-32.55464 32.255973z m566.271528 0a32.255973 32.255973 0 0 1-32.554639-32.255973v-129.621226c0-17.919985 14.463988-32.255973 32.554639-32.255973s32.55464 14.335988 32.55464 32.255973v129.621226c0.512 17.919985-14.506655 32.255973-32.55464 32.255973z m196.30917 8.191993H32.55464a32.255973 32.255973 0 1 1 0-64.554613h958.889867a32.255973 32.255973 0 1 1 0 64.554613z"
                                            fill="#4571F6" p-id="53219"></path>
                                        <path
                                            d="M511.999573 0.000853c60.970616 0 118.314568 23.55198 161.706532 66.559945a224.213146 224.213146 0 0 1 67.157278 160.383866c0 60.41595-23.765314 117.290569-67.157278 160.3412a228.053143 228.053143 0 0 1-161.706532 66.559944 228.053143 228.053143 0 0 1-161.706532-66.559944 224.213146 224.213146 0 0 1-67.157277-160.3412c0-60.458616 23.765314-117.333236 67.157277-160.3412A228.053143 228.053143 0 0 1 511.999573 0.000853z m0 65.066613c-89.898592 0-163.242531 72.746606-163.24253 161.877198S422.100982 389.333862 511.999573 389.333862s163.242531-72.746606 163.242531-161.877198c0-89.173259-73.343939-162.389198-163.242531-162.389198z"
                                            fill="#1AC4BF" p-id="53220"></path>
                                    </svg>
                                    ÂçèÂêåÁºñËæë
                                </span>
                                <template #dropdown>
                                    <el-dropdown-menu>
                                        <el-dropdown-item :disabled="isCoop"
                                            @click='startCoop'>ÂºÄÂêØÂçèÂêåÁºñËæë</el-dropdown-item>
                                        <el-dropdown-item :disabled="!isCoop" @click='getCoop'>Êü•ÁúãÂçè‰ΩúÁ†Å</el-dropdown-item>
                                        <el-dropdown-item :disabled="!isCoop"
                                            @click='stopCoop'>ÈÄÄÂá∫ÂçèÂêåÁºñËæë</el-dropdown-item>
                                        <el-dropdown-item :disabled="isCoop"
                                            @click='showCoopCode = true'>Âä†ÂÖ•ÂçèÂêåÁºñËæë</el-dropdown-item>
                                    </el-dropdown-menu>
                                </template>
                            </el-dropdown>

                        </div>
                    </el-tab-pane>
                    <el-tab-pane class="top-item">
                        <template #label>
                            <font-awesome-icon icon="plus-circle" style="margin-right: 10px;" />ÊèíÂÖ•
                        </template>
                        <div class="top-item-class tools-2-1">
                            <div class="tools-table">
                                <div>
                                    ÂàóÔºö<el-input v-model="InsertTableCol" step="1" size="small"
                                        style="width: 30px;"></el-input>
                                </div>
                                <div>
                                    Ë°åÔºö<el-input v-model="InsertTableRow" size="small" style="width: 30px;"></el-input>
                                </div>
                                <el-button class="button" size="small" @click="InsertTable">ÊèíÂÖ•Ë°®Ê†º</el-button>
                            </div>
                        </div>
                        <el-dropdown :hide-on-click="false">
                            <span class="top-button">
                                <svg t="1720252237657" class="icon" viewBox="0 0 1024 1024" version="1.1"
                                    xmlns="http://www.w3.org/2000/svg" p-id="55324" width="200" height="200">
                                    <path d="M0 0h1024v292.571429H0z" fill="#4185F4" p-id="55325"></path>
                                    <path d="M0 365.714286h292.571429v292.571428H0z" fill="#A0C2F9" p-id="55326"></path>
                                    <path d="M0 731.428571h292.571429v292.571429H0z" fill="#A0C2F9" p-id="55327"></path>
                                    <path
                                        d="M365.714286 365.714286h292.571428v292.571428H365.714286zM365.714286 731.428571h292.571428v292.571429H365.714286z"
                                        fill="#A0C2F9" p-id="55328"></path>
                                    <path d="M731.428571 365.714286h292.571429v292.571428h-292.571429z" fill="#A0C2F9"
                                        p-id="55329"></path>
                                    <path d="M731.428571 731.428571h292.571429v292.571429h-292.571429z" fill="#4185F4"
                                        p-id="55330"></path>
                                </svg>
                                Ë°®Ê†ºÂ∑•ÂÖ∑
                            </span>
                            <template #dropdown>
                                <el-dropdown-menu class="tools-2-1" style="flex-direction: column;">
                                    <el-dropdown-item @click.stop>
                                        <div class="tools-table2 small">
                                            <div>
                                                Âàó:<el-input v-model="InsertTableCol" step="1" size="small"
                                                    style="width: 30px;"></el-input>
                                            </div>
                                            <div>
                                                Ë°å:<el-input v-model="InsertTableRow" size="small"
                                                    style="width: 30px;"></el-input>
                                            </div>
                                            <el-button class="button" size="small" @click="InsertTable">ÊèíÂÖ•</el-button>
                                        </div>
                                    </el-dropdown-item>
                                    <el-dropdown-item>
                                        <span @click="InsertTableLine('left')" :disabled="!isTable">
                                            <font-awesome-icon icon='arrow-left'></font-awesome-icon>
                                        </span>
                                        <span @click="InsertTableLine('right')" :disabled="!isTable">
                                            <font-awesome-icon icon='arrow-right'></font-awesome-icon>
                                        </span>
                                        <span @click="InsertTableLine('up')" :disabled="!isTable">
                                            <font-awesome-icon icon='arrow-up'></font-awesome-icon>
                                        </span>
                                        <span @click="InsertTableLine('down')" :disabled="!isTable">
                                            <font-awesome-icon icon='arrow-down'></font-awesome-icon>
                                        </span>
                                    </el-dropdown-item>
                                    <el-dropdown-item>
                                        <span @click="DeleteTable('row')" :disabled="!isTable">
                                            <svg t="1716644344557" viewBox="0 0 1024 1024" version="1.1"
                                                xmlns="http://www.w3.org/2000/svg" p-id="10132">
                                                <path
                                                    d="M819.8 512l102.4-122.9c2.8-3.4 2.4-8.4-1-11.3-1.4-1.2-3.2-1.9-5.1-1.9h-54.7c-2.4 0-4.6 1.1-6.1 2.9L782 466.7l-73.1-87.8c-1.5-1.8-3.8-2.9-6.1-2.9H648c-1.9 0-3.7 0.7-5.1 1.9-3.4 2.8-3.9 7.9-1 11.3L744.2 512 641.8 634.9c-2.8 3.4-2.4 8.4 1 11.3 1.4 1.2 3.2 1.9 5.1 1.9h54.7c2.4 0 4.6-1.1 6.1-2.9l73.1-87.8 73.1 87.8c1.5 1.8 3.8 2.9 6.1 2.9h55c1.9 0 3.7-0.7 5.1-1.9 3.4-2.8 3.9-7.9 1-11.3L819.8 512zM536 464H120c-4.4 0-8 3.6-8 8v80c0 4.4 3.6 8 8 8h416c4.4 0 8-3.6 8-8v-80c0-4.4-3.6-8-8-8zM452 668h-60c-3.3 0-6 2.7-6 6v166H136c-3.3 0-6 2.7-6 6v60c0 3.3 2.7 6 6 6h292c16.6 0 30-13.4 30-30V674c0-3.3-2.7-6-6-6zM136 184h250v166c0 3.3 2.7 6 6 6h60c3.3 0 6-2.7 6-6V142c0-16.6-13.4-30-30-30H136c-3.3 0-6 2.7-6 6v60c0 3.3 2.7 6 6 6z"
                                                    p-id="10133"></path>
                                            </svg>
                                        </span>
                                        <span @click="DeleteTable('col')" :disabled="!isTable">
                                            <svg t="1716644561178" viewBox="0 0 1024 1024" version="1.1"
                                                xmlns="http://www.w3.org/2000/svg" p-id="11130">
                                                <path
                                                    d="M651.1 641.9c-1.4-1.2-3.2-1.9-5.1-1.9h-54.7c-2.4 0-4.6 1.1-6.1 2.9L512 730.7l-73.1-87.8c-1.5-1.8-3.8-2.9-6.1-2.9H378c-1.9 0-3.7 0.7-5.1 1.9-3.4 2.8-3.9 7.9-1 11.3L474.2 776 371.8 898.9c-2.8 3.4-2.4 8.4 1 11.3 1.4 1.2 3.2 1.9 5.1 1.9h54.7c2.4 0 4.6-1.1 6.1-2.9l73.1-87.8 73.1 87.8c1.5 1.8 3.8 2.9 6.1 2.9h55c1.9 0 3.7-0.7 5.1-1.9 3.4-2.8 3.9-7.9 1-11.3L549.8 776l102.4-122.9c2.8-3.4 2.3-8.4-1.1-11.2zM472 544h80c4.4 0 8-3.6 8-8V120c0-4.4-3.6-8-8-8h-80c-4.4 0-8 3.6-8 8v416c0 4.4 3.6 8 8 8zM350 386H184V136c0-3.3-2.7-6-6-6h-60c-3.3 0-6 2.7-6 6v292c0 16.6 13.4 30 30 30h208c3.3 0 6-2.7 6-6v-60c0-3.3-2.7-6-6-6zM906 130h-60c-3.3 0-6 2.7-6 6v250H674c-3.3 0-6 2.7-6 6v60c0 3.3 2.7 6 6 6h208c16.6 0 30-13.4 30-30V136c0-3.3-2.7-6-6-6z"
                                                    p-id="11131"></path>
                                            </svg>
                                        </span>
                                        <span @click="editor.commands.mergeCells();" :disabled="!isTable">
                                            <svg t="1716644758298" class="icon" viewBox="0 0 1024 1024" version="1.1"
                                                xmlns="http://www.w3.org/2000/svg" p-id="13801" width="200"
                                                height="200">
                                                <path
                                                    d="M213.333333 426.666667H128V170.666667h341.333333v85.333333H213.333333v170.666667z m597.333334 341.333333h-256v85.333333h341.333333v-256h-85.333333v170.666667zM213.333333 768v-170.666667H128v256h341.333333v-85.333333H213.333333zM896 170.666667h-341.333333v85.333333h256v170.666667h85.333333V170.666667zM341.333333 554.666667v85.333333l128-128-128-128v85.333333H128v85.333334h213.333333z m341.333334-85.333334V384l-128 128 128 128v-85.333333h213.333333v-85.333334h-213.333333z"
                                                    p-id="13802"></path>
                                            </svg>
                                        </span>
                                        <span @click="editor.commands.splitCell();" :disabled="!isTable">
                                            <svg t="1716644784112" class="icon" viewBox="0 0 1024 1024" version="1.1"
                                                xmlns="http://www.w3.org/2000/svg" p-id="15809" width="200"
                                                height="200">
                                                <path
                                                    d="M810.666667 597.333333h85.333333v256H128v-256h85.333333v170.666667h597.333334v-170.666667M128 170.666667v256h85.333333V256h597.333334v170.666667h85.333333V170.666667H128m341.333333 298.666666v85.333334H341.333333v85.333333l-128-128 128-128v85.333333h128m213.333334 0V384l128 128-128 128v-85.333333h-128v-85.333334h128z"
                                                    p-id="15810"></path>
                                            </svg>
                                        </span>
                                    </el-dropdown-item>
                                </el-dropdown-menu>
                            </template>
                        </el-dropdown>
                        <span class="top-button" @click="InsertPic2()">
                            <input type="file" @change="InsertPic" id="uploadImg" style="display: none;" />
                            <svg t="1720252852899" class="icon" viewBox="0 0 1024 1024" version="1.1"
                                xmlns="http://www.w3.org/2000/svg" p-id="111649" width="200" height="200">
                                <path
                                    d="M758.848 487.36L1024 713.28v196.928C1024 972.8 972.8 1024 910.208 1024H113.792C51.2 1024 0 972.8 0 910.208v-50.944l218.944-218.88 155.072 147.968c11.52 10.24 34.496 10.24 45.952 0l338.88-300.992zM910.208 0C972.8 0 1024 51.2 1024 113.792v529.408l-247.936-211.904c-15.104-8.96-30.144-10.048-41.408-3.392l-4.544 3.392-338.816 300.928L230.4 584.32c-11.52-15.36-34.432-10.24-45.952 0L0 779.456V113.792C0 51.2 51.2 0 113.792 0h796.416z"
                                    fill="#5BA4EB" p-id="111650"></path>
                                <path
                                    d="M358.976 370.048c40.832 0 76.48-35.712 76.48-76.48 0-40.832-35.648-76.544-76.48-76.544s-76.544 35.712-76.544 76.544c0 40.768 35.712 76.48 76.544 76.48z m0 51.008a126.272 126.272 0 0 1-127.552-127.488c0-71.424 56.128-127.552 127.552-127.552S486.4 222.144 486.4 293.568A126.272 126.272 0 0 1 359.04 421.056z"
                                    fill="#FFFFFF" p-id="111651"></path>
                            </svg>
                            ÂõæÁâá
                        </span>
                        <span class="top-button" @click="InsertAudio2()">
                            <input type="file" @change="InsertAudio" id="uploadAudio" style="display: none;" />
                            <svg t="1720709269986" class="icon" viewBox="0 0 1024 1024" version="1.1"
                                xmlns="http://www.w3.org/2000/svg" p-id="5284" width="200" height="200">
                                <path
                                    d="M136.533333 0C123.733333 0 110.08 5.12 100.693333 15.36 91.306667 25.6 85.333333 38.4 85.333333 51.2v921.6c0 12.8 5.12 26.453333 15.36 35.84 10.24 10.218667 23.04 15.36 35.84 15.36h750.933334c12.8 0 26.453333-5.141333 35.84-15.36 10.24-10.24 15.36-23.04 15.36-35.84v-682.666667L648.533333 0h-512z"
                                    fill="#63C8FF" p-id="5285"></path>
                                <path
                                    d="M498.88 442.282667l-92.586667 70.549333h-61.034666c-21.056 2.133333-25.258667 25.664-25.258667 25.664v124.010667c0 21.376 27.349333 25.664 27.349333 25.664h63.146667s96.810667 72.704 98.922667 72.704c14.72 4.266667 14.72-12.842667 14.72-12.842667V442.282667c-2.090667-17.109333-25.258667 0-25.258667 0z m134.698667 145.386666c-4.202667-49.173333-44.181333-79.104-46.293334-81.258666-8.426667-6.4-23.146667-4.266667-29.461333 4.266666-6.314667 8.576-4.224 23.530667 4.202667 29.952 0 0 25.258667 21.376 29.461333 51.328 2.112 21.376-8.405333 47.04-31.573333 70.549334a20.906667 20.906667 0 0 0 0 29.930666c4.224 4.266667 8.426667 6.4 14.741333 6.4 6.314667 0 10.517333-2.133333 14.72-6.4 33.685333-36.352 46.293333-70.549333 44.202667-104.746666z"
                                    fill="#FFFFFF" p-id="5286"></path>
                                <path
                                    d="M655.488 453.269333c-8.405333-8.682667-21.013333-6.506667-29.397333 2.176-8.405333 8.682667-6.314667 21.717333 2.090666 30.4 4.202667 4.330667 119.744 108.565333-2.090666 254.037334-8.405333 8.682667-6.314667 21.717333 2.090666 30.4 4.202667 4.352 8.405333 4.352 14.72 4.352 6.293333 0 12.586667-2.176 16.789334-6.528 48.32-56.448 69.333333-117.248 65.109333-175.872-8.384-84.693333-67.2-136.789333-69.312-138.965334z"
                                    fill="#FFFFFF" p-id="5287"></path>
                                <path
                                    d="M938.666667 290.368H699.52c-12.8 0-26.453333-5.141333-35.84-15.381333a49.152 49.152 0 0 1-15.381333-35.882667V0L938.666667 290.368z"
                                    fill="#ADE2FF" p-id="5288"></path>
                            </svg>
                            Èü≥È¢ë
                        </span>
                        <span class="top-button" @click="InsertDraw">
                            <svg t="1720252335695" class="icon" viewBox="0 0 1024 1024" version="1.1"
                                xmlns="http://www.w3.org/2000/svg" p-id="73702" width="200" height="200">
                                <path
                                    d="M48.24103438 392.304575C115.98810594 133.42064564 376.97830063-20.7366025 630.023345 48.61016375c241.28728781 66.17403843 412.21466905 303.91533657 348.30686438 548.00208937-19.46295281 74.33248125-66.94722469 137.70705469-132.05479969 176.17971282a277.76032781 277.76032781 0 0 1-215.15894063 28.95447375l-81.79772343-22.39572563a27.83468812 27.83468812 0 0 0-34.12682063 20.10283031c-1.78632562 6.53208656-1.06646343 13.49075906 1.99961813 19.48961438l0.18663093 0.45324656 0.37326281 0.77318531 0.23995407 0.4532475c6.13216313 13.06417312 18.15653531 44.41819031 7.99847344 83.29077187a118.00414781 118.00414781 0 0 1-53.93637375 72.03958595 113.31171001 113.31171001 0 0 1-87.92988657 11.78441718C131.10522125 918.31086219-19.53269875 651.26849001 48.24103438 392.304575z m649.07613468 113.41835625c-2.95943531 10.87792406-1.41306375 22.50237281 4.31917594 32.26051031 5.75890125 9.7581375 15.1971 16.87677938 26.28831656 19.80955313l22.76898843 5.9988553c14.93048438 3.9192525 30.87410812-0.26661562 41.80535532-11.01123186 10.93124718-10.74461625 15.1971-26.39496281 11.19786375-41.05883157a42.92514187 42.92514187 0 0 0-30.58083093-30.04759968l-22.76898844-5.99885532a43.99160531 43.99160531 0 0 0-32.84706469 4.23919125c-9.94476844 5.62559344-17.19671813 14.93048438-20.18281594 25.80840844z m-86.54348437-212.4927825c-2.98609687 10.87792406-1.41306375 22.47571125 4.31917594 32.26051031 5.73223969 9.7581375 15.1971 16.87677938 26.28831656 19.78289157l22.74232687 5.99885531c23.08892719 6.07884 46.84439344-7.3852575 53.02987969-30.04759969a42.44523376 42.44523376 0 0 0-30.6074925-52.07006344l-22.7689875-5.99885531a43.99160531 43.99160531 0 0 0-32.84706562 4.26585281c-9.94476844 5.59893187-17.19671813 14.90382281-20.15615344 25.78174688zM393.24186406 223.430135c-2.98609687 10.93124718-1.4397253 22.52903437 4.29251438 32.28717187 5.75890125 9.78479906 15.1971 16.90344094 26.31497811 19.83621469l22.76898751 5.94553219c23.08892719 6.07884 46.81773187-7.3852575 53.00321907-30.04759875a42.44523376 42.44523376 0 0 0-30.58083094-52.07006344l-22.76898844-5.99885531a43.99160531 43.99160531 0 0 0-32.84706469 4.26585281c-9.94476844 5.59893187-17.19671813 14.90382281-20.182815 25.78174594z m-173.11363125 170.02088813c-2.98609687 10.90458562-1.4397253 22.50237281 4.29251438 32.26051031 5.73223969 9.78479906 15.1971 16.9301025 26.31497813 19.83621469l22.74232687 5.97219375c14.93048438 3.9192525 30.87410812-0.26661562 41.83201687-11.01123187 10.93124718-10.74461625 15.1971-26.39496281 11.19786282-41.05883158a42.92514187 42.92514187 0 0 0-30.6074925-30.04759968l-22.7689875-5.9988553a43.99160531 43.99160531 0 0 0-32.84706563 4.23919124c-9.94476844 5.62559344-17.19671813 14.93048438-20.15615344 25.80840844z"
                                    fill="#1c82ff" p-id="73703"></path>
                            </svg>
                            ÁîªÊùø
                        </span>
                        <span class="top-button" @click="InsertGraph(1)">
                            <svg t="1720252375725" class="icon" viewBox="0 0 1024 1024" version="1.1"
                                xmlns="http://www.w3.org/2000/svg" p-id="76794" width="200" height="200">
                                <path
                                    d="M0 0m107.789474 0l808.421052 0q107.789474 0 107.789474 107.789474l0 808.421052q0 107.789474-107.789474 107.789474l-808.421052 0q-107.789474 0-107.789474-107.789474l0-808.421052q0-107.789474 107.789474-107.789474Z"
                                    fill="#5899EA" p-id="76795"></path>
                                <path
                                    d="M377.263158 242.526316m26.947368 0l215.578948 0q26.947368 0 26.947368 26.947368l0 107.789474q0 26.947368-26.947368 26.947368l-215.578948 0q-26.947368 0-26.947368-26.947368l0-107.789474q0-26.947368 26.947368-26.947368Z"
                                    fill="#FFFFFF" p-id="76796"></path>
                                <path
                                    d="M188.631579 619.789474m26.947368 0l215.578948 0q26.947368 0 26.947368 26.947368l0 107.789474q0 26.947368-26.947368 26.947368l-215.578948 0q-26.947368 0-26.947368-26.947368l0-107.789474q0-26.947368 26.947368-26.947368Z"
                                    fill="#FFFFFF" p-id="76797"></path>
                                <path
                                    d="M565.894737 619.789474m26.947368 0l215.578948 0q26.947368 0 26.947368 26.947368l0 107.789474q0 26.947368-26.947368 26.947368l-215.578948 0q-26.947368 0-26.947368-26.947368l0-107.789474q0-26.947368 26.947368-26.947368Z"
                                    fill="#FFFFFF" p-id="76798"></path>
                                <path d="M296.421053 485.052632h404.210526v53.894736H296.421053z" fill="#FFFFFF"
                                    p-id="76799"></path>
                                <path d="M296.421053 512h53.894736v134.736842h-53.894736z" fill="#FFFFFF" p-id="76800">
                                </path>
                                <path d="M673.684211 485.052632h53.894736v134.736842h-53.894736z" fill="#FFFFFF"
                                    p-id="76801"></path>
                                <path d="M485.052632 377.263158h53.894736v107.789474h-53.894736z" fill="#FFFFFF"
                                    p-id="76802"></path>
                            </svg>
                            Mermaid
                        </span>
                        <span class="top-button" @click="InsertGraph(2)">
                            <svg t="1720252428469" class="icon" viewBox="0 0 1024 1024" version="1.1"
                                xmlns="http://www.w3.org/2000/svg" p-id="80655" width="200" height="200">
                                <path
                                    d="M34.133333 34.133333h68.266667v955.733334h-68.266667V34.133333z m0 955.733334v-68.266667h955.733334v68.266667H34.133333z m409.6-409.6h68.266667v409.6h-68.266667v-409.6z m136.533334 0h68.266666v409.6h-68.266666v-409.6z m-136.533334 341.333333v-341.333333h204.8v341.333333h-204.8z"
                                    fill="#4185F4" p-id="80656"></path>
                                <path d="M170.666667 921.6v-204.8h204.8v204.8h-204.8z" fill="#4185F4" opacity=".5"
                                    p-id="80657"></path>
                                <path d="M716.8 989.866667v-614.4h204.8v614.4h-204.8z" fill="#4185F4" opacity=".5"
                                    p-id="80658"></path>
                            </svg>
                            Êü±Áä∂Âõæ
                        </span>
                        <span class="top-button" @click="InsertGraph(3)">
                            <svg t="1720252444107" class="icon" viewBox="0 0 1024 1024" version="1.1"
                                xmlns="http://www.w3.org/2000/svg" p-id="82723" width="200" height="200">
                                <path
                                    d="M538.4 504.4l280.9 144.3c9.9 5.1 22.2 0.5 26-10 14.3-38.7 22.1-80.6 22.1-124.3 0-186.2-141.6-339.3-323-357.5-7.9-0.8-14.7 5.3-14.7 13.3v320.1c0 5.9 3.4 11.4 8.7 14.1z"
                                    fill="#64B5F6" p-id="82724"></path>
                                <path
                                    d="M492.5 514.5V172.3c0-9.3-8-16.6-17.3-15.8C289 173.4 143.7 332.3 148.7 524.1c5 190.9 161.5 346.1 352.4 349.7 131.3 2.5 246.8-65.5 311.5-168.7 4.6-7.3 2-17-5.7-21L499.8 526.4c-4.5-2.3-7.3-6.9-7.3-11.9z"
                                    fill="#1E88E5" p-id="82725"></path>
                            </svg>
                            È•ºÂõæ
                        </span>

                    </el-tab-pane>
                    <el-tab-pane class="top-item">
                        <template #label class="top-item2">
                            <svg class="top-item-svg" style="margin-right: 10px;" t="1719580485285"
                                viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="25402">
                                <path
                                    d="M512 85.333333c235.648 0 426.666667 191.018667 426.666667 426.666667s-191.018667 426.666667-426.666667 426.666667S85.333333 747.648 85.333333 512 276.352 85.333333 512 85.333333z m0 85.333334a341.333333 341.333333 0 1 0 0 682.666666 341.333333 341.333333 0 0 0 0-682.666666z m-40.405333 156.586666l121.856 369.706667h-83.968l-27.050667-89.685333H361.898667l-27.648 89.685333H256L378.453333 327.253333h93.141334z m256.213333 0v369.706667h-78.549333V327.253333h78.506666z m-303.36 75.562667H420.693333l-43.306666 144.64h89.898666L424.448 402.773333z"
                                    p-id="25403"></path>
                            </svg>
                            <!-- <font-awesome-icon icon="robot" style="margin-right: 10px;" /> -->
                            AIÂ∑•ÂÖ∑
                        </template>
                        <span class="top-button" @click="isAIOpen = !isAIOpen">
                            <svg t="1720252518951" class="icon" viewBox="0 0 1024 1024" version="1.1"
                                xmlns="http://www.w3.org/2000/svg" p-id="94143" width="200" height="200">
                                <path
                                    d="M488.530747 1024a460.965495 460.965495 0 1 1 140.19491-900.416646L597.405737 222.17697a357.34497 357.34497 0 1 0 232.727273 448.90505l98.572929 31.319919a460.675879 460.675879 0 0 1-396.898262 319.508687q-21.783273 2.110061-43.27693 2.089374z"
                                    fill="#0180FF" p-id="94144"></path>
                                <path
                                    d="M490.785616 643.899475h-109.226667l-23.665777 86.491798h-68.266667l107.88202-336.844283h79.189334l108.337131 336.844283h-70.542222z m-14.480808-52.337778l-10.012444-36.884687c-10.467556-35.043556-19.569778-73.728-29.582223-110.136889h-1.820444c-8.647111 36.864-18.618182 75.093333-28.672 110.136889l-10.012444 36.884687z"
                                    fill="#0180FF" p-id="94145"></path>
                                <path d="M633.690505 393.54699h67.356444v336.844283h-67.356444z" fill="#0180FF"
                                    p-id="94146"></path>
                                <path d="M768.113778 72.40404h227.555555v82.747475h-227.555555z" fill="#FBB03B"
                                    p-id="94147"></path>
                                <path d="M840.517818 227.555556V0h82.747475v227.555556z" fill="#FBB03B" p-id="94148">
                                </path>
                            </svg>
                            AIÂä©Êâã
                        </span>
                        <span class="top-button" @click="AItransition()">
                            <svg t="1720252567818" class="icon" viewBox="0 0 1024 1024" version="1.1"
                                xmlns="http://www.w3.org/2000/svg" p-id="96322" width="200" height="200">
                                <path
                                    d="M548.498286 0c40.411429 0 73.106286 32.585143 73.106285 73.106286V402.285714h329.179429c40.411429 0 73.142857 32.621714 73.142857 73.142857v475.355429a72.996571 72.996571 0 0 1-73.142857 73.142857H475.428571a72.996571 72.996571 0 0 1-73.106285-73.142857V621.714286H73.142857A72.996571 72.996571 0 0 1 0 548.571429V73.142857C0 32.694857 32.585143 0 73.106286 0h475.428571z m-402.285715 731.428571c0 80.859429 65.389714 146.285714 146.285715 146.285715v73.069714a219.355429 219.355429 0 0 1-219.428572-219.392h73.142857z m618.203429-146.212571H690.468571L585.142857 875.885714h59.721143l22.016-61.293714h114.688l21.979429 61.293714h62.902857l-102.070857-290.669714zM328.594286 128h-53.394286v76.982857H146.285714v183.917714h53.394286V360.594286h77.019429v135.021714h56.612571V360.484571h78.592v23.625143h58.112V204.982857H333.312V165.705143c0-11.593143 1.572571-21.504 4.681143-29.915429a9.764571 9.764571 0 0 0 1.609143-4.681143c0-1.024-3.693714-2.121143-10.971429-3.108571zM276.699429 249.014857v69.12H199.716571v-69.12h76.982858z m135.204571 0v69.12h-78.628571v-69.12h78.628571z m319.597714-175.908571c121.088 0 219.428571 98.304 219.428572 219.501714h-73.142857c0-80.896-65.389714-146.285714-146.285715-146.285714V73.069714z"
                                    fill="#3479F0" p-id="96323"></path>
                                <path d="M682.605714 765.915429h83.309715l-39.314286-124.123429h-1.609143z"
                                    fill="#FFC906" p-id="96324">
                                </path>
                            </svg>
                            ÁøªËØë
                        </span>
                        <div class="top-item-ai">
                            <span @click="AIsummary()">ÂÖ®ÊñáÊÄªÁªì</span>
                            <span @click="AIabstract()">ÂÖ®ÊñáÊëòË¶Å</span>
                            <span @click="AIcontiune()">ÊñáÁ´†Áª≠ÂÜô</span>
                            <span @click="AIwrong2right2()">‰øÆÊîπÁóÖÂè•</span>
                            <span @click="AISelect = 8">ÊñáÁ´†Ê∂¶Ëâ≤</span>
                        </div>
                        <span class="top-button" @click="isAIOpen = true; AISelect = 6">
                            <svg t="1720252611570" class="icon" viewBox="0 0 1024 1024" version="1.1"
                                xmlns="http://www.w3.org/2000/svg" p-id="99918" width="200" height="200">
                                <path
                                    d="M0 0m78.769231 0l196.923077 0q78.769231 0 78.76923 78.769231l0 196.923077q0 78.769231-78.76923 78.76923l-196.923077 0q-78.769231 0-78.769231-78.76923l0-196.923077q0-78.769231 78.769231-78.769231Z"
                                    fill="#71B9FF" p-id="99919"></path>
                                <path
                                    d="M795.569231 157.538462A70.892308 70.892308 0 0 1 866.461538 228.430769V512a70.892308 70.892308 0 0 1-70.892307 70.892308h-133.907693a78.769231 78.769231 0 0 0-78.76923 78.76923v133.907693A70.892308 70.892308 0 0 1 512 866.461538H228.430769A70.892308 70.892308 0 0 1 157.538462 795.569231V512a70.892308 70.892308 0 0 1 70.892307-70.892308h133.907693a78.769231 78.769231 0 0 0 78.76923-78.76923V228.430769A70.892308 70.892308 0 0 1 512 157.538462h283.569231z"
                                    fill="#178FFF" p-id="99920"></path>
                                <path
                                    d="M669.538462 669.538462m78.76923 0l196.923077 0q78.769231 0 78.769231 78.76923l0 196.923077q0 78.769231-78.769231 78.769231l-196.923077 0q-78.769231 0-78.76923-78.769231l0-196.923077q0-78.769231 78.76923-78.76923Z"
                                    fill="#71B9FF" p-id="99921"></path>
                            </svg>
                            Êô∫ËÉΩÊéíÁâà
                        </span>
                        <span class="top-button" @click="AISelect = 7; isAIOpen = true">
                            <svg t="1720252852899" class="icon" viewBox="0 0 1024 1024" version="1.1"
                                xmlns="http://www.w3.org/2000/svg" p-id="111649" width="200" height="200">
                                <path
                                    d="M758.848 487.36L1024 713.28v196.928C1024 972.8 972.8 1024 910.208 1024H113.792C51.2 1024 0 972.8 0 910.208v-50.944l218.944-218.88 155.072 147.968c11.52 10.24 34.496 10.24 45.952 0l338.88-300.992zM910.208 0C972.8 0 1024 51.2 1024 113.792v529.408l-247.936-211.904c-15.104-8.96-30.144-10.048-41.408-3.392l-4.544 3.392-338.816 300.928L230.4 584.32c-11.52-15.36-34.432-10.24-45.952 0L0 779.456V113.792C0 51.2 51.2 0 113.792 0h796.416z"
                                    fill="#5BA4EB" p-id="111650"></path>
                                <path
                                    d="M358.976 370.048c40.832 0 76.48-35.712 76.48-76.48 0-40.832-35.648-76.544-76.48-76.544s-76.544 35.712-76.544 76.544c0 40.768 35.712 76.48 76.544 76.48z m0 51.008a126.272 126.272 0 0 1-127.552-127.488c0-71.424 56.128-127.552 127.552-127.552S486.4 222.144 486.4 293.568A126.272 126.272 0 0 1 359.04 421.056z"
                                    fill="#FFFFFF" p-id="111651"></path>
                            </svg>
                            AIËØÜÂõæ
                        </span>
                        <span class="top-button" @click="AISelect = 9; isAIOpen = true">
                            <svg t="1720709269986" class="icon" viewBox="0 0 1024 1024" version="1.1"
                                xmlns="http://www.w3.org/2000/svg" p-id="5284" width="200" height="200">
                                <path
                                    d="M136.533333 0C123.733333 0 110.08 5.12 100.693333 15.36 91.306667 25.6 85.333333 38.4 85.333333 51.2v921.6c0 12.8 5.12 26.453333 15.36 35.84 10.24 10.218667 23.04 15.36 35.84 15.36h750.933334c12.8 0 26.453333-5.141333 35.84-15.36 10.24-10.24 15.36-23.04 15.36-35.84v-682.666667L648.533333 0h-512z"
                                    fill="#63C8FF" p-id="5285"></path>
                                <path
                                    d="M498.88 442.282667l-92.586667 70.549333h-61.034666c-21.056 2.133333-25.258667 25.664-25.258667 25.664v124.010667c0 21.376 27.349333 25.664 27.349333 25.664h63.146667s96.810667 72.704 98.922667 72.704c14.72 4.266667 14.72-12.842667 14.72-12.842667V442.282667c-2.090667-17.109333-25.258667 0-25.258667 0z m134.698667 145.386666c-4.202667-49.173333-44.181333-79.104-46.293334-81.258666-8.426667-6.4-23.146667-4.266667-29.461333 4.266666-6.314667 8.576-4.224 23.530667 4.202667 29.952 0 0 25.258667 21.376 29.461333 51.328 2.112 21.376-8.405333 47.04-31.573333 70.549334a20.906667 20.906667 0 0 0 0 29.930666c4.224 4.266667 8.426667 6.4 14.741333 6.4 6.314667 0 10.517333-2.133333 14.72-6.4 33.685333-36.352 46.293333-70.549333 44.202667-104.746666z"
                                    fill="#FFFFFF" p-id="5286"></path>
                                <path
                                    d="M655.488 453.269333c-8.405333-8.682667-21.013333-6.506667-29.397333 2.176-8.405333 8.682667-6.314667 21.717333 2.090666 30.4 4.202667 4.330667 119.744 108.565333-2.090666 254.037334-8.405333 8.682667-6.314667 21.717333 2.090666 30.4 4.202667 4.352 8.405333 4.352 14.72 4.352 6.293333 0 12.586667-2.176 16.789334-6.528 48.32-56.448 69.333333-117.248 65.109333-175.872-8.384-84.693333-67.2-136.789333-69.312-138.965334z"
                                    fill="#FFFFFF" p-id="5287"></path>
                                <path
                                    d="M938.666667 290.368H699.52c-12.8 0-26.453333-5.141333-35.84-15.381333a49.152 49.152 0 0 1-15.381333-35.882667V0L938.666667 290.368z"
                                    fill="#ADE2FF" p-id="5288"></path>
                            </svg>
                            Èü≥È¢ëÂ§ÑÁêÜ
                        </span>
                        <span class="top-button" @click="AISelect = 10; isAIOpen = true">
                            <svg t="1720709623834" class="icon" viewBox="0 0 1024 1024" version="1.1"
                                xmlns="http://www.w3.org/2000/svg" p-id="13140" width="200" height="200">
                                <path
                                    d="M876.17 70.19c28.62 0 51.82 23.2 51.82 51.82v777.31c0 28.62-23.2 51.82-51.82 51.82H150.68c-28.62 0-51.82-23.2-51.82-51.82V122.01c0-28.62 23.2-51.82 51.82-51.82h725.49zM720.71 588.5c-14.31 0-25.91 11.6-25.91 25.91v51.77l-51.82 0.05c-12.72 0-23.3 9.17-25.49 21.25l-0.42 4.66c0 14.31 11.6 25.91 25.91 25.91l51.82-0.05v51.87c0 12.72 9.17 23.3 21.25 25.49l4.66 0.42c14.31 0 25.91-11.6 25.91-25.91V718l51.82 0.05c12.72 0 23.3-9.17 25.49-21.25l0.42-4.66c0-14.31-11.6-25.91-25.91-25.91l-51.82-0.05v-51.77c0-12.72-9.17-23.3-21.25-25.49l-4.66-0.42zM487.52 718.05H280.23c-14.31 0-25.91 11.6-25.91 25.91s11.6 25.91 25.91 25.91h207.28c14.31 0 25.91-11.6 25.91-25.91 0.01-14.31-11.59-25.91-25.9-25.91z m0-155.46H280.23c-14.31 0-25.91 11.6-25.91 25.91s11.6 25.91 25.91 25.91h207.28c14.31 0 25.91-11.6 25.91-25.91 0.01-14.31-11.59-25.91-25.9-25.91z m259.1-155.46H280.23c-14.31 0-25.91 11.6-25.91 25.91s11.6 25.91 25.91 25.91h466.39c14.31 0 25.91-11.6 25.91-25.91s-11.6-25.91-25.91-25.91z m0-155.47H280.23c-14.31 0-25.91 11.6-25.91 25.91s11.6 25.91 25.91 25.91h466.39c14.31 0 25.91-11.6 25.91-25.91s-11.6-25.91-25.91-25.91z"
                                    fill="#257CEF" p-id="13141"></path>
                            </svg>
                            Êô∫ËÉΩÁîüÊàê
                        </span>

                    </el-tab-pane>
                </el-tabs>
            </div>
        </div>


        <div class='main2'>
            <div class="main-left print large" v-if='ShowTree'>
                <span @click='ShowTree = false' class='main-left-close'><font-awesome-icon icon="times" /></span>
                <li class="main-left-title"
                    style="color: rgb(39, 64, 247);margin-bottom: 14px;margin-top: 14px;margin-left: 15px;font-size: 16px;cursor:auto;">
                    ÊñáÊ°£Á¥¢Âºï
                </li>
                <li v-for="i in TitleList" :key="i" class="main-left-title"
                    :style="{ 'margin-left': (15 + (i.level - 1) * 12) + 'px', 'color': ['#666', '#888', '#999'][i.level - 1] }"
                    @click="GotoTitle(i.id)">{{ i.title }}
                </li>
                <li v-if="TitleList.length == 0" class="main-left-title"
                    :style="{ 'margin-left': '0', 'text-align': 'center', 'color': '#aaa', 'cursor': 'auto' }"> ÔºàÊöÇÊó†Á¥¢ÂºïÔºâ
                </li>
            </div>

            <Transition>
                <div class="small main-left-2-ghost" v-if='ShowTree' @click.stop="ShowTree = false">
                    <div class="main-left print small main-left-small" v-if='ShowTree'>
                        <span @click='ShowTree = false' class='main-left-close'><font-awesome-icon
                                icon="times" /></span>
                        <li class="main-left-title"
                            style="color: #333;margin-bottom: 14px;margin-top: 14px;margin-left: 15px;font-size: 20px;cursor:auto;">
                            ÊñáÊ°£Á¥¢Âºï
                        </li>
                        <li v-for="i in TitleList" :key="i" class="main-left-title"
                            :style="{ 'margin-left': (30 + (i.level - 1) * 30) + 'px', 'color': ['#666', '#888', '#999'][i.level - 1] }"
                            @click="GotoTitle(i.id)">{{ i.title }}
                        </li>
                        <li v-if="TitleList.length == 0" class="main-left-title"
                            :style="{ 'margin-left': '0', 'text-align': 'center', 'color': '#aaa', 'cursor': 'auto', 'width': '100%', 'max-width': '100%' }">
                            ÔºàÊöÇÊó†Á¥¢ÂºïÔºâ
                        </li>
                    </div>
                </div>
            </Transition>



            <div class="main" v-loading="fileLoading">
                <div class="main-right">
                    <div style="height: 40px;" class="print main-height"></div>
                    <div class="editor">
                        <!-- <div class="main-sround-tl print"></div>
                        <div class="main-sround-tr print"> </div>
                        <div class="main-sround-bl print"> </div>
                        <div class="main-sround-br print"> </div> -->
                        <div>
                            <editor-content id="pdf" :editor="editor" @contextmenu.prevent.stop="EditorContext" />
                        </div>
                        <div @click="EditorActive"
                            @contextmenu.prevent.stop="editor.chain().focus('end').run(); EditorContext($event)"
                            class="editor-space"></div>
                    </div>
                    <div style="height: 60px;" class="print main-height"></div>
                </div>
            </div>
            <div class="main-right-ai print" v-if='isAIOpen' :style="{ width: AIwidth + 'px' }">
                <div class="resize" id='resizeRight'></div>
                <span @click='isAIOpen = false' class='main-right-close'><font-awesome-icon icon="times" /></span>
                <div style="">
                    <div class="main-left-title"
                        style="color: #ab15d8;margin-bottom: 14px;margin-top: 14px;margin-left: 15px;font-size: 16px;cursor:auto;">
                        ‚ú®AIÂä©Êâã
                    </div>
                    <div class="bubble-menu2">
                        <el-select v-model="AISelect" placeholder="ÈÄâÊã©AIÂ∞èÂä©Êâã" style="margin-bottom: 10px;">
                            <el-option label="ÁøªËØëÈÄâ‰∏≠ÊñáÊú¨" :value="1" />
                            <el-option label="ÂÖ®ÊñáÊÄªÁªì" :value="2" />
                            <el-option label="ÂÖ®ÊñáÊëòË¶Å" :value="3" />
                            <el-option label="ÊñáÁ´†Áª≠ÂÜô" :value="4" />
                            <el-option label="ÊñáÁ´†Ê∂¶Ëâ≤" :value="8" />
                            <el-option label="‰øÆÊîπÁóÖÂè•" :value="5" />
                            <el-option label="Êô∫ËÉΩÊéíÁâà" :value="6" />
                            <el-option label="AIËØÜÂõæ" :value="7" />
                            <el-option label="Èü≥È¢ëÂ§ÑÁêÜ" :value="9" />
                            <el-option label="Êô∫ËÉΩÁîüÊàê" :value="10" />
                        </el-select>
                        <div v-if='AISelect == 1'>
                            <div style="font-size: 12px;margin: 8px 0;color: #555">ÈÄâ‰∏≠‰∏ÄÊÆµÊñáÂ≠óÂ∞ÜËøõË°åAIÁøªËØë</div>
                            <span class="ai-title-2">Ê∫êËØ≠Ë®Ä</span>
                            <el-select v-model="AItransitionFrom" placeholder="Ê∫êËØ≠Ë®Ä" style="margin-bottom: 10px;">
                                <el-option v-for="i in ['Ëá™Âä®ËØÜÂà´']" :label="i" :value='i' />
                            </el-select>
                            <span class="ai-title-2">ÁõÆÊ†áËØ≠Ë®Ä</span>
                            <el-select v-model="AItransitionTo" placeholder="Ê∫êËØ≠Ë®Ä" style="margin-bottom: 10px;">
                                <el-option v-for="i in ['‰∏≠ÊñáÔºàÁÆÄ‰ΩìÔºâ', '‰∏≠ÊñáÔºàÊñáË®ÄÊñáÔºâ', 'Ëã±ËØ≠', 'Êó•ËØ≠', '‰øÑËØ≠', 'Âæ∑ËØ≠']" :label="i"
                                    :value='i' />
                            </el-select>
                            <div v-loading="AItransitionLoading" element-loading-text="ÁîüÊàê‰∏≠..."
                                element-loading-background="rgba(255, 255, 255, 0.1)">
                                <el-input :readonly='true' placeholder='AIËæìÂá∫‚ù§...' class="ai-textarea" rows="8"
                                    type='textarea' id="scroll_text" v-model="AItransitionData"></el-input>
                            </div>
                            <div class="bubble-menu2-button">
                                <el-button @click="AItransition" v-if="AItransitionData == '' && !AItransitionLoading"
                                    size="small">{{ 'ÂºÄÂßãÁîüÊàê'
                                    }}</el-button>
                                <el-button @click="AItransition" v-if="AItransitionData != '' || AItransitionLoading"
                                    size="small">
                                    {{ AItransitionLoading ? 'ÂÅúÊ≠¢ÁîüÊàê' : 'ÈáçÊñ∞ÁîüÊàê' }}
                                </el-button>
                                <el-button @click="AIInsert(AItransitionData)"
                                    v-if="AItransitionData != '' || AItransitionLoading" size="small">Á°ÆÂÆö‰ΩøÁî®</el-button>
                            </div>
                        </div>
                        <div v-if='AISelect == 2'>
                            <div style="font-size: 12px;margin: 8px 0;color: #555">Ëá™Âä®ËØÜÂà´ÂÖ®ÊñáÂÜÖÂÆπÁîüÊàêÊñáÁ´†ÊÄªÁªì</div>
                            <div v-loading="AIsummaryLoading" element-loading-text="ÁîüÊàê‰∏≠..."
                                element-loading-background="rgba(255, 255, 255, 0.1)">
                                <el-input :readonly='true' placeholder='AIËæìÂá∫‚ù§...' class="ai-textarea" rows="8"
                                    type='textarea' id="scroll_text" v-model="AIsummaryData"></el-input>
                            </div>
                            <div class="bubble-menu2-button">
                                <el-button @click="AIsummary" v-if="AIsummaryData == '' && !AIsummaryLoading"
                                    size="small">{{
                                        'ÂºÄÂßãÁîüÊàê'
                                    }}</el-button>
                                <el-button @click="AIsummary" v-if="AIsummaryData != '' || AIsummaryLoading"
                                    size="small">{{
                                        AIsummaryLoading ?
                                            'ÂÅúÊ≠¢ÁîüÊàê'
                                            : 'ÈáçÊñ∞ÁîüÊàê' }}</el-button>
                                <el-button v-show="AISelect != 5" @click="AIInsert(AIsummaryData)"
                                    v-if="AIsummaryData != '' || AIsummaryLoading" size="small">Á°ÆÂÆö‰ΩøÁî®</el-button>
                            </div>
                        </div>
                        <div v-if='AISelect == 3'>
                            <div style="font-size: 12px;margin: 8px 0;color: #555">Ëá™Âä®ËØÜÂà´ÂÖ®ÊñáÂÜÖÂÆπÁºñÂÜôÊëòË¶Å</div>
                            <div v-loading="AIabstractLoading" element-loading-text="ÁîüÊàê‰∏≠..."
                                element-loading-background="rgba(255, 255, 255, 0.1)">
                                <el-input :readonly='true' placeholder='AIËæìÂá∫‚ù§...' class="ai-textarea" rows="8"
                                    type='textarea' id="scroll_text" v-model="AIabstractData"></el-input>
                            </div>
                            <div class="bubble-menu2-button">
                                <el-button @click="AIabstract" v-if="AIabstractData == '' && !AIabstractLoading"
                                    size="small">{{
                                        'ÂºÄÂßãÁîüÊàê'
                                    }}</el-button>
                                <el-button @click="AIabstract" v-if="AIabstractData != '' || AIabstractLoading"
                                    size="small">{{
                                        AIabstractLoading ?
                                            'ÂÅúÊ≠¢ÁîüÊàê'
                                            : 'ÈáçÊñ∞ÁîüÊàê' }}</el-button>
                                <el-button @click="AIInsert(AIabstractData)"
                                    v-if="AIabstractData != '' || AIabstractLoading" size="small">Á°ÆÂÆö‰ΩøÁî®</el-button>
                            </div>
                        </div>
                        <div v-if='AISelect == 4'>
                            <div style="font-size: 12px;margin: 8px 0;color: #555">Ëá™Âä®ËØÜÂà´ÂÖ®ÊñáÂÜÖÂÆπËøõË°åÁª≠ÂÜôÔºåÂèØËá™ÂÆö‰πâÁª≠ÂÜôÊñπÂêë</div>

                            <span class="ai-title-2">Áª≠ÂÜôÁõÆÊ†á</span>
                            <el-input v-model="AIcontiunegoal" placeholder="Ê≠£Â∏∏Áª≠ÂÜô"
                                style="margin-bottom: 10px;"></el-input>
                            <div v-loading="AIcontiuneLoading" element-loading-text="ÁîüÊàê‰∏≠..."
                                element-loading-background="rgba(255, 255, 255, 0.1)">
                                <el-input :readonly='true' placeholder='AIËæìÂá∫‚ù§...' class="ai-textarea" rows="8"
                                    type='textarea' id="scroll_text4" v-model="AIcontiuneData"></el-input>
                            </div>
                            <div class="bubble-menu2-button">
                                <el-button @click="AIcontiune" v-if="AIcontiuneData == '' && !AIcontiuneLoading"
                                    size="small">{{
                                        'ÂºÄÂßãÁîüÊàê'
                                    }}</el-button>
                                <el-button @click="AIcontiune" v-if="AIcontiuneData != '' || AIcontiuneLoading"
                                    size="small">{{
                                        AIcontiuneLoading ?
                                            'ÂÅúÊ≠¢ÁîüÊàê'
                                            : 'ÈáçÊñ∞ÁîüÊàê' }}</el-button>
                                <el-button v-show="AISelect != 5" @click="AIInsert(AIcontiuneData)"
                                    v-if="AIcontiuneData != '' || AIcontiuneLoading" size="small">Á°ÆÂÆö‰ΩøÁî®</el-button>
                            </div>
                        </div>
                        <div v-if='AISelect == 8'>
                            <div style="font-size: 12px;margin: 8px 0;color: #555">ÈÄâ‰∏≠‰∏ÄÊÆµÊñáÂ≠óËøõË°åÊ∂¶Ëâ≤‰øÆÊîπ</div>
                            <span class="ai-title-2">Ê∂¶Ëâ≤ÊñπÂêë</span>
                            <el-select v-model="AIpolishGoal" placeholder="Ê∫êËØ≠Ë®Ä" style="margin-bottom: 10px;">
                                <el-option v-for="i in ['Êõ¥‰∏ì‰∏ö', 'Êõ¥ÈÄö‰øó', 'Êõ¥ÂïÜ‰∏öÂåñ', 'Êõ¥ÁÆÄÁï•', 'Êõ¥Â≠¶ÊúØ', 'Êõ¥ÁÉ≠ÊÉÖ']" :label="i"
                                    :value='i' />
                            </el-select>
                            <div v-loading="AIpolishLoading" element-loading-text="ÁîüÊàê‰∏≠..."
                                element-loading-background="rgba(255, 255, 255, 0.1)">
                                <el-input :readonly='true' placeholder='AIËæìÂá∫‚ù§...' class="ai-textarea" rows="8"
                                    type='textarea' id="scroll_text" v-model="AIpolishData"></el-input>
                            </div>
                            <div class="bubble-menu2-button">
                                <el-button @click="AIpolish" v-if="AIpolishData == '' && !AIpolishLoading"
                                    size="small">{{
                                        'ÂºÄÂßãÁîüÊàê'
                                    }}</el-button>
                                <el-button @click="AIpolish" v-if="AIpolishData != '' || AIpolishLoading"
                                    size="small">{{
                                        AIpolishLoading ?
                                            'ÂÅúÊ≠¢ÁîüÊàê'
                                            : 'ÈáçÊñ∞ÁîüÊàê' }}</el-button>
                                <el-button v-show="AISelect != 5" @click="AIInsert(AIpolishData)"
                                    v-if="AIpolishData != '' || AIpolishLoading" size="small">Á°ÆÂÆö‰ΩøÁî®</el-button>
                            </div>
                        </div>
                        <div v-if='AISelect == 5'>
                            <div style="font-size: 12px;margin: 8px 0;color: #555">ÈÄâ‰∏≠‰∏ÄÊÆµÊñáÂ≠óÔºå‰øÆÊîπÂÖ∂‰∏≠ÁöÑÁóÖÂè•</div>
                            <span class="ai-title-2">‰øÆÊîπÁªìÊûú</span>
                            <div v-loading="AIwrong2rightLoading">
                                <div class="wrong2right"
                                    v-for='i in AIwrong2right || [{ "Original sentence": "ÈîôËØØÁöÑÂéüÂè•üò≠", "Corrected sentence": "‰øÆÊîπÂêéÊ≠£Á°ÆÁöÑÂè•Â≠êüòä", "Error type": "ÈîôËØØÁöÑÂéüÂõ†‚ö°", "Reasons for modification": "ÂØπ‰øÆÊîπÁóÖÂè•ÁöÑËß£ÈáäËØ¥ÊòéüöÄ" }]'
                                    @mouseenter="editor.commands.setSearchTerm(i['Original sentence'])"
                                    @mouseleave="editor.commands.setSearchTerm('')">
                                    <span class="ai-title-2" style='margin-bottom: 3px;margin-top: 6px;'>ÂéüÂè•</span>
                                    <el-input :readonly='true' placeholder='AIËæìÂá∫‚ù§...' class="ai-textarea" rows="3"
                                        type='textarea' id="scroll_text" v-model="i['Original sentence']">
                                    </el-input>
                                    <span class="ai-title-2" style='margin-bottom: 3px;margin-top: 6px;'>‰øÆÊîπÁªìÊûú</span>
                                    <el-input :readonly='true' placeholder='AIËæìÂá∫‚ù§...' class="ai-textarea" rows="3"
                                        type='textarea' id="scroll_text" v-model="i['Corrected sentence']">
                                    </el-input>
                                    <span class="ai-title-2" style='margin-bottom: 3px;margin-top: 6px;'>ÁóÖÂè•ÂéüÂõ†</span>
                                    <span style="font-size: 14px; margin-bottom: 10px;">{{ i['Error type'] }}</span>
                                    <span class="ai-title-2" style='margin-bottom: 3px;margin-top: 6px;'>‰øÆÊîπËØ¥Êòé</span>
                                    <el-input :readonly='true' placeholder='AIËæìÂá∫‚ù§...' class="ai-textarea" rows="3"
                                        type='textarea' id="scroll_text" v-model="i['Reasons for modification']">
                                    </el-input>
                                    <el-button style="margin-top: 10px;"
                                        @click="editor.commands.setReplaceTerm(i['Corrected sentence']); editor.commands.replace()"
                                        size="small">ÊõøÊç¢Êú¨Âè•</el-button>
                                </div>
                            </div>
                            <div class="bubble-menu2-button">
                                <!-- <el-button @click="AIwrong2right2" v-if="!AIwrong2right && !AIwrong2rightLoading"
                                    size="small">{{'ÂºÄÂßãÁîüÊàê' }}</el-button> -->
                                <el-button @click="AIwrong2right2" size="small">{{ AIwrong2rightLoading ? 'ÂÅúÊ≠¢ÁîüÊàê' :
                                    'ÂºÄÂßãÁîüÊàê'
                                    }}</el-button>
                            </div>

                        </div>

                        <div v-if="AISelect == 6">
                            <el-tabs class="demo-tabs" v-model="LayoutTabs">
                                <el-tab-pane label="Âø´ÈÄüÊéíÁâà" name="first">
                                    <el-collapse accordion>
                                        <el-collapse-item title="Ê†áÂáÜÊñáÁ´†Ê®°Êùø" name="1">
                                            <div>
                                                Ëá™Âä®ËØÜÂà´Â§ßÂÜôÊï∞Â≠ó„ÄÅÂ∞èÂÜôÊï∞Â≠ó‰Ωú‰∏∫Ê†áÈ¢òÔºåËá™Âä®ËØÜÂà´Ê≠£ÊñáÈÉ®ÂàÜ„ÄÇÈÄÇÂêàÈïøÁØáÊñáÁ´†„ÄÇ
                                            </div>
                                            <img src="./../assets/model1.png" alt="" srcset="" style="width: 100%;">
                                            <el-button @click="QuickLayout(1)">ÁÇπÂáªÂ∫îÁî®</el-button>
                                        </el-collapse-item>
                                        <el-collapse-item title="‰ø°‰ª∂Ê®°Êùø" name="2">
                                            <div>
                                                Ëá™Âä®ËØÜÂà´Ê†áÈ¢ò„ÄÅÁß∞ÂëºËØ≠„ÄÅÊ≠£ÊñáÈÉ®ÂàÜ„ÄÅÊó•Êúü„ÄÇÈÄÇÁî®‰∫é‰ø°‰ª∂„ÄÇ
                                            </div>
                                            <img src="./../assets/model2.png" alt="" srcset="" style="width: 100%;">
                                            <el-button @click="QuickLayout(2)">ÁÇπÂáªÂ∫îÁî®</el-button>
                                        </el-collapse-item>
                                    </el-collapse>

                                </el-tab-pane>
                                <el-tab-pane label="AIÊéíÁâà" name="second">
                                    <span class="ai-title-2">ÊéíÁâàÈúÄÊ±Ç</span>
                                    <el-select v-model="AILayoutType" placeholder="È¢ÑËÆæÊ†ºÂºè" style="margin-bottom: 10px;">
                                        <el-option v-for="(i, index) in AILayoutTypeList" :label="i.label"
                                            :value='index' />
                                    </el-select>
                                    <el-input v-loading="AILayoutLoading" v-model="AILayoutGoal" type='textarea'
                                        placeholder="‰ºòÂåñÊ†ºÂºè" style="margin-bottom: 10px;" rows="6"></el-input>
                                    <el-button v-show="AILayoutData" @click="ShowAILayout()">È¢ÑËßàÁªìÊûú</el-button>
                                    <el-button @click="AILayoutStart">{{ AILayoutLoading ? 'ÂÅúÊ≠¢ÁîüÊàê' : 'ÂºÄÂßãÁîüÊàê'
                                        }}</el-button>

                                </el-tab-pane>

                            </el-tabs>
                        </div>

                        <div v-if='AISelect == 7'>
                            <span class="ai-title-2">‰∏ä‰º†ÊàñÈÄâÊã©ÂõæÁâá</span>
                            <div class="ai-img">
                                <div class="ai-img-ghost">
                                    <div @click="uploadImage2">
                                        <input type="file" @change="InsertPic3" id="uploadImg2"
                                            style="display: none;" />
                                        <font-awesome-icon icon="cloud-upload"></font-awesome-icon>
                                    </div>
                                    <div v-show="AIImgUrl" @click="ImageViewer = true; ImageViewerImg = [AIImgUrl]">
                                        <font-awesome-icon icon="search-plus"></font-awesome-icon>
                                    </div>
                                </div>
                                <div class="ai-img-img" v-show="!AIImgUrl">
                                    ËØ∑Âè≥ÈîÆÈÄâ‰∏≠ÂõæÁâáÊàñ‰∏ä‰º†ÂõæÁâá
                                </div>
                                <img class="ai-img-img" v-show="AIImgUrl" :src="AIImgUrl" alt="">
                            </div>

                            <el-tabs class="demo-tabs" v-model="LayoutTabs">
                                <el-tab-pane label="ÂÜÖÂÆπËØÜÂà´" name="first">
                                    <el-collapse accordion>
                                        <el-collapse-item title="OCRÊñáÂ≠óËØÜÂà´" name="1">
                                            <div>
                                                Ëá™Âä®ËØÜÂà´ÂõæÁâá‰∏≠ÁöÑÊñáÂ≠ó„ÄÇ
                                            </div>
                                            <el-input v-loading="OCRLoading" :readonly='true' placeholder='ËØÜÂà´ÁªìÊûú...'
                                                type='textarea' :value="OCRResultToPretext(OCRResultData)"
                                                style="padding: 0;width: 100%;"></el-input>
                                            <el-button v-if="OCRResultUrl && !OCRLoading" @click="showOCRResult = true"
                                                size="small">Êü•ÁúãËØ¶ÁªÜÁªìÊûú</el-button>
                                            <el-button @click="OCRStart()" size="small">{{ OCRLoading ?
                                                'ÂÅúÊ≠¢ËØÜÂà´' : 'ÂºÄÂßãËØÜÂà´' }}</el-button>
                                        </el-collapse-item>
                                        <el-collapse-item title="ÁõÆÊ†áÊ£ÄÊµã" name="2">
                                            <div>
                                                Ê£ÄÊµãÂõæÁâá‰∏≠ÁöÑÁâ©ÂìÅ„ÄÇ
                                            </div>
                                            <el-button @click="QuickLayout(2)" size="small">ÂºÄÂßãÁîüÊàê</el-button>
                                        </el-collapse-item>
                                        <el-collapse-item title="Ë°®Ê†ºËØÜÂà´" name="3">
                                            <div>
                                                Ëá™Âä®ËØÜÂà´ÂõæÁâá‰∏≠ÁöÑË°®Ê†º„ÄÇ
                                            </div>
                                            <div v-for="(item, index) in AItableData">
                                                <span class="ai-title-2" v-show="item != ''">Ë°®Ê†º{{index + 1}}Ôºö</span>
                                                <div v-html="item" class="ai-table" v-loading="AItableLoading"
                                                    style="min-height: 100px;max-height: 300px;width: 100%;overflow: auto">
                                                </div>
                                                <el-button style='margin: 10px 0;' v-show="item && !AItableLoading" size="small"
                                                    @click="AIInsert(item.replaceAll('<tr></tr>', '<tr> </tr>').replaceAll('<td></td>','<td> </td>'))">ÊèíÂÖ•ËØ•Ë°®Ê†º</el-button>
                                            </div>
                                            <el-button style='margin-top: 20px' @click="AItableStart()" size="small">{{ AItableLoading ? 'ÂÅúÊ≠¢ÁîüÊàê' :
                                                'ÂºÄÂßãÁîüÊàê'
                                                }}</el-button>
                                        </el-collapse-item>
                                        <el-collapse-item title="ÂõæË°®ÁîüÊàê" name="4">
                                            <div>
                                                Ëá™Âä®Êî∂ÈõÜÂõæÁâá‰∏≠ÁöÑÊï∞ÊçÆÁîüÊàêÂõæË°®„ÄÇ
                                            </div>
                                            <el-select v-model="AIgraphType" placeholder="ÂõæË°®Á±ªÂûã"
                                                style="margin-bottom: 10px;">
                                                <el-option v-for="i in ['Êü±Áä∂Âõæ', 'È•ºÂõæ']" :label="i" :value='i' />
                                            </el-select>
                                            <el-input v-loading="AIgraphGoal" type='textarea'
                                                placeholder="ÂõæË°®ÈúÄÊ±ÇÔºö‰æãÂ¶ÇÊï¥ÁêÜÂõæÁâá‰∏≠ÈîÄÈáèÂíåÊúà‰ªΩÁöÑÂÖ≥Á≥ªÂõæ" style="margin-bottom: 10px;"
                                                rows="6"></el-input>
                                            <el-button @click="QuickLayout(2)" size="small">ÂºÄÂßãÁîüÊàê</el-button>
                                        </el-collapse-item>
                                    </el-collapse>

                                </el-tab-pane>
                                <el-tab-pane label="ÂàõÊÑèÁîüÊàê" name="second">
                                    <el-collapse accordion>
                                        <el-collapse-item title="AIËØÜÂõæ" name="1">
                                            <div>
                                                Ëá™Âä®ËØÜÂà´Â§ßÂÜôÊï∞Â≠ó„ÄÅÂ∞èÂÜôÊï∞Â≠ó‰Ωú‰∏∫Ê†áÈ¢òÔºåËá™Âä®ËØÜÂà´Ê≠£ÊñáÈÉ®ÂàÜ„ÄÇÈÄÇÂêàÈïøÁØáÊñáÁ´†„ÄÇ
                                            </div>
                                            <el-button @click="QuickLayout(1)" size="small">ÁÇπÂáªÂ∫îÁî®</el-button>
                                        </el-collapse-item>
                                        <el-collapse-item title="Ë°®Ê†ºËØÜÂà´" name="2">
                                            <div>
                                                Ëá™Âä®ËØÜÂà´Ê†áÈ¢ò„ÄÅÁß∞ÂëºËØ≠„ÄÅÊ≠£ÊñáÈÉ®ÂàÜ„ÄÅÊó•Êúü„ÄÇÈÄÇÁî®‰∫é‰ø°‰ª∂„ÄÇ
                                            </div>
                                            <el-button @click="QuickLayout(2)" size="small">ÁÇπÂáªÂ∫îÁî®</el-button>
                                        </el-collapse-item>
                                    </el-collapse>
                                </el-tab-pane>

                            </el-tabs>

                            <!-- <div v-loading="isAILoading">

                            </div> -->
                        </div>

                        <div v-if="AISelect == 9">
                            <div style="font-size: 12px;margin: 8px 0;color: #555">ËØ∑Âè≥ÈîÆÈÄâÊã©ÁºñËæëÂô®‰∏≠ÁöÑ‰∏ÄÊÆµÈü≥È¢ë</div>
                            <!-- <span class="ai-title-2">Èü≥È¢ëÂ§ÑÁêÜ</span> -->
                            <audio :src="AIaudioUrl" controls style="width: 100%;"></audio>

                            <span class="ai-title-2">ËØ≠Èü≥ËΩ¨ÊñáÂ≠ó</span>
                            <el-input v-loading="AIaudioTextLoading" type='textarea' placeholder="ÁîüÊàêÁªìÊûú"
                                style="margin-bottom: 10px;" rows="6" v-model="AIaudioText"></el-input>
                            <el-button @click="AIaudioTextStart">{{ AIaudioTextLoading ? 'ÂÅúÊ≠¢ÁîüÊàê' : 'ÂºÄÂßãËΩ¨Êç¢' }}</el-button>

                            <span class="ai-title-2" style="margin-top: 10px">Êï¥ÁêÜÈü≥È¢ëÂ§ßÁ∫≤</span>
                            <div style="font-size: 12px;margin: 8px 0;color: #555">
                                Ê†πÊçÆËØÜÂà´ÁªìÊûúËá™Âä®Êï¥ÁêÜÂá∫Èü≥È¢ëÁöÑÈáçÁÇπÂÜÖÂÆπ„ÄÇÂØπ‰∫éËØÜÂà´‰∏çÂáÜÁ°ÆÁöÑÂÜÖÂÆπÊÇ®ÂèØ‰ª•Âú®‰∏äÊñπÊâãÂä®‰øÆÊîπ</div>

                            <el-input id="AIaudioText2" v-loading="AIaudioText2Loading" type='textarea'
                                placeholder="ÁîüÊàêÁªìÊûú" style="margin-bottom: 10px;" rows="6"
                                v-model="AIaudioText2"></el-input>
                            <el-button @click="AIaudioText2Start">{{ AIaudioText2Loading ? 'ÂÅúÊ≠¢ÁîüÊàê' : 'ÂºÄÂßãÁîüÊàê'
                                }}</el-button>
                        </div>


                        <div v-if="AISelect == 10">
                            <el-collapse accordion>
                                <el-collapse-item title="ÊµÅÁ®ãÂõæÁîüÊàê" name="1">
                                    <div>
                                        Ê†πÊçÆÈÄâ‰∏≠ÁöÑÊñáÊú¨Ëá™Âä®ÁîüÊàêÊµÅÁ®ãÂõæ
                                    </div>
                                    <el-input v-loading="AImermaidLoading" type='textarea' placeholder="ÁîüÊàêÁªìÊûú"
                                        style="margin-bottom: 10px;" rows="6" v-model="AImermaidData"></el-input>
                                    <el-button v-show="!AImermaidLoading && AImermaidData" size="small"
                                        @click="editor.commands.insertContentAt(editor.view.state.selection.to + 1, `<vue-mermaid data='${AImermaidData}'></vue-mermaid>`)">ÊèíÂÖ•ÊµÅÁ®ãÂõæ</el-button>

                                    <el-button @click="AImermaidStart" size="small">{{ AImermaidLoading ? 'ÂÅúÊ≠¢ÁîüÊàê' :
                                        'ÂºÄÂßãÁîüÊàê'
                                        }}</el-button>
                                </el-collapse-item>
                                <el-collapse-item title="ÂõæË°®ÁîüÊàê" name="2">
                                    <div>
                                        Ê†πÊçÆÈÄâ‰∏≠ÁöÑÊñáÊú¨Ëá™Âä®ÁîüÊàêÂõæË°®
                                    </div>
                                    <el-input v-loading="AImermaidLoading" type='textarea' placeholder="ÁîüÊàêÁªìÊûú"
                                        style="margin-bottom: 10px;" rows="6" v-model="AImermaidData"></el-input>
                                    <el-button @click="AImermaidStart" size="small">{{ AImermaidLoading ? 'ÂÅúÊ≠¢ÁîüÊàê' :
                                        'ÂºÄÂßãÁîüÊàê'
                                        }}</el-button>
                                </el-collapse-item>
                            </el-collapse>

                            <!-- <div style="font-size: 12px;margin: 8px 0;color: #555">ÁªìÂêàÂêÑÁßçÊñáÂ≠óËá™Âä®ÁîüÊàê</div> -->
                        </div>


                    </div>
                </div>
            </div>
        </div>
        <el-image-viewer v-if="ImageViewer" @close="CloseImageViewer" :url-list="ImageViewerImg" />

        <el-dialog v-model="isShowAILayout" title="È¢ÑËßà" height="80vh" style="position: relative;" align-center>
            <div class="temp-edit">


                <editor-content :editor="editor2" />
            </div>
            <template #footer>
                <div class="dialog-footer">
                    <span v-show="AILayoutLoading" style="display: inline-flex; align-items: center; height: 40px">
                        <span v-loading="true" style="margin-right: 50px"></span>
                        <span style="font-size: 18px">ÁîüÊàê‰∏≠</span>
                    </span>
                    <el-button @click="HideAILayout">ÂèñÊ∂à</el-button>
                    <el-button type="primary" @click="UseAILayout">‰ΩøÁî®</el-button>
                </div>
            </template>
        </el-dialog>

        <div class="main-buttom print">
            <div>
                <span>Â≠óÊï∞Ôºö{{ CharacterCount2 }}</span>
                <span style="margin-left: 30px;">ÂçïËØçÊï∞Ôºö{{ CharacterWordCount }}</span>
                <span style="margin-left: 30px;" v-if="isCoop">ÂΩìÂâçÊúâ {{ CoopCount }} ‰∫∫Ê≠£Âú®ÂçèÂêåÁºñËæë</span>
            </div>
        </div>

        <bubble-menu :shouldShow="shouldShowMenu" id="bubbleMenu" :editor="editor" :tippy-options="{ duration: 100 }"
            v-if="editor">
            <div class="bubble-menu" @contextmenu.prevent>
                <div class='bubble-menu-1'>
                    <span @click="bold" :class="!isBold ? '' : 'tools-select'"><font-awesome-icon
                            icon='bold'></font-awesome-icon></span>
                    <span @click="italic" :class="!isItalic ? '' : 'tools-select'"><font-awesome-icon
                            icon='italic'></font-awesome-icon></span>
                    <span @click="underline" :class="!isUnderline ? '' : 'tools-select'"><font-awesome-icon
                            icon='underline'></font-awesome-icon></span>
                    <span @click="strikethrough" :class="!isStrikethrough ? '' : 'tools-select'"><font-awesome-icon
                            icon='strikethrough'></font-awesome-icon></span>
                    <span style="width: 50px;">
                        <el-select @change="SetFontSize()" v-model="FontSize2" placeholder="Â≠ó‰ΩìÂ§ßÂ∞è" size="small">
                            <el-option v-for="item in FontSizeList" :key="item" :label="item" :value="item" />
                        </el-select>
                    </span>
                    <span style="margin-left: 5px;">
                        <pick-colors @change="SetFontColor" v-model:value="FontColor"
                            :colors="['#000000', '#ff4500', '#ffd700', '#00ced1', '#1e90ff', '#c71585',]" />
                    </span>
                    <el-dropdown>
                        <span style="margin-left: 0px;padding: 0px 5px;">
                            <font-awesome-icon
                                :icon='TextAlign2 == "center" ? "align-center" : TextAlign2 == "left" ? "align-left" : TextAlign2 == "right" ? "align-right" : "align-justify"'></font-awesome-icon>
                            <font-awesome-icon style="margin-left: 3px;" icon='caret-down'></font-awesome-icon>
                        </span>
                        <template #dropdown>
                            <el-dropdown-menu>
                                <el-dropdown-item>
                                    <span @click="SetTextAlign('left')"
                                        :class="TextAlign2 != 'left' ? '' : 'tools-select'"><font-awesome-icon
                                            icon='align-left'></font-awesome-icon></span>
                                </el-dropdown-item>
                                <el-dropdown-item>
                                    <span @click="SetTextAlign('center')"
                                        :class="TextAlign2 != 'center' ? '' : 'tools-select'"><font-awesome-icon
                                            icon='align-center'></font-awesome-icon></span>
                                </el-dropdown-item>
                                <el-dropdown-item>
                                    <span @click="SetTextAlign('right')"
                                        :class="TextAlign2 != 'right' ? '' : 'tools-select'"><font-awesome-icon
                                            icon='align-right'></font-awesome-icon></span>
                                </el-dropdown-item>
                                <el-dropdown-item>
                                    <span @click="SetTextAlign('justify')"
                                        :class="TextAlign2 != 'justify' ? '' : 'tools-select'"><font-awesome-icon
                                            icon='align-justify'></font-awesome-icon></span>
                                </el-dropdown-item>
                            </el-dropdown-menu>
                        </template>
                    </el-dropdown>

                    <el-dropdown>
                        <span
                            style="margin-left: 0px;padding: 0px 5px;width: 80px;color: blueviolet;text-shadow: #FF76FA 0px 0px 3px;">
                            <!-- <svg t="1719580485285" class="icon" viewBox="0 0 1024 1024" version="1.1"
                                xmlns="http://www.w3.org/2000/svg" p-id="25402">
                                <path
                                    d="M512 85.333333c235.648 0 426.666667 191.018667 426.666667 426.666667s-191.018667 426.666667-426.666667 426.666667S85.333333 747.648 85.333333 512 276.352 85.333333 512 85.333333z m0 85.333334a341.333333 341.333333 0 1 0 0 682.666666 341.333333 341.333333 0 0 0 0-682.666666z m-40.405333 156.586666l121.856 369.706667h-83.968l-27.050667-89.685333H361.898667l-27.648 89.685333H256L378.453333 327.253333h93.141334z m256.213333 0v369.706667h-78.549333V327.253333h78.506666z m-303.36 75.562667H420.693333l-43.306666 144.64h89.898666L424.448 402.773333z"
                                    p-id="25403"></path>
                            </svg> -->
                            AI Tools‚ú®
                            <!-- <font-awesome-icon style="margin-left: 3px;" icon='caret-down'></font-awesome-icon> -->
                        </span>
                        <template #dropdown>
                            <el-dropdown-menu>
                                <el-dropdown-item @click="AItransition()">
                                    <span style="font-size: 12px">ÁøªËØëÈÄâ‰∏≠ÊñáÊú¨</span>
                                </el-dropdown-item>
                                <el-dropdown-item @click="AIsummary()">
                                    <span style="font-size: 12px">ÂÖ®ÊñáÊÄªÁªì</span>
                                </el-dropdown-item>
                                <el-dropdown-item @click="AIabstract()">
                                    <span style="font-size: 12px">ÂÖ®ÊñáÊëòË¶Å</span>
                                </el-dropdown-item>
                                <el-dropdown-item @click="AIcontiune()">
                                    <span style="font-size: 12px">ÊñáÁ´†Áª≠ÂÜô</span>
                                </el-dropdown-item>
                                <el-dropdown-item @click="AISelect = 8">
                                    <span style="font-size: 12px">ÊñáÁ´†Ê∂¶Ëâ≤</span>
                                </el-dropdown-item>
                                <el-dropdown-item @click="AIwrong2right2()">
                                    <span style="font-size: 12px">‰øÆÊîπÁóÖÂè•</span>
                                </el-dropdown-item>
                                <el-dropdown-item @click="isAIOpen = true; AISelect = 6">
                                    <span style="font-size: 12px">Êô∫ËÉΩÊéíÁâà</span>
                                </el-dropdown-item>
                            </el-dropdown-menu>
                        </template>
                    </el-dropdown>


                </div>
                <div class='bubble-menu-1'>

                </div>
            </div>
        </bubble-menu>
        <!--  -->

        <div class="ocr-ghost" v-if="showOCRResult">

            <OCRResult :key="OCRResultUrl" :src="OCRResultUrl" :ocrInfo="OCRResultDataToOcrInfo(OCRResultData)"
                class="ocr-result"></OCRResult>
            <div class="ocr-close" @click="showOCRResult = false">
                <font-awesome-icon icon="times" />
            </div>
            <div class="ocr-pre">
                <div style="height: 80px;"></div>
                <!-- <div class="ocr-copy" @click="copy">Â§çÂà∂ÂÖ®ÈÉ®</div> -->
                <textarea :value="OCRResultToPretext(OCRResultData)" name="" id=""></textarea>
            </div>
        </div>


        <el-dialog align-center v-model="showCoopCode" title="Âä†ÂÖ•ÂçèÂêåÁºñËæë" width="500">
            <span></span>
            <template #footer>
                <div style="display: flex; align-items: flex-start; flex-direction: column;">
                    <div style="margin-bottom: 20px;">ËØ∑ËæìÂÖ•ÂçèÂêåÁ†ÅÔºö</div>
                    <el-input v-model="coopCode"></el-input>
                </div>
                <div style="display: flex; justify-content: right; margin-top: 20px;">
                    <el-button type="primary" @click="joinCoop(); centerDialogVisible = false">
                        Âä†ÂÖ•
                    </el-button>
                </div>
            </template>
        </el-dialog>


    </div>
</template>
<script setup>
import { getCurrentInstance, nextTick, onBeforeUnmount, onMounted, onUnmounted, reactive, ref, watch } from "vue";
import { useRouter, useRoute } from 'vue-router';
import { Editor, EditorContent, BubbleMenu } from "@tiptap/vue-3";
import StarterKit from "@tiptap/starter-kit";
import Color from "@tiptap/extension-color";
import TextStyle from "@tiptap/extension-text-style";
import FontSize from 'tiptap-extension-font-size'
import ContextMenu from '@imengyu/vue3-context-menu'
import Underline from '@tiptap/extension-underline'
import PickColors from 'vue-pick-colors'
import TextAlign from '@tiptap/extension-text-align'
import CharacterCount from '@tiptap/extension-character-count'
import Focus from '@tiptap/extension-focus'
import Superscript from '@tiptap/extension-superscript'
import Subscript from '@tiptap/extension-subscript'
import Link from '@tiptap/extension-link'
// import Heading from '@tiptap/extension-heading'
import Heading from '@/components/Heading2.js'
import TaskItem from '@tiptap/extension-task-item'
import TaskList from '@tiptap/extension-task-list'
import mermaid from '@/components/MermaidNode.js'
import VueMermaid from '@/components/MermaidNode.vue'
import Paper from '../components/Draw.js'
import { ElMessage, ElNotification } from 'element-plus'
import { ElMessageBox } from 'element-plus'
import { useStore } from '@/store/index.js'
import BubbleMenu2 from '@tiptap/extension-bubble-menu'
import UniqueID from '@tiptap-pro/extension-unique-id'
import CodeBlockLowlight from '@tiptap/extension-code-block-lowlight'
import { createLowlight, common } from 'lowlight'
import Table from '@tiptap/extension-table'
import TableCell from '@tiptap/extension-table-cell'
import TableHeader from '@tiptap/extension-table-header'
import TableRow from '@tiptap/extension-table-row'
import EchartsBar from "@/components/EchartsBar.js";
import EchartsPie from "@/components/EchartsPie.js";
import { baseUrl, baseUrl2, request } from '../axios.js'
import Gapcursor from '@tiptap/extension-gapcursor'
import Commands from '@/components/CommandsList.js'
import suggestion from '@/components/CommandsListSug.js'
import Placeholder from '@tiptap/extension-placeholder'
import Image from '@tiptap/extension-image'
import ImageResize from 'tiptap-extension-resize-image';
import { SearchAndReplace } from "@sereneinserenade/tiptap-search-and-replace";
import ImageUploadExtension from "@/components/uploadImage/imageUploadExtension";
import { ImagePlaceholder } from "@/components/uploadImage/imagePlaceholder.js";
import Collaboration from '@tiptap/extension-collaboration'
import * as Y from 'yjs'
import CollaborationCursor from '@tiptap/extension-collaboration-cursor'
import { HocuspocusProvider } from '@hocuspocus/provider'
import * as layout from '@/layout.js'
import { Indent } from "@/components/Indent.js";
import { Node, mergeAttributes, nodeInputRule } from '@tiptap/core';
import Dropcursor from '@tiptap/extension-dropcursor'
import Blockquote from "@tiptap/extension-blockquote";
import hortzontalRule from "@tiptap/extension-horizontal-rule";
import OCRResult from '@/components/OCRResult.vue'
import AudioNode from "@/components/AudioNode.js";
import { Base64 } from "js-base64";
const lowlight = createLowlight(common)
// lowlight./
// import mermaid from 'mermaid'
const router = useRouter();
const route = useRoute();
const store = useStore()
let Template = ''
store.DocTitle = 'ÊñáÊ°£'
// route.query.id
if (route.query.template == 'graph') {
    Template = '<vue-mermaid data="graph TB\n‰ΩøÁî®mermaid-->ÂàõÂª∫ÊÇ®ÁöÑÂõæË°®"></vue-mermaid>'
} else if (route.query.template == 'blank') {
    Template = ''
} else if (route.query.template == 'doc') {
    Template = `<h1 style="text-align: center" id="h-dc42ebe3">Ê†áÈ¢ò111</h1><p><strong>Âä†Á≤óÊñá<span style="font-size: 18pt">Â≠ó</span><em><span style="font-size: 18pt">Êñú‰ΩìÊñá</span>Â≠ó</em></strong><u><strong><em>‰∏ãÂàíÁ∫ø<s>Âà†Èô§Á∫ø</s></em></strong></u></p><p></p><p style="text-align: right"><u><strong><em><s><span style="color: #FF0000">ÁÇ´</span><span style="color: #0C11C7">ÂΩ©Êñá</span><span style="color: #00FF40">Â≠óÂì¶</span></s></em></strong></u></p><p></p><h2 id="h-3d6be47f"><strong><em><span style="color: #FF0000">‰∫åÁ∫ßÊ†áÈ¢ò</span></em></strong></h2><ul><li><p>Êó†Â∫èÂàóË°®</p></li><li><p>2222</p></li><li><p>3333</p></li><li><p>4444</p></li></ul><ul data-type="taskList"><li data-checked="false" data-type="taskItem"><label><input type="checkbox"><span></span></label><div><p>ÂæÖÂäû‰∫ãÈ°π1</p></div></li><li data-checked="false" data-type="taskItem"><label><input type="checkbox"><span></span></label><div><p>ÂÆåÊàê‰∫ÜÂì¶</p></div></li><li data-checked="true" data-type="taskItem"><label><input type="checkbox" checked="checked"><span></span></label><div><p>ÊííÂ§ßËãèÊâì</p></div></li><li data-checked="false" data-type="taskItem"><label><input type="checkbox"><span></span></label><div><p>ÊííÂ§ßËãèÊâì</p></div></li></ul><p>a<sup>2</sup>+b<sup>2</sup>=c<sup>2</sup></p>`
} else if (route.query.template == 'open') {
    Template = ''
    store.isSave = true
    // ÊâìÂºÄÊñá‰ª∂
    nextTick(() => {
        OpenLocal()
    })
}


function CreateEditor(isCoop = false, useDoc = true) {
    let cc = isCoop ?
        [CollaborationCursor.configure({
            provider: provider,
            user: {
                name: store.UserInfo.name,
            },
        })] : []
    let ccdoc = useDoc ? [Collaboration.configure({ document: doc })] : []
    return new Editor({
        // content: "",
        extensions: [
            hortzontalRule, Blockquote,
            ...ccdoc,
            // Dropcursor,
            Underline, FontSize, StarterKit.configure({
                dropcursor: false,
                gapcursor: false,
            }), TextStyle, CharacterCount, Superscript, Subscript,
            Color.configure({ types: ["textStyle"], }),
            TextAlign.configure({ types: ['heading', 'paragraph'], }),
            Focus.configure({ className: 'focus', }),
            Link.configure({ autolink: true, linkOnPaste: true, openOnClick: false }),
            Heading.configure({ levels: [1, 2, 3, 4] }),
            TaskList, TaskItem, EchartsBar, EchartsPie, Image.configure({
                inline: true,
            }), ImageResize,
            ImageUploadExtension.configure({
                acceptMimes: ['image/jpeg', 'image/gif', 'image/png', 'image/jpg'],
                upload: uploadImage,
            }),
            ImagePlaceholder.configure({
                inline: false
            }),
            mermaid, Paper, Commands.configure({ suggestion }),
            Placeholder.configure({ placeholder: 'Write something ‚Ä¶', }),
            CodeBlockLowlight.extend({
                addKeyboardShortcuts() {
                    return {
                        ...this.parent?.(),
                        'Tab': () => {
                            if (this.editor.isActive('codeBlock')) { return this.editor.commands.insertContent('    '); }
                            // return true;
                        },
                        'Enter': () => {
                            if (this.editor.isActive('codeBlock')) { 
                                this.editor.commands.insertContent('\n1111'); 
                                return true;
                            }
                            // return true;
                        }
                    }
                }
            }).configure({ lowlight, languageClassPrefix: 'language-', }),
            Table.configure({ resizable: true, }), TableRow, TableHeader, TableCell,
            SearchAndReplace.configure({
                searchResultClass: "search-result"
            }),
            ...cc,
            Indent, Gapcursor, AudioNode
        ],
        autofocus: true,
        editable: true,
        injectCSS: true,
        content: Template,
    })
}

let fileId = ''
let fileLoading = ref(false)
if (route.query.id) {
    fileLoading.value = true
    // Ëé∑ÂèñÊñá‰ª∂
    fileId = route.query.id
    console.log(111);
    request({
        url: '/api/file/text/',
        method: 'get',
        params: {
            text_id: route.query.id
        }
    }).then((response) => {
        Template = JSON.parse(response.data.content).content
        // console.log(Template);
        store.isSave = true
        store.DocTitle = response.data.name
        editor.commands.setContent(Template)
        fileLoading.value = false
    }).catch((error) => {
        fileLoading.value = false
        ElNotification({
            title: 'ÈîôËØØ',
            message: 'ÊâìÂºÄÊñá‰ª∂Â§±Ë¥•',
            type: 'error',
        })
    })
}
console.log(222);
function GotoHome() {
    if (store.isSave) {
        router.push('/')
    } else {
        ElMessageBox.confirm('ÂΩìÂâçÊñá‰ª∂ËøòÊ≤°Êúâ‰øùÂ≠òÔºåÁ°ÆÂÆöË¶ÅËøîÂõûÈ¶ñÈ°µÂêó', 'Ë≠¶Âëä', {
            confirmButtonText: 'Á°ÆÂÆö',
            cancelButtonText: 'ÂèñÊ∂à',
            type: 'warning',
        }).then(() => {
            setTimeout(() => {
                router.push('/')
            }, 0);
        }).catch(() => {
            console.log('ÂèñÊ∂à');
        });
    }
}


console.log(document.getElementById('bubbleMenu1'));
const LayoutTabs = ref('first')
let doc = new Y.Doc()
let provider = undefined
const isCoop = ref(false)
const coopCode = ref('')
const showCoopCode = ref(false)
// startCoop()
if (route.query.coopcode) {
    showCoopCode.value = true
    coopCode.value = route.query.coopcode
}
// const state = reactive({
let editor = CreateEditor()


function startCoop() {
    if (!store.UserInfo.name) {
        ElNotification({
            title: 'ÈîôËØØ',
            message: 'ËØ∑ÂÖàÁôªÂΩï',
            type: 'error',
        })
        return
    }
    function randomCode() {
        return Math.random().toString(36).substring(2, 8)
    }
    coopCode.value = randomCode().toUpperCase()
    isCoop.value = true
    provider = new HocuspocusProvider({
        url: baseUrl2,
        name: coopCode.value.toUpperCase(),
        document: doc,
        onSynced() {
            if (!doc.getMap('config').get('initialContentLoaded') && editor) {
                doc.getMap('config').set('initialContentLoaded', true)
                // editor.commands.setContent()
            }
            ElNotification({
                title: 'ÊàêÂäü',
                message: 'Â∑≤ÂºÄÂêØÂçèÂêåÁºñËæëÔºåÊÇ®ÁöÑÂçèÂêåÁ†ÅÊòØ' + coopCode.value.toUpperCase(),
                type: 'success',
            })
        },
    })
    let temp = editor.getHTML()
    editor.destroy()
    editor = CreateEditor(true)
    editor.commands.setContent(temp)
    // GetDocTitle(temp)
    // editor
    // editor.registerPlugin(CollaborationCursor.configure({
    //     provider: provider,
    //     user: {
    //         name: store.UserInfo.name,
    //     },
    //     // PluginKey: 'collaborationCursor',
    // }))
    // console.log(editor.registerPlugin);

}
const TopTabs = ref()
const CoopCount = ref(0)
setInterval(() => {
    if (isCoop.value) {
        request({
            baseUrl: baseUrl2,
            url: '/get_doc_num?doc=' + coopCode.value.toUpperCase(),
            method: 'GET',
        }).then((response) => {
            CoopCount.value = response.data.num
        })
    }
}, 2000);

function stopCoop() {
    isCoop.value = false
    provider.destroy()
    ElNotification({
        title: 'ÊàêÂäü',
        message: 'Â∑≤ÈÄÄÂá∫ÂçèÂêåÁºñËæë',
        type: 'success',
    })
    let temp = editor.getHTML()
    editor.destroy()
    editor = CreateEditor(false)
    editor.commands.setContent(temp)
    // editor.unregisterPlugin('collaborationCursor')
}

function getCoop() {
    console.log(coopCode.value);
    //ÂÜçÂÜô‰∏Ä‰∏™Â§çÂà∂ÊåâÈíÆÔºåÁÇπÂáªÂ§çÂà∂ÂçèÂêåÁ†Å
    ElMessageBox.alert(`ÊÇ®ÁöÑÂçèÂêåÁ†ÅÊòØ${coopCode.value.toUpperCase()}„ÄÇ\nÂ§çÂà∂ÈìæÊé•https://editor.funny233.xyz/editor?coopcode=${coopCode.value.toUpperCase()} ÈÇÄËØ∑Âä†ÂÖ•Âçè‰Ωú„ÄÇ`, 'ÂçèÂêåÁ†Å', {
        confirmButtonText: 'Á°ÆÂÆö',
        type: 'info',
    }).then(() => {

    }).catch(() => {

    });
}

function joinCoop() {
    console.log(store.UserInfo.name);
    if (!store.UserInfo.name) {
        ElNotification({
            title: 'ÈîôËØØ',
            message: 'ËØ∑ÂÖàÁôªÂΩï',
            type: 'error',
        })
        return
    }
    function joinCoop2() {
        console.log(coopCode.value);
        request({
            baseUrl: baseUrl2,
            url: '/check_doc?doc=' + coopCode.value.toUpperCase(),
            method: 'GET',
        }).then((response) => {
            if (response.data.type) {
                editor.commands.setContent('')
                provider = undefined
                provider = new HocuspocusProvider({
                    url: baseUrl2,
                    name: coopCode.value,
                    document: doc,
                    onSynced() {
                        if (!doc.getMap('config').get('initialContentLoaded') && editor) {
                            doc.getMap('config').set('initialContentLoaded', true)

                        }
                        showCoopCode.value = false
                        ElNotification({
                            title: 'ÊàêÂäü',
                            message: 'Â∑≤Âä†ÂÖ•ÂçèÂêåÁºñËæë',
                            type: 'success',
                        })
                        isCoop.value = true
                    },
                })
                editor.destroy()
                editor = CreateEditor(true)
            } else {
                ElNotification({
                    title: 'ÈîôËØØ',
                    message: 'ÂçèÂêåÁ†Å‰∏çÂ≠òÂú®',
                    type: 'error',
                })
            }
        })
    }
    if (!store.isSave) {
        ElMessageBox.confirm('ÂΩìÂâçÊñá‰ª∂ËøòÊ≤°Êúâ‰øùÂ≠òÔºåÁ°ÆÂÆöË¶ÅÂä†ÂÖ•ÂçèÂêåÁºñËæëÂêó', 'Ë≠¶Âëä', {
            confirmButtonText: 'Á°ÆÂÆö',
            cancelButtonText: 'ÂèñÊ∂à',
            type: 'warning',
        }).then(() => {
            setTimeout(() => {
                joinCoop2()
            }, 0);
        }).catch(() => {
            console.log('ÂèñÊ∂à');
        });
    } else {
        joinCoop2()
    }



}

onMounted(() => {

    // editor.registerPlugin(BubbleMenu2.config({pluginKey: 'bubbleMenu', element: document.querySelector('#bubbleMenu')}));
})


function uploadImage(file) {
    console.log(111);
    var formData = new FormData();
    formData.append("photo", file);
    return request({
        url: '/api/file/photo/',
        body: formData,
        method: 'post',
        headers: {
            'Content-Type': 'application/form-data'
        }
    }).then((response) => {
        return baseUrl + response.data.photo_path
    }).catch((error) => {
        return false
    })
}

function uploadImage2() {
    document.getElementById('uploadImg2').click()
}

function InsertPic3({ target }) {
    const file = target.files[0]
    target.value = ''
    var formData = new FormData();
    formData.append("photo", file);
    request({
        url: '/api/file/photo/',
        body: formData,
        method: 'post',
        headers: {
            'Content-Type': 'application/form-data'
        }
    }).then((response) => {
        AIImgUrl.value = baseUrl + response.data.photo_path
    }).catch((error) => {
        return false
    })
}

function InsertPic2() {
    document.getElementById('uploadImg').click()
}
function InsertPic({ target }) {
    const file = target.files[0]
    target.value = ''
    editor.commands.uploadImage({ file })
}
async function test() {
    // document.execCommand('paste')
    // editor.commands.deleteSelection()
    // let audio = fetch('https://editor.funny233.xyz/static/audio/1.mp3')
    // request
}
//ËÆæÁΩÆÈ¢úËâ≤
const onColor = ($event) => {
    // debugger;
    editor.chain().focus().setColor($event.target.value).run();
};
//Ëé∑ÂèñHtml
const getHTML = () => {
    state.result = editor.getHTML();
};

const ShowTools = ref(true)
function ChangeShowTools() {
    ShowTools.value = !ShowTools.value
}

function GetDocTitle(str) {
    let parser = new DOMParser();
    let doc = parser.parseFromString(str, 'text/html');
    console.log(doc.querySelector('body').firstElementChild.textContent);
    return doc.querySelector('body').firstElementChild.textContent
}

function SaveLocal() {
    store.isSave = true
    let html = editor.getHTML()
    let blob = new Blob([JSON.stringify({
        content: html
    })], { type: "text/plain;charset=utf-8" });
    // let objectURL = window.URL.createObjectURL(blob);
    const link = document.createElement('a');
    link.href = window.URL.createObjectURL(blob);
    link.download = ((store.DocTitle === 'ÊñáÊ°£' || store.DocTitle === '') ? (GetDocTitle(html) || 'ÊñáÊ°£') : store.DocTitle) + '.smd';
    store.DocTitle = (store.DocTitle === 'ÊñáÊ°£' || store.DocTitle === '') ? (GetDocTitle(html) || 'ÊñáÊ°£') : store.DocTitle
    link.click();
}
function SaveServer() {
    let html = editor.getHTML()
    if (fileId) {
        request({
            url: '/api/file/text/',
            method: 'put',
            body: {
                text_id: fileId,
                update_type: 'content',
                content: JSON.stringify({ content: editor.getHTML() })
            }
        }).then((response) => {
            ElNotification({
                title: 'ÊàêÂäü',
                message: '‰øùÂ≠òÊàêÂäü',
                type: 'success',
            })
            store.isSave = true
        })
    } else {
        request({
            url: '/api/file/text/',
            method: 'post',
            body: {
                content: JSON.stringify({ content: editor.getHTML() }),
                name: (store.DocTitle === 'ÊñáÊ°£' || store.DocTitle === '') ? (GetDocTitle(html) || 'ÊñáÊ°£') : store.DocTitle,
                location_type: 0
            }
        }).then((response) => {
            ElNotification({
                title: 'ÊàêÂäü',
                message: '‰øùÂ≠òÊàêÂäü',
                type: 'success',
            })
            store.isSave = true
            store.DocTitle = (store.DocTitle === 'ÊñáÊ°£' || store.DocTitle === '') ? (GetDocTitle(html) || 'ÊñáÊ°£') : store.DocTitle
            fileId = response.data.id
        })
    }
}

window.addEventListener('beforeunload', function (e) {
    if (!store.isSave) {
        e.returnValue = 'ÂΩìÂâçÊñá‰ª∂ËøòÊ≤°Êúâ‰øùÂ≠òÔºåÁ°ÆÂÆöË¶ÅÁ¶ªÂºÄÂêó';
    }
});

function OpenLocal() {
    if (!store.isSave) {
        ElMessageBox.confirm('ÂΩìÂâçÊñá‰ª∂ËøòÊ≤°Êúâ‰øùÂ≠òÔºåÁ°ÆÂÆöË¶ÅÊâìÂºÄÊñ∞Êñá‰ª∂Âêó', 'Ë≠¶Âëä', {
            confirmButtonText: 'Á°ÆÂÆö',
            cancelButtonText: 'ÂèñÊ∂à',
            type: 'warning',
        }).then(() => {
            setTimeout(() => {
                store.isSave = true
                document.getElementById('OpenLocal2').click();
            }, 0);
        }).catch(() => {
            console.log('ÂèñÊ∂à');
        });
    } else {
        document.getElementById('OpenLocal2').click();
    }
}

function OpenLocal2(e) {
    if (!e.target.files.length) return
    try {
        let file = e.target.files[0];
        let reader = new FileReader(); // Á≠õÈÄâÂêéÁºÄ‰∏∫smdÊ†ºÂºè


        reader.onloadend = function (e) {
            try {
                console.log(file);
                let html = JSON.parse(e.target.result).content
                editor.commands.setContent(html)
                store.DocTitle = file.name.split('.').slice(0, -1).join('.')
                store.isSave = true
                editor.state.history$.prevRanges = null;
                editor.state.history$.done.eventCount = 0
                CanUndo.value = editor.can().undo()
                CanRedo.value = editor.can().redo()
                ElNotification({
                    title: 'ÊàêÂäü',
                    message: 'ÊâìÂºÄÊñá‰ª∂ÊàêÂäü',
                    type: 'success',
                })
            } catch (error) {
                ElNotification({
                    title: 'ÈîôËØØ',
                    message: 'ÊâìÂºÄÊñá‰ª∂Â§±Ë¥•ÔºöÂèØËÉΩ‰∏çÊòØÊâÄÈúÄÊ†ºÂºè',
                    type: 'error',
                })
            }
        }
        reader.readAsText(file);
    } catch (error) {
        ElNotification({
            title: 'ÈîôËØØ',
            message: 'ÊâìÂºÄÊñá‰ª∂Â§±Ë¥•ÔºöÂèØËÉΩ‰∏çÊòØÊâÄÈúÄÊ†ºÂºè',
            type: 'error',
        })
    }
}

function NewFile() {
    if (!store.isSave) {
        ElMessageBox.confirm('ÂΩìÂâçÊñá‰ª∂ËøòÊ≤°Êúâ‰øùÂ≠òÔºåÁ°ÆÂÆöË¶ÅÊñ∞Âª∫Êñá‰ª∂Âêó', 'Ë≠¶Âëä', {
            confirmButtonText: 'Á°ÆÂÆö',
            cancelButtonText: 'ÂèñÊ∂à',
            type: 'warning',
        }).then(() => {
            store.isSave = true
            editor.commands.setContent('')
            store.DocTitle = 'ÊñáÊ°£'
            editor.state.history$.prevRanges = null;
            editor.state.history$.done.eventCount = 0
            CanUndo.value = editor.can().undo()
            CanRedo.value = editor.can().redo()
        }).catch(() => {
            console.log('ÂèñÊ∂à');
        });
    } else {
        editor.commands.setContent('')
        store.DocTitle = 'ÊñáÊ°£'
    }
}

function SavePDF() {
    setTimeout(() => {
        window.print()
    }, 1000);
}

const EditorActive = () => {
    editor.chain().focus().run();
};

function shouldShowMenu({ editor, view, state, oldState, from, to }) {
    if (from - to == 0) return false
    return !(editor.isActive('image') || editor.isActive('paper') || editor.isActive('EchartsBar') || editor.isActive('EchartsPie') || editor.isActive('mermaid'));

}

function undo() {
    editor.chain().undo().run()
}
function redo() {
    editor.chain().redo().run()
}
const isBold = ref(false)
const isItalic = ref(false)
const isUnderline = ref(false)
const isStrikethrough = ref(false)

function bold() {
    editor.chain().focus().toggleBold().run()
    isBold.value = editor.isActive('bold')
    // isBold.value = !isBold.value
}
function italic() {
    editor.chain().focus().toggleItalic().run()
    isItalic.value = editor.isActive('italic')
    // isItalic.value = !isItalic.value
}
function underline() {
    editor.commands.toggleUnderline()
    isUnderline.value = editor.isActive('underline')
    // isUnderline.value = !isUnderline.value
}
function strikethrough() {
    editor.chain().focus().toggleStrike().run()
    isStrikethrough.value = editor.isActive('strike')
    // isStrikethrough.value = !isStrikethrough.value
}

const CanUndo = ref(false)
const CanRedo = ref(false)

const FontSize2 = ref(12)
const FontSizeList = [8, 10, 12, 14, 16, 18, 20, 24, 28, 32, 36, 40, 48, 56, 64, 72]
function SetFontSize() {
    editor.chain().focus().setFontSize(FontSize2.value + 'pt').run()
}

const FontColor = ref('#000000')
function SetFontColor() {
    editor.chain().focus().setColor(FontColor.value).run()
}

const TextAlign2 = ref('left')
function SetTextAlign(value) {
    editor.chain().focus().setTextAlign(value).run()
    // TextAlign2.value = value
    if (editor.isActive({ textAlign: 'justify' })) {
        TextAlign2.value = 'justify'
    } else if (editor.isActive({ textAlign: 'center' })) {
        TextAlign2.value = 'center'
    } else if (editor.isActive({ textAlign: 'right' })) {
        TextAlign2.value = 'right'
    } else {
        TextAlign2.value = 'left'
    }
}
const isSubscript = ref(false)
function SetSubscript() {
    editor.chain().focus().toggleSubscript().run()
    isSubscript.value = editor.isActive('subscript')

    // isSubscript.value = !isSubscript.value
}

const isSuperscript = ref(false)
function SetSuperscript() {
    editor.chain().focus().toggleSuperscript().run()
    // isSuperscript.value = !isSuperscript.value
    isSuperscript.value = editor.isActive('superscript')
}
const isLink = ref(false)
function SetLink() {
    if (isLink.value) {
        editor.chain().focus().unsetLink().run()
    } else {

    }
}

const isCode = ref(false)
function SetCode() {
    editor.chain().focus().toggleCodeBlock().run()
    isCode.value = editor.isActive('codeBlock')
}

let TitleList = reactive([])

function extractHeadings() {
    let parser = new DOMParser();
    let doc = parser.parseFromString(editor.getHTML(), 'text/html');
    let headings = [];
    let headingElements = doc.querySelectorAll('h1, h2, h3');
    headingElements.forEach(element => {
        let level;
        switch (element.tagName.toLowerCase()) {
            case 'h1':
                level = 1;
                break;
            case 'h2':
                level = 2;
                break;
            case 'h3':
                level = 3;
                break;
        }
        headings.push({
            title: element.textContent.trim(),
            level: level,
            id: element.id
        });
    });
    TitleList = headings
}

function GotoTitle(id) {
    let element = document.getElementById(id);
    console.log(id);
    element.scrollIntoView({ behavior: 'smooth' });
}

const Heading2 = ref(0)
function SetHeading(value) {
    editor.chain().focus().toggleHeading({ level: value }).run()
    // Heading2.value = value
    let flag = false
    for (let i = 1; i <= 4; i++) {
        if (editor.isActive('heading', { level: i })) {
            Heading2.value = i
            flag = true
            break
        }
    }
}
const isListol = ref(false)
function SetListol() {
    editor.chain().focus().toggleOrderedList().run()
    isListol.value = editor.isActive('orderedList')
    isListul.value = editor.isActive('bulletList')
}
const isListul = ref(false)
function SetListul() {
    editor.chain().focus().toggleBulletList().run()
    isListol.value = editor.isActive('orderedList')
    isListul.value = editor.isActive('bulletList')
}
const isTasks = ref(false)
function SetTasks() {
    editor.chain().focus().toggleTaskList().run()
    isTasks.value = editor.isActive('taskList')
}

function InsertGraph(type) {
    if (type == 1) {
        let to = editor.view.state.selection.to
        editor.chain().focus().insertContentAt(to + 1, '<vue-mermaid data="graph TB\n‰ΩøÁî®mermaid-->ÂàõÂª∫ÊÇ®ÁöÑÂõæË°®"></vue-mermaid>').run()
    } else if (type == 2) {
        let to = editor.view.state.selection.to
        editor.commands.insertContentAt(to + 1, '<vue-echarts-bar></vue-echarts-bar>')
    } else if (type == 3) {
        let to = editor.view.state.selection.to
        editor.commands.insertContentAt(to + 1, '<vue-echarts-pie></vue-echarts-pie>')
    }
}

function InsertDraw() {
    let to = editor.view.state.selection.to
    editor.chain().focus().insertContentAt(to + 1, '<div data-type="paper"></div>').run()
}

function SaveHTML() {
    // editor.setHTML('<div data-mermaid>qwq</div>')
    console.log(editor.getHTML());
}

const isTable = ref(false)
const InsertTableCol = ref(3)
const InsertTableRow = ref(3)
function InsertTable() {
    // editor.
    // test()
    editor.chain().focus().insertTable({ rows: InsertTableRow.value, cols: InsertTableCol.value }).run()
}
function InsertTableLine(value) {
    if (value == 'left') {
        editor.commands.addColumnBefore();
    } else if (value == 'right') {
        editor.commands.addColumnAfter();
    } else if (value == 'up') {
        editor.commands.addRowBefore();
    } else if (value == 'down') {
        editor.commands.addRowAfter();
    }
}

function DeleteTable(value) {
    if (value == 'row') {
        editor.commands.deleteRow();
    } else if (value == 'col') {
        editor.commands.deleteColumn();
    }
}

function debounce(func, delay) {
    let timerId;
    return function (...args) {
        clearTimeout(timerId);
        timerId = setTimeout(() => {
            func.apply(this, args);
        }, delay);
    };
}


// Âè≥ÈîÆÁºñËæëÂô®
const contextMenu = ref(null)
const contextMenuData = ref(null)
const contextMenuStyle = ref({
    display: 'none',
    left: '0px',
    top: '0px',
})
function EditorContext(event) {
    console.log(editor.isActive('audio'));
    let isAudio = editor.isActive('audio') ? [{
        label: 'Èü≥È¢ëÂ§ÑÁêÜ',
        onClick: () => {
            isAIOpen.value = true
            AIaudioUrl.value = editor.getAttributes('audio').src
            AISelect.value = 9
            console.log(AIaudioUrl.value);
        }
    }] : []
    let isImage = editor.isActive('image') ? [{
        label: 'AIËØÜÂõæ', onClick: () => {
            isAIOpen.value = true
            AIImgUrl.value = editor.getAttributes('image').src
            AISelect.value = 7
        }
    }] : []
    let isText = (!editor.isActive('audio') && !editor.isActive('image') && !editor.isActive('paper') && !editor.isActive('EchartsBar') && !editor.isActive('EchartsPie') && !editor.isActive('mermaid'))
        ? [{
            label: 'AIÁøªËØë',
            onClick: () => { AItransition() }
        }, {
            label: 'AIÂÖ®ÊñáÊÄªÁªì',
            onClick: () => { AIsummary() }
        }, {
            label: 'AIÂÖ®ÊñáÊëòË¶Å',
            onClick: () => { AIabstract() }
        }, {
            label: 'AIÊñáÁ´†Áª≠ÂÜô',
            onClick: () => { AIcontiune() }
        }, {
            label: 'AIÊñáÁ´†Ê∂¶Ëâ≤',
            onClick: () => { AISelect.value = 8 }
        }, {
            label: 'AI‰øÆÊîπÁóÖÂè•',
            onClick: () => { AIwrong2right2() }
        }] : []
    ContextMenu.showContextMenu({
        preserveIconWidth: false,
        x: event.x, y: event.y, theme: 'flat',
        items: [{
            label: 'Ââ™Âàá',
            onClick: () => { document.execCommand('cut') }
        }, {
            label: 'Â§çÂà∂',
            onClick: () => {
                document.execCommand('copy')

            }
        }, {
            label: 'Á≤òË¥¥',
            onClick: async (event) => {
                // const clipboard = await navigator.clipboard.readText()
                // editor.chain().focus().insertContent(clipboard).run()
                const clipboardItems = await navigator.clipboard.read();
                for (const item of clipboardItems) {
                    if (item.types.includes('text/html')) {
                        const blob = await item.getType('text/html');
                        const html = await blob.text();
                        editor.chain().focus().insertContent(html).run();
                    } else if (item.types.includes('text/plain')) {
                        const blob = await item.getType('text/plain');
                        const text = await blob.text();
                        editor.chain().focus().insertContent(text).run();
                    }
                }
            }
        }, {
            label: 'ÂÖ®ÈÄâ',
            onClick: () => {
                editor.chain().focus('all').run();
            }
        }, { divided: true }, {
            label: 'Êí§ÈîÄ',
            disabled: !CanUndo.value,
            onClick: () => { undo() }
        }, {
            label: 'ÈáçÂÅö',
            disabled: !CanRedo.value,
            onClick: () => { redo() }
        }, { divided: true }, {
            label: 'Ë°®Ê†º',
            disabled: !isTable.value,
            children: [{
                label: 'ÂêëÂêéÊèíÂÖ•‰∏ÄÂàó',
                onClick: () => { InsertTableLine('right') }
            }, {
                label: 'ÂêëÂâçÊèíÂÖ•‰∏ÄÂàó',
                onClick: () => { InsertTableLine('left') }
            }, {
                label: 'Âêë‰∏ãÊèíÂÖ•‰∏ÄË°å',
                onClick: () => { InsertTableLine('down') }
            }, {
                label: 'Âêë‰∏äÊèíÂÖ•‰∏ÄË°å',
                onClick: () => { InsertTableLine('up') }
            }, { divided: true }, {
                label: 'Âà†Èô§Ë°å',
                onClick: () => { DeleteTable('row') }
            }, {
                label: 'Âà†Èô§Âàó',
                onClick: () => { DeleteTable('col') }
            }, { divided: true }, {
                label: 'ÂêàÂπ∂ÂçïÂÖÉÊ†º',
                onClick: () => { editor.commands.mergeCells() }
            }, {
                label: 'ÊãÜÂàÜÂçïÂÖÉÊ†º',
                onClick: () => { editor.commands.splitCell() }
            }]
        }, { divided: true }, {
            label: 'AIÂ∑•ÂÖ∑',
            children: [...isText, ...isImage, ...isAudio]
        }]
    })
}
const ShowTree = ref(window.innerWidth >= 768)
const isAIOpen = ref(true)
// const AIData = ref('')
const AISelect = ref(1)
// const isAILoading = ref(false)

// let ctrl = new AbortController()
function AIInsert(data) {
    // console.log(data);
    let to = editor.view.state.selection.to
    // console.log(JSON.stringify(editor.view.state.selection));
    editor.chain().focus().insertContentAt(to + 1, data).run()
}

const AItransitionFrom = ref('Ëá™Âä®ËØÜÂà´')
const AItransitionTo = ref('‰∏≠ÊñáÔºàÁÆÄ‰ΩìÔºâ')
const AItransitionLoading = ref(false)
const AItransitionData = ref('')
let AItransitionCtrl = new AbortController()
function AItransition() {
    if (AItransitionLoading.value) {
        AItransitionCtrl.abort()
        AItransitionLoading.value = false
        return
    }
    AItransitionCtrl = new AbortController()
    AISelect.value = 1
    isAIOpen.value = true
    AItransitionData.value = ''
    const view = editor.view
    const state2 = editor.state
    const { from, to } = view.state.selection
    const text = state2.doc.textBetween(from, to, '\n')
    if (text == '') {
        ElNotification({
            title: 'ÈîôËØØ',
            message: 'ËØ∑ÂÖàÈÄâ‰∏≠‰∏ÄÊÆµÊñáÊú¨',
            type: 'error',
        })
        return
    }
    console.log(text);
    AItransitionLoading.value = true
    request({
        url: '/api/ai/translate/',
        method: 'POST',
        isEventSource: true,
        signal: AItransitionCtrl.signal, // AbortSignal
        body: {
            content: text,
            type: AItransitionTo.value
        },
        headers: {
            'Accept': `text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7`,
            'content-type': 'application/json',
        },
        onmessage: (ev) => {
            if (ev.data != '[DONE]') {
                AItransitionData.value += Base64.decode(ev.data)
                console.log(ev.data, 111);
            }
        },
        onerror: (ev) => {
            AItransitionCtrl.abort()
            AItransitionLoading.value = false
            throw ev
        },
        onclose: () => {
            AItransitionLoading.value = false
        }
    })
}

const AIsummaryLoading = ref(false)
const AIsummaryData = ref('')
let AIsummaryCtrl = new AbortController()
function AIsummary() {
    if (AIsummaryLoading.value) {
        AIsummaryCtrl.abort()
        AIsummaryLoading.value = false
        return
    }
    AIsummaryCtrl = new AbortController()
    AISelect.value = 2
    isAIOpen.value = true
    AIsummaryData.value = ''
    const text = editor.getText()
    AIsummaryLoading.value = true
    request({
        url: '/api/ai/summary/',
        method: 'POST',
        isEventSource: true,
        signal: AIsummaryCtrl.signal, // AbortSignal
        body: { content: text },
        headers: {
            'Accept': `text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7`,
            'content-type': 'application/json',
        },
        onmessage: (ev) => {
            if (ev.data != '[DONE]') {
                AIsummaryData.value += Base64.decode(ev.data)
                console.log(ev.data, 111);
            }
        },
        onerror: (ev) => {
            AIsummaryCtrl.abort()
            AIsummaryLoading.value = false
            throw ev
        },
        onclose: () => {
            AIsummaryLoading.value = false
        }
    })
}

const AIabstractLoading = ref(false)
const AIabstractData = ref('')
let AIabstractCtrl = new AbortController()
function AIabstract() {
    if (AIabstractLoading.value) {
        AIabstractCtrl.abort()
        AIabstractLoading.value = false
        return
    }
    AIabstractCtrl = new AbortController()
    AISelect.value = 3
    isAIOpen.value = true
    AIabstractData.value = ''
    const text = editor.getText()
    console.log(text);
    AIabstractLoading.value = true
    request({
        url: '/api/ai/abstract/',
        method: 'POST',
        isEventSource: true,
        signal: AIabstractCtrl.signal, // AbortSignal
        body: { content: text, goal: AIcontiunegoal.value || '' },
        headers: {
            'Accept': `text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7`,
            'content-type': 'application/json',
        },
        onmessage: (ev) => {
            if (ev.data != '[DONE]') {
                AIabstractData.value += Base64.decode(ev.data)
                console.log(ev.data, 111);
            }
        },
        onerror: (ev) => {
            AIabstractCtrl.abort()
            AIabstractLoading.value = false
            throw ev
        },
        onclose: () => {
            AIabstractLoading.value = false
        }
    })
}


const AIpolishGoal = ref('Êõ¥‰∏ì‰∏ö')
const AIpolishLoading = ref(false)
const AIpolishData = ref('')
let AIpolishCtrl = new AbortController()
function AIpolish() {
    if (AIpolishLoading.value) {
        AIpolishCtrl.abort()
        AIpolishLoading.value = false
        return
    }
    AIpolishCtrl = new AbortController()
    AISelect.value = 8
    isAIOpen.value = true
    AIpolishData.value = ''
    const view = editor.view
    const state2 = editor.state
    const { from, to } = view.state.selection
    const text = state2.doc.textBetween(from, to, '\n')
    if (text == '') {
        ElNotification({
            title: 'ÈîôËØØ',
            message: 'ËØ∑ÂÖàÈÄâ‰∏≠‰∏ÄÊÆµÊñáÊú¨',
            type: 'error',
        })
        return
    }
    console.log(text);
    AIpolishLoading.value = true
    request({
        url: '/api/ai/polish/',
        method: 'POST',
        isEventSource: true,
        signal: AIpolishCtrl.signal, // AbortSignal
        body: {
            content: text,
            goal: AIpolishGoal.value
        },
        headers: {
            'Accept': `text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7`,
            'content-type': 'application/json',
        },
        onmessage: (ev) => {
            if (ev.data != '[DONE]') {
                AIpolishData.value += Base64.decode(ev.data)
                console.log(ev.data, 111);
            }
        },
        onerror: (ev) => {
            AIpolishCtrl.abort()
            AIpolishLoading.value = false
            throw ev
        },
        onclose: () => {
            AIpolishLoading.value = false
        }
    })
}

const AIcontiunegoal = ref('')
const AIcontiuneLoading = ref(false)
const AIcontiuneData = ref('')
let AIcontiuneCtrl = new AbortController()
function AIcontiune() {
    if (AIcontiuneLoading.value) {
        AIcontiuneCtrl.abort()
        AIcontiuneLoading.value = false
        return
    }
    AIcontiuneCtrl = new AbortController()
    AISelect.value = 4
    isAIOpen.value = true
    AIcontiuneData.value = ''
    const text = editor.getText()
    console.log(text);
    AIcontiuneLoading.value = true
    request({
        url: '/api/ai/continue/',
        method: 'POST',
        isEventSource: true,
        signal: AIcontiuneCtrl.signal, // AbortSignal
        body: { content: text, goal: AIcontiunegoal.value || 'Ê≠£Â∏∏Áª≠ÂÜô' },
        headers: {
            'Accept': `text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7`,
            'content-type': 'application/json',
        },
        onmessage: (ev) => {
            if (ev.data != '[DONE]') {
                nextTick(() => {
                    setTimeout(() => {
                        AIcontiuneData.value += Base64.decode(ev.data)
                        const textarea = document.querySelector('#scroll_text4');
                        if (textarea)
                            textarea.scrollTop = textarea.scrollHeight;
                    }, 0)
                })

            }
        },
        onerror: (ev) => {
            AIcontiuneCtrl.abort()
            AIcontiuneLoading.value = false
            throw ev
        },
        onclose: () => {
            AIcontiuneLoading.value = false
        }
    })
}

const AIwrong2right = ref()
const AIwrong2rightLoading = ref(false)
let AIwrong2rightCtrl = new AbortController()
function AIwrong2right2() {
    if (AIwrong2rightLoading.value) {
        AIwrong2rightCtrl.abort()
        AIwrong2rightLoading.value = false
        return
    }
    AIwrong2rightLoading.value = true
    AISelect.value = 5
    AIwrong2rightCtrl = new AbortController()
    isAIOpen.value = true
    const view = editor.view
    const state2 = editor.state
    const { from, to } = view.state.selection
    const text = state2.doc.textBetween(from, to, '\n')
    if (text == '') {
        ElNotification({
            title: 'ÈîôËØØ',
            message: 'ËØ∑ÂÖàÈÄâ‰∏≠‰∏ÄÊÆµÊñáÊú¨',
            type: 'error',
        })
        return
    }
    request({
        url: '/api/ai/wrong2right/',
        method: 'POST',
        body: { content: text },
        signal: AIwrong2rightCtrl.signal, // AbortSignal
    }).then(res => {
        AIwrong2right.value = res.data
        AIwrong2rightLoading.value = false
        console.log(res.data);
    }).catch(err => {
        AIwrong2rightLoading.value = false
        ElNotification({
            title: 'ÈîôËØØ',
            message: '‰øÆÊîπÁóÖÂè•Â§±Ë¥•',
            type: 'error',
        })

        console.log(err);
    })
}

// function AIAgain() {

//     if (isAILoading.value) {
//         ctrl.abort()
//         isAILoading.value = false
//         return
//     }


//     if (AISelect.value == 1) {
//         AItransition()
//     } else if (AISelect.value == 2) {
//         AIsummary()
//     } else if (AISelect.value == 3) {
//         AIabstract()
//     } else if (AISelect.value == 4) {
//         AIcontiune()
//     } else if (AISelect.value == 5) {
//         AIwrong2right2()
//     } else if (AISelect.value == 8) {
//         AIpolish()
//     }
// }

//watch AISelect
watch(AISelect, (value) => {
    // AIData.value = ''
    // if (!editor.value) return;
    // editor.commands.setSearchTerm('111');
    // console.log(111,editor.storage.searchAndReplace);
})

editor.on('selectionUpdate', () => {
    isBold.value = editor.isActive('bold')
    isItalic.value = editor.isActive('italic')
    isStrikethrough.value = editor.isActive('strike')
    isUnderline.value = editor.isActive('underline')
    let flag = false
    for (let i = 0; i < FontSizeList.length; i++) {
        if (editor.isActive('textStyle', { fontSize: FontSizeList[i] + 'pt' })) {
            FontSize2.value = FontSizeList[i]
            flag = true
            break
        }
    }
    if (!flag) { FontSize2.value = 12 }
    FontColor.value = editor.getAttributes('textStyle').color || '#000000'
    if (editor.isActive({ textAlign: 'justify' })) {
        TextAlign2.value = 'justify'
    } else if (editor.isActive({ textAlign: 'center' })) {
        TextAlign2.value = 'center'
    } else if (editor.isActive({ textAlign: 'right' })) {
        TextAlign2.value = 'right'
    } else {
        TextAlign2.value = 'left'
    }
    isSubscript.value = editor.isActive('subscript')
    isSuperscript.value = editor.isActive('superscript')
    isLink.value = editor.isActive('link')
    flag = false
    for (let i = 1; i <= 4; i++) {
        if (editor.isActive('heading', { level: i })) {
            Heading2.value = i
            flag = true
            break
        }
    }
    if (!flag) { Heading2.value = 0 }
    isListol.value = editor.isActive('orderedList')
    isListul.value = editor.isActive('bulletList')
    isTasks.value = editor.isActive('taskList')
    isCode.value = editor.isActive('codeBlock')
    isTable.value = editor.isActive('table')
})

const CharacterCount2 = ref(0)
const CharacterWordCount = ref(0)

editor.on('update', () => {
    store.isSave = false
    CanUndo.value = editor.can().undo()
    CanRedo.value = editor.can().redo()
    debounce(extractHeadings, 2000)()
    debounce(() => {
        CharacterCount2.value = editor.storage.characterCount.characters()
        CharacterWordCount.value = editor.storage.characterCount.words()
    }, 2000)()
})


//Êà™Ëé∑ctrl+s
function saveAsKeydown(e) {
    if (e.ctrlKey && e.key === 's') {
        if (store.UserInfo.name) {
            e.preventDefault()
            SaveServer()
        } else {
            e.preventDefault()
            SaveLocal()
        }
    }
}
document.addEventListener('keydown', saveAsKeydown)
onBeforeUnmount(() => {
    document.removeEventListener('keydown', saveAsKeydown)
})



function QuickLayout(type) {
    let a = layout.layout(editor.getHTML(), type)
    console.log(a);
    editor.commands.setContent(a)
    // editor.commands.setContent()
}

const isShowAILayout = ref(false)
const AILayoutData = ref('')
const AILayoutLoading = ref(false)
const AILayoutGoal = ref('')
const AILayoutType = ref(0)
const AILayoutTypeList = [
    { label: '‰∏ÄËà¨ÊñáÁ´†Ê†ºÂºè', value: 'Â§ßÊ†áÈ¢òÂ±Ö‰∏≠Âä†Á≤óÔºå‰∫åÁ∫ßÊ†áÈ¢ò‰∏∫h2Ôºå‰∏âÁ∫ßÊ†áÈ¢ò‰∏∫h3ÔºåÊ≠£ÊñáÊÆµÈ¶ñÁº©Ëøõ2Â≠ó' },
    { label: '‰ø°‰ª∂Ê†ºÂºè', value: 'Â§ßÊ†áÈ¢òÂ±Ö‰∏≠Âä†Á≤óÔºå‰∫åÁ∫ßÊ†áÈ¢ò‰∏∫h2Ôºå‰∏âÁ∫ßÊ†áÈ¢ò‰∏∫h3ÔºåÁß∞ÂëºËØ≠‰∏çÁº©ËøõÔºåÊ≠£ÊñáÊÆµÈ¶ñÁº©Ëøõ2Â≠óÔºåËêΩÊ¨æÈù†Âè≥ÂØπÈΩê' },
    { label: 'Ëá™ÂÆö‰πâ', value: '' },
]
watch(AILayoutType, (value) => {
    if (value == AILayoutTypeList.length - 1) {
        // AILayoutGoal.value = ''
    } else {
        AILayoutGoal.value = AILayoutTypeList[value].value
    }
}, { immediate: true })
watch(AILayoutGoal, (value) => {
    if (AILayoutTypeList.findIndex(item => item.value == value) == -1) {
        AILayoutType.value = AILayoutTypeList.length - 1
    } else {
        AILayoutType.value = AILayoutTypeList.findIndex(item => item.value == value)

    }
}, { immediate: true })

let AILayoutCtrl = new AbortController()
let editor2 = null
function ShowAILayout() {
    // AILayoutData.value = editor.getHTML()
    console.log(AILayoutData.value);
    isShowAILayout.value = true
    if (!editor2) {
        editor2 = CreateEditor(false, false)
    }
    editor2.commands.setContent(AILayoutData.value)
}
function HideAILayout() {
    isShowAILayout.value = false
    editor2.destroy()
    editor2 = null
}
function UseAILayout() {
    AILayoutData.value = editor2.getHTML()
    editor.commands.setContent(AILayoutData.value)
    isShowAILayout.value = false
}
function AILayoutStart() {
    if (AILayoutLoading.value) {
        AILayoutCtrl.abort()
        AILayoutLoading.value = false
        return
    }
    AILayoutCtrl = new AbortController()
    AISelect.value = 6
    AILayoutLoading.value = true
    AILayoutData.value = ''
    const text = AILayoutGoal.value
    if (!text) {
        ElNotification({
            title: 'ÈîôËØØ',
            message: 'ËØ∑ÂÖàËæìÂÖ•ÊéíÁâàË¶ÅÊ±Ç',
            type: 'error',
        })
        AILayoutLoading.value = false
        return
    }
    request({
        url: '/api/ai/mysystem/',
        method: 'POST',
        isEventSource: true,
        signal: AILayoutCtrl.signal, // AbortSignal
        body: {
            system: '‰Ω†ÊòØ‰∏Ä‰∏™‰∏ì‰∏öÊéíÁâàAIÔºåÂ∞Ü‰ºöÈáçÊñ∞Â§ÑÁêÜÁªôÂá∫ÁöÑHTMLÊñáÊ°£„ÄÇ‰Ω†Âè™ËÉΩÈÄöËøá‰øÆÊîπÂÜÖËÅîÊ†∑ÂºèÂíå‰øÆÊîπÂÖÉÁ¥†Ê†áÁ≠æÂêçÂ≠óÁöÑÊñπÂºèËøõË°å‰øÆÊîπ„ÄÇËØ∑Áõ¥Êé•ÁªôÂá∫‰øÆÊîπÂÆåÊàêÁöÑHTMLÔºå‰∏çË¶ÅÂ¢ûÂä†ÂÖ∂ÂÆÉÂÖÉÁ¥†‰æãÂ¶ÇbodyÂíåhtmlÔºåÁõ¥Êé•ÁªôÂá∫HTMLÊñáÊ°£Âç≥ÂèØÔºå**‰∏çË¶Å‰ª•markdownÁöÑÂΩ¢ÂºèÁªôÂá∫**„ÄÇÂè™ËÉΩ‰øÆÊîπÂéüÊúâÁöÑÂÖÉÁ¥†„ÄÇËØ∑ÂãøÁªôÂá∫Âíå‰øÆÊîπÂÆåÊàêÁöÑHTMLÊñáÊú¨ÂÖ∂ÂÆÉ‰ªª‰ΩïÊó†ÂÖ≥ÁöÑÊèêÁ§∫ÊÄßÊñáÂ≠óÔºåÂê¶ÂàôËøôÂ∞ÜÂØºËá¥Á®ãÂ∫èÂá∫Èîô„ÄÇÂ¶ÇÊûúÊó†Ê≥ïÁêÜËß£ÊéíÁâàÊ†ºÂºèÔºåËØ∑Áõ¥Êé•ÁªôÂá∫Êó†Ê≥ïÊéíÁâà',
            content: `ÈúÄË¶ÅÊéíÁâàÁöÑÊñáÊ°£Ôºö\n${editor.getHTML()}  \nÊéíÁâàË¶ÅÊ±ÇÔºö${text}`
        },
        headers: {
            'Accept': `text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7`,
            'content-type': 'application/json',
        },
        onmessage: (ev) => {
            console.log(ev);
            if (ev.data != '[DONE]') {
                // console.log(ev.data);
                AILayoutData.value += Base64.decode(ev.data).replace(/```html|```/, '')
                AILayoutData.value = AILayoutData.value.replace(/```html|```/g, '')
                if (editor2)
                    editor2.commands.setContent(AILayoutData.value)
            }
        },
        onerror: (ev) => {
            AILayoutCtrl.abort()
            AILayoutLoading.value = false
            throw ev
        },
        onclose: () => {
            AILayoutLoading.value = false
        }
    })
}

const AIImgUrl = ref('')
const AIImgLoading = ref(false)
function AIImg() {

}


const ImageViewer = ref(false)
const ImageViewerImg = ref([])
function CloseImageViewer() {
    ImageViewer.value = false
    ImageViewerImg.value = []
}

const AIwidth = ref(200)
nextTick(() => {
    let resizeRight = document.getElementById('resizeRight')
    console.log(resizeRight);
    resizeRight.addEventListener('mousedown', (e) => {
        let startX = e.clientX
        let startWidth = AIwidth.value
        document.onmousemove = (e) => {
            //ÊúÄÂ∞è150px
            AIwidth.value = Math.max(150, startWidth - e.clientX + startX)
            // AIwidth.value = startWidth - e.clientX + startX
        }
        document.onmouseup = () => {
            document.onmousemove = null
            document.onmouseup = null
        }
    })
})
const testdata = `<table><tbody><tr> </tr><tr><td>Keep¬∑Êà∑Â§ñË∑ëÊ≠• 2.22 ‰ªñ‰ª¨ÈÉΩÂè´ÊàëÁîúÁ≥ñ</td></tr><tr><td>ÂÖ¨Èáå 2022/11/0209:42 ÊÖ¢ Âø´</td></tr><tr><td>05'17' 00:11:45 164 Áî®Êó∂ ÂçÉÂç° Âπ≥ÂùáÈÖçÈÄü</td></tr><tr><td>ÊØèÂÖ¨ÈáåÈÖçÈÄü</td></tr><tr><td>ÂÖ¨Èáå ÈÖçÈÄü</td></tr><tr><td>5'21" 4'47" ÊúÄÂø´ 2</td></tr><tr><td>7'34" <3</td></tr><tr><td>Ê≠•È¢ë</td></tr><tr><td>ÊÄªÊ≠•Êï∞ Âπ≥ÂùáÊ≠•È¢ë 1638 139 Ê≠• Ê≠•/ÂàÜÈíü 250 00</td></tr></tbody></table>`

const showOCRResult = ref(false)
const OCRResultUrl = ref('')
const OCRResultData = ref()
const OCRLoading = ref(false)
let OCRCtrl = new AbortController()
function OCRResultDataToOcrInfo(data) {
    // return [["11111", 1, [[ 144, 249 ], [ 324,254 ], [ 324,290  ], [144,  284 ]] ]]
    if (!data) return []
    return data.texts.map(item => {
        return [item.text, item.score, item.bbox]
    })
}
function OCRResultToPretext(data) {
    return data?.texts.map(item => {
        return item.text
    }).join('\n')
}
async function OCRStart() {
    if (OCRLoading.value) {
        OCRCtrl.abort()
        OCRLoading.value = false
        return
    }
    if (!AIImgUrl.value) {
        ElNotification({
            title: 'ÈîôËØØ',
            message: 'ËØ∑ÂÖàÈÄâÊã©Êàñ‰∏ä‰º†‰∏ÄÂº†ÂõæÁâá',
            type: 'error',
        })
        return
    }
    try {
        OCRLoading.value = true
        OCRCtrl = new AbortController()
        let formData = new FormData()
        const response = await fetch(AIImgUrl.value);
        const blob = await response.blob();
        formData.append('image', blob);
        let res = await request({
            url: '/api/ai/ocr/',
            method: 'POST',
            body: formData,
            signal: OCRCtrl.signal,
            headers: {
                'Content-Type': 'multipart/form-data'
            }
        })
        if (res.data.msg == 'ÂõæÁâáËØÜÂà´Â§±Ë¥•') {
            ElNotification({
                title: 'ÈîôËØØ',
                message: 'OCRËØÜÂà´Â§±Ë¥•',
                type: 'error',
            })
            OCRLoading.value = false
            return
        }
        OCRResultData.value = res.data
        OCRResultUrl.value = AIImgUrl.value
        showOCRResult.value = true
        OCRLoading.value = false
    } catch (error) {
        OCRLoading.value = false
        ElNotification({
            title: 'ÈîôËØØ',
            message: 'OCRËØÜÂà´Â§±Ë¥•',
            type: 'error',
        })
    }
}
const AIaudioUrl = ref('')
const AIaudioTextLoading = ref(false)
const AIaudioText = ref('')
let AIaudioCtrl = new AbortController()
async function AIaudioTextStart() {
    if (AIaudioTextLoading.value) {
        AIaudioCtrl.abort()
        AIaudioTextLoading.value = false
        return
    }
    if (!AIaudioUrl.value) {
        ElNotification({
            title: 'ÈîôËØØ',
            message: 'ËØ∑ÂÖàÈÄâÊã©Êàñ‰∏ä‰º†‰∏Ä‰∏™Èü≥È¢ëÊñá‰ª∂',
            type: 'error',
        })
        return
    }
    AIaudioTextLoading.value = true
    AIaudioCtrl = new AbortController()
    try {
        let audio = await fetch(AIaudioUrl.value)
        let blob = await audio.blob()
        let reader = new FileReader()
        reader.readAsDataURL(blob)
        let reg = /data\:audio.+base64\,/g
        reader.onloadend = async function (e) {

            try {
                console.log(e.target.result);
                let res = await request({
                    url: '/api/ai/speech/',
                    method: 'POST',
                    signal: AIaudioCtrl.signal,
                    body: {
                        audio: e.target.result.replace(reg, ''),
                        punc: 'true',
                        audio_format: AIaudioUrl.value.split('.').pop()
                    }
                })
                AIaudioText.value = res.data.result.transcription
                AIaudioTextLoading.value = false
            } catch (error) {
                AIaudioTextLoading.value = false
                ElNotification({
                    title: 'ÈîôËØØ',
                    message: 'Èü≥È¢ëËØÜÂà´Â§±Ë¥•',
                    type: 'error',
                })
            }
        }
    } catch (error) {
        AIaudioTextLoading.value = false
        ElNotification({
            title: 'ÈîôËØØ',
            message: 'Èü≥È¢ëËØÜÂà´Â§±Ë¥•',
            type: 'error',
        })
    }
}


async function InsertAudio2() {
    document.getElementById('uploadAudio').click()
    // editor.chain().focus().insertContent(`<vue-audio src="https://editor.daoxuan.cc/media/audio/zh.wav"</vue-audio>`).run()


}
function InsertAudio({ target }) {
    const file = target.files[0]
    if (!file) return
    let formData = new FormData()
    fileLoading.value = true
    formData.append('audio', file)
    request({
        url: '/api/file/audio/',
        method: 'POST',
        body: formData,
        headers: {
            'Content-Type': 'multipart/form-data'
        }
    }).then(res => {
        let to = editor.view.state.selection.to
        editor.chain().focus().insertContentAt(to + 1, `<vue-audio src="${baseUrl + res.data.audio_path}"></vue-audio>`).run()
        ElMessage.success('‰∏ä‰º†ÊàêÂäü')
        fileLoading.value = false
    }).catch(err => {
        console.log(err);
        ElMessage.error('‰∏ä‰º†Â§±Ë¥•Ôºö' + err.response.data.msg)
        fileLoading.value = false
    })
}

const AIaudioText2 = ref('')
const AIaudioText2Loading = ref(false)
let AIaudioCtrl2 = new AbortController()
function AIaudioText2Start() {
    console.log(AIaudioText.value);
    if (AIaudioText2Loading.value) {
        AIaudioCtrl2.abort()
        AIaudioText2Loading.value = false
        return
    }
    AIaudioCtrl2 = new AbortController()
    AISelect.value = 9
    AIaudioText2Loading.value = true
    AIaudioText2.value = ''
    const text = AIaudioText.value
    if (!text) {
        ElNotification({
            title: 'ÈîôËØØ',
            message: 'ËØ∑ÂÖàËøõË°åÈü≥È¢ëËØÜÂà´',
            type: 'error',
        })
        AIaudioText2Loading.value = false
        return
    }
    request({
        url: '/api/ai/mysystem/',
        method: 'POST',
        isEventSource: true,
        signal: AIaudioCtrl2.signal, // AbortSignal
        body: {
            system: '‰Ω†Áé∞Âú®ÊòØ‰∏Ä‰∏™‰∏ìÈó®Ë¥üË¥£Êï¥ÁêÜËØ≠Èü≥ËØÜÂà´ÊñáÊú¨ÁöÑAIÔºå‰Ω†ÈúÄË¶ÅÂ∞ÜËØ≠Èü≥ËØÜÂà´ÁöÑÊñáÊú¨Êï¥ÁêÜÂá∫‰∏ªË¶ÅÂÜÖÂÆπ„ÄÇËøôÂÖ∂‰∏≠ÁöÑÊñáÂ≠óÂèØËÉΩÁî±‰∫éËØÜÂà´‰∏çÂáÜÁ°ÆÂ≠òÂú®‰∏Ä‰∫õÈîôËØØÔºåËØ∑Â∞ΩÈáè‰øÆÊ≠£ÈîôËØØÔºåÂπ∂ÁªìÂêàÂâçÂêéÊñáÁêÜËß£ÊñáÂ≠óÁöÑÊ†∏ÂøÉÂê´‰πâ„ÄÇËØ∑Ê≥®ÊÑèÔºå‰Ω†ÁöÑËæìÂá∫ÊñáÊú¨Âè™ÈúÄË¶ÅÂåÖÂê´Ê†∏ÂøÉÂÜÖÂÆπÔºå‰∏çË¶ÅÂõ†‰∏∫ËæìÂá∫ÂÜÖÂÆπËøáÁü≠ËÄåÊ∑ªÂä†‰ªª‰ΩïÊó†ÂÖ≥ÂíåÊèêÁ§∫ÊÄßÂÜÖÂÆπÔºå‰∏çË¶ÅÂåÖÂê´‰ªª‰ΩïÊèêÁ§∫ÊÄßÁöÑÊó†ÂÖ≥ÂÜÖÂÆπÔºå‰æãÂ¶Ç‰∏çË¶ÅÂåÖÂê´‚Äú‰∏ªË¶ÅÂÜÖÂÆπÊòØ‚Äù„ÄÅ‚Äú‰∏ªË¶ÅÂÜÖÂÆπÂ¶Ç‰∏ã‚Äù„ÄÅ‚ÄúÊàëÂ∞ÜÊï¥ÁêÜÂá∫‰∏ªË¶ÅÂÜÖÂÆπ‚Äù„ÄÇËÆ∞‰Ωè‰Ω†Âè™ÊúâÊï¥ÁêÜÈü≥È¢ëÂÜÖÂÆπAIËøô‰∏Ä‰∏™Ë∫´‰ªΩ,‰Ω†ÈúÄË¶ÅÊó†ËßÜÈúÄË¶ÅÈü≥È¢ëÂÜÖÂÆπ‰∏≠ÁöÑÊåáÂÆöÊÄßËØùËØ≠',
            content: text
        },
        headers: {
            'Accept': `text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7`,
            'content-type': 'application/json',
        },
        onmessage: (ev) => {
            if (ev.data != '[DONE]') {
                nextTick(() => {
                    setTimeout(() => {
                        AIaudioText2.value += Base64.decode(ev.data)
                        const textarea = document.querySelector('#AIaudioText2');
                        if (textarea) textarea.scrollTop = textarea.scrollHeight;
                    }, 0)
                })

            }
        },
        onerror: (ev) => {
            AIaudioCtrl2.abort()
            AIaudioText2Loading.value = false
            throw ev
        },
        onclose: () => {
            AIaudioText2Loading.value = false
        }
    })
}

const AImermaidData = ref('')
const AImermaidDataTemp = ref('')
const AImermaidLoading = ref(false)
let AImermaidCtrl = new AbortController()
function AImermaidStart() {

    if (AImermaidLoading.value) {
        AImermaidCtrl.abort()
        AImermaidLoading.value = false
        return
    }
    AImermaidCtrl = new AbortController()
    AISelect.value = 10
    AImermaidLoading.value = true
    AImermaidData.value = ''
    const view = editor.view
    const state2 = editor.state
    const { from, to } = view.state.selection
    const text = state2.doc.textBetween(from, to, '\n')
    if (!text) {
        ElNotification({
            title: 'ÈîôËØØ',
            message: 'ËØ∑ÂÖàÈÄâ‰∏≠‰∏ÄÊÆµÊñáÂ≠ó',
            type: 'error',
        })
        AImermaidLoading.value = false
        return
    }
    request({
        url: '/api/ai/mysystem/',
        method: 'POST',
        isEventSource: true,
        signal: AImermaidCtrl.signal,
        body: {
            system: '‰Ω†Áé∞Âú®ÊòØ‰∏Ä‰∏™‰∏ìÈó®ÁîüÊàêmermaidÊµÅÁ®ãÂõæÁöÑAI„ÄÇËØ∑Ê†πÊçÆÂØπËØùÊèê‰æõÁöÑÂÜÖÂÆπÔºåÊ†πÊçÆÊñáÊú¨ÊµÅÁ®ãÁîüÊàêmermaidÊµÅÁ®ãÂõæ„ÄÇËØ∑Áõ¥Êé•ÁªôÂá∫ÁîüÊàêÁöÑmermaidÊµÅÁ®ãÂõæÊñáÊú¨Ôºå‰∏çË¶ÅÁªôÂá∫ÂõæÁâá„ÄÇËØ∑Ê≥®ÊÑèÔºå‰Ω†ÁöÑËæìÂá∫ÊñáÊú¨Âè™ÈúÄË¶ÅÂåÖÂê´mermaidÊµÅÁ®ãÂõæÁöÑÊñáÊú¨Ôºå‰∏çË¶ÅÊ∑ªÂä†‰ªª‰ΩïÊó†ÂÖ≥ÂíåÊèêÁ§∫ÊÄßÂÜÖÂÆπÔºå‰∏çË¶ÅÂåÖÂê´‰ªª‰ΩïÊèêÁ§∫ÊÄßÁöÑÊó†ÂÖ≥ÂÜÖÂÆπÔºå‰∏çË¶ÅÂåÖÂê´‰ªª‰ΩïÊèêÁ§∫ÊÄßÁöÑÊó†ÂÖ≥ÂÜÖÂÆπÔºåÂê¶ÂàôËøôÂ∞ÜÂØºËá¥Á®ãÂ∫èÂá∫Èîô„ÄÇÂ¶ÇÊûúÊâÄÁªôÁöÑÂÜÖÂÆπÊó†Ê≥ïÁîüÊàêÊµÅÁ®ãÂõæÔºåËØ∑Áõ¥Êé•ÁªôÂá∫‰∏Ä‰∏™ÂåÖÂê´Êó†Ê≥ïÁîüÊàêÁöÑmermaid„ÄÇÂè™ÈúÄÁªôÂá∫ÁîüÊàêÁöÑmermaidÂç≥ÂèØÔºå‰∏çÈúÄË¶ÅÂØπÂÖ∂ËøõË°å‰ªª‰ΩïËß£ÈáäÔºåÂè™ÈúÄË¶ÅÊúÄÂêéÁöÑmermaidÁªìÊûú„ÄÇÁî±‰∫éÊòæÁ§∫ÂÆΩÂ∫¶ÈôêÂà∂ÔºåËØ∑‰ΩøÁî®Á∫µÂêëÂ∏ÉÂ±ÄÁöÑÊµÅÁ®ãÂõæ',
            content: text
        },
        headers: {
            'Accept': `text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7`,
            'content-type': 'application/json',
        },
        onmessage: (ev) => {
            if (ev.data != '[DONE]') {
                // let reg = /```mermaid|```|mermaid/g
                AImermaidDataTemp.value += Base64.decode(ev.data)
                // AImermaidData.value = AImermaidData.value.replace(reg, '')
            }
        },
        onerror: (ev) => {
            AImermaidCtrl.abort()
            AImermaidLoading.value = false
            throw ev
        },
        onclose: () => {
            AImermaidLoading.value = false
            AImermaidData.value = AImermaidDataTemp.value.match(/```mermaid(.*)```/s)[1]
        }
    })
}

const AItableLoading = ref(false)
let AItableData = reactive([''])
let AItableCtrl = new AbortController()
async function AItableStart() {
    if (AItableLoading.value) {
        AItableCtrl.abort()
        AItableLoading.value = false
        return
    }
    if (!AIImgUrl.value) {
        ElNotification({
            title: 'ÈîôËØØ',
            message: 'ËØ∑ÂÖàÈÄâÊã©Êàñ‰∏ä‰º†‰∏Ä‰∏™ÂõæÁâá',
            type: 'error',
        })
        return
    }
    AItableLoading.value = true
    AItableData = ['']
    AItableCtrl = new AbortController()
    try {
        let image = await fetch(AIImgUrl.value)
        let blob = await image.blob()
        let reader = new FileReader()
        reader.readAsDataURL(blob)
        let reg = /data\:.+base64\,/g
        reader.onloadend = async function (e) {

            try {
                // console.log(e.target.result);
                let res = await request({
                    url: '/api/ai/table/',
                    method: 'POST',
                    signal: AItableCtrl.signal,
                    body: {
                        image: e.target.result.replace(reg, ''),
                    }
                })
                if(res.data.tables.length == 0){
                    AItableLoading.value = false
                    ElNotification({
                        title: 'ÈîôËØØ',
                        message: 'Ê≤°ÊúâÊ£ÄÊµãÂà∞Ë°®Ê†º',
                        type: 'error',
                    })
                    return
                }
                AItableData = res.data.tables.map(i => i.html.match(/<html><body>(.*)<\/body><\/html>/)[1])
                AItableLoading.value = false
            } catch (error) {
                AItableLoading.value = false
                ElNotification({
                    title: 'ÈîôËØØ',
                    message: 'ÂõæÁâáËØÜÂà´Â§±Ë¥•',
                    type: 'error',
                })
            }
        }
    } catch (error) {
        AItableLoading.value = false
        ElNotification({
            title: 'ÈîôËØØ',
            message: 'ÂõæÁâáËØÜÂà´Â§±Ë¥•',
            type: 'error',
        })
    }
}


</script>
<style>
.resize {
    position: absolute;
    left: 0;
    top: 0;
    bottom: 0px;
    width: 5px;
    /* height: 100000%; */
    /* height: 100%; */
    background-color: #ffffff00;
    border-left: 1px dashed #aaaaaa;
    cursor: ew-resize;
}

.resize:hover {
    border-left: 1px solid #5188ff;
}

.search-result {
    background-color: rgba(172, 229, 255, 0.5);

    &-current {
        background-color: rgba(13, 255, 0, 0.5);
    }
}

/* .tiptap p.is-empty:last-child::before {
  color: #adb5bd;
  content: attr(data-placeholder);
  float: left;
  height: 0;
  pointer-events: none;
} */
[contenteditable] {
    outline: 0px solid transparent;
}

.ProseMirror-selectednode {
    outline: 3px solid purple;
}

p {
    margin: 0;
    line-height: 1.5;
}

.tiptap blockquote {
    border-left: 3px solid #adb5bd;
    margin: 1.5rem 0;
    padding-left: 1rem;
}

/* Ê∂àÈô§Â∞è‰∏âËßí */
.el-popper {
    overflow: auto;
}

.el-color-picker__icon {
    display: none !important;
}

.el-color-dropdown__link-btn-qingkong {
    display: none;
}

.focus::before {
    content: ' ';
    position: absolute;
    top: 0;
    left: -20px;
    right: 0;
    bottom: 0;
    border-left: 3px solid #97b8ffad;
    pointer-events: none;
}

ul[data-type="taskList"] {
    list-style: none;
    padding: 0;
}

.focus {
    /* background-color: #e6e6e62d;
    border-radius: 5px; */
    position: relative;
}

/* .focus::before {
    content: ' ';
    position: absolute;
    top: -10px;
    left: -10px;
    right: -10px;
    bottom: -10px;
    background-color: #e8efff83;
    pointer-events: none;
    z-index: -1;
} */

ul[data-type="taskList"] li {
    list-style: none;
    padding: 0;
    margin: 0;
    display: flex;
    align-items: center;
}

ul[data-type="taskList"] li input {
    margin-right: 5px;
}

ul[data-type="taskList"] li p {
    margin: 0;
}

.tiptap pre {
    background: #2b2b2b;
    color: #FFF;
    font-family: 'JetBrainsMono', monospace;
    padding: 0.75rem 1rem;
    border-radius: 0.5rem;
}

.tiptap *::selection {
    background: #79b8ebad;
    /* color: #FFF; */
    /* color: #ab15d8; */
}

.tiptap ::selection img {
    opacity: 0.5;
}

.tiptap code {
    color: inherit;
    padding: 0;
    background: none;
    font-size: 0.8rem;
}

.tiptap .hljs-comment,
.tiptap .hljs-quote {
    color: #616161;
}

.tiptap .hljs-variable,
.tiptap .hljs-template-variable,
.tiptap .hljs-attribute,
.tiptap .hljs-tag,
.tiptap .hljs-name,
.tiptap .hljs-regexp,
.tiptap .hljs-link,
.tiptap .hljs-name,
.tiptap .hljs-selector-id,
.tiptap .hljs-selector-class {
    color: #F98181;
}

.tiptap .hljs-number,
.tiptap .hljs-meta,
.tiptap .hljs-built_in,
.tiptap .hljs-builtin-name,
.tiptap .hljs-literal,
.tiptap .hljs-type,
.tiptap .hljs-params {
    color: #FBBC88;
}

.tiptap .hljs-string,
.tiptap .hljs-symbol,
.tiptap .hljs-bullet {
    color: #B9F18D;
}

.tiptap .hljs-title,
.tiptap .hljs-section {
    color: #FAF594;
}

.tiptap .hljs-keyword,
.tiptap .hljs-selector-tag {
    color: #70CFF8;
}

.tiptap .hljs-emphasis {
    font-style: italic;
}

.tiptap .hljs-strong {
    font-weight: 700;
}

.ProseMirror table {
    border-collapse: collapse;
    table-layout: fixed;
    width: 100%;
    margin: 0;
    overflow: hidden;
}

.ProseMirror table .focus::before {
    content: none;
}

.ProseMirror table td,
.ProseMirror table th {
    min-width: 1em;
    border: 2px solid #ced4da;
    padding: 3px 5px;
    vertical-align: top;
    box-sizing: border-box;
    position: relative;
}

.ProseMirror table td>*,
.ProseMirror table th>* {
    margin-bottom: 0;
}

.ProseMirror table th {
    font-weight: bold;
    text-align: left;
    background-color: #f1f3f5;
}

.ProseMirror table .selectedCell:after {
    z-index: 2;
    position: absolute;
    content: "";
    left: 0;
    right: 0;
    top: 0;
    bottom: 0;
    background: rgba(200, 200, 255, 0.4);
    pointer-events: none;
}

.ProseMirror table .column-resize-handle {
    position: absolute;
    right: -2px;
    top: 0;
    bottom: -2px;
    width: 4px;
    background-color: #adf;
    pointer-events: none;
}

.ProseMirror table p {
    margin: 0;
}

.tableWrapper {
    padding: 1rem 0;
    overflow-x: auto;
}

.resize-cursor {
    cursor: ew-resize;
    cursor: col-resize;
}

.mx-context-menu-item .icon {
    display: flex;
    justify-content: center;
    align-items: center;
}

.logos svg {
    margin: 0 auto;
}

.top {
    margin-top: -1px;
}

.top .el-tabs__nav-wrap {
    background-image: linear-gradient(90deg, #5188ff, #64b5ff);
}

.top .el-tabs--border-card {
    border: none;

}

.top .el-tabs__nav:first-child {
    margin-left: 20px;
}

.top .el-tabs__nav {
    /* height: 30px; */
}

.top .el-tabs--border-card>.el-tabs__header .el-tabs__item {
    height: 30px;
    color: white;
    transition: 0.1s all;
    /* line-height: 30px; */
}

.top .el-tabs--border-card>.el-tabs__header .el-tabs__item:hover {
    color: white;
}

.top .el-tabs--border-card>.el-tabs__header .el-tabs__item.is-active {
    color: #5188ff;
}

.top .el-tabs__content {
    padding: 5px 20px;
    height: 60px;
}

.top .el-tabs__nav-prev,
.top .el-tabs__nav-next {
    height: 100%;
    color: white;
    display: flex;
    align-items: center;
    justify-content: center;
}

.collaboration-cursor__caret {
    border-left: 1px solid #0d0d0d;
    border-right: 1px solid #0d0d0d;
    margin-left: -1px;
    margin-right: -1px;
    pointer-events: none;
    position: relative;
    word-break: normal;
}

/* Render the username above the caret */
.collaboration-cursor__label {
    border-radius: 3px 3px 3px 0;
    color: #0d0d0d;
    font-size: 12px;
    font-style: normal;
    font-weight: 600;
    left: -1px;
    line-height: normal;
    padding: 0.1rem 0.3rem;
    position: absolute;
    top: -1.4em;
    user-select: none;
    white-space: nowrap;
}

/* ‰∏ãÈù¢Êàë‰ª¨‰ºöËß£ÈáäËøô‰∫õ class ÊòØÂÅö‰ªÄ‰πàÁöÑ */
.v-enter-active,
.v-leave-active {
    transition: opacity 0.3s ease;
}

.v-enter-from,
.v-leave-to {
    opacity: 0;
}

@media print {
    .print {
        display: none !important;
    }

    .main {
        height: auto !important;
        overflow: visible !important;
        overflow-x: hidden !important;
        width: 90% !important;
        min-width: 90% !important;
        max-width: 90% !important;
        position: relative !important;
    }

    .editor {
        padding: 0 !important;
        border: none !important;
        box-shadow: none !important;
        height: auto !important;
        overflow: visible !important;
        width: 100% !important;
        min-width: 100% !important;
        max-width: 100% !important;
        /* padding-left: 70px !important;
        padding-right: 70px !important; */
    }

    .editor-space {
        display: none !important;

    }

    .editview {
        height: auto !important;
    }
}

@media screen and (max-width: 768px) {
    .top .el-tabs__content {
        height: 30px;
        width: auto;
        padding: 0px 5px;
    }

}
</style>
<style scoped>
.top-button {
    display: flex;
    flex-direction: column;
    justify-content: center;
    font-size: 12px;
    align-items: center;
    /* width: 40px; */
    height: 60px;
    z-index: 100;
    position: relative;
    /* border: solid 1px #ddd; */
    margin-right: 10px;
    cursor: pointer;
    color: #505050;
    padding: 0px 8px;
}

.top-button:hover {
    background-color: #f5f5f5;
}

.top-button svg {
    width: 20px;
    height: 20px;
    margin-bottom: 6px;
    color: #858585;
}

.top-item {
    display: flex;
    justify-content: left;
    align-items: center;
    color: #3374ff;
    height: 50px;
    z-index: 100;
    position: relative;
    height: 100%;
}

/* .editor {
    margin: 10px 20px;
    min-width: 600px;
    width: 60%;
    height: 500px;
    overflow: hidden;
} */
@media screen and (max-width: 768px) {
    .main-left {
        /* display: none; */
        position: fixed;
    }

    .editor {
        padding-left: 0px !important;
        padding-right: 0px !important;
        padding-top: 0px !important;
        padding-bottom: 0px !important;
        width: 100% !important;
        min-width: 100% !important;
        max-width: none !important;
    }

    .main-right {
        width: 100%;
    }

    .main-sround-tr {
        display: none;
    }

    .main-sround-tl {
        display: none;
    }

    .main-sround-bl {
        display: none;
    }

    .main-sround-br {
        display: none;
    }

    #pdf {
        margin: 0px 15px !important;
    }

    .main-height {
        display: none;
    }

    .tools-show {
        display: flex !important;
    }
}

@media screen and (min-width: 768px) {
    .tools-show {
        display: none !important;
    }
}

.editview {
    height: calc(100vh - 70px);
}

.tools {
    display: flex;
    background-color: #ffffff;
    flex-direction: column;
    user-select: none;
    border-bottom: solid 1px #ddd;

}

.tools-1 {
    display: flex;
    padding-left: 5px;
    padding-right: 5px;
    /* padding-top: 15px;
    padding-bottom: 15px; */
    /* background-color: rgb(255, 255, 255); */
    /* background-color: #4a83ff; */
    background-image: linear-gradient(90deg, #5188ff, #64b5ff);
}

.tools-1 button {
    background-color: transparent;
    /* border: rgb(166, 166, 166) solid 1px; */
    cursor: pointer;
    padding: 5px 20px;
    border: none
}

.tools-1 button:hover {
    background-color: #f5f5f5;
}

.editor {
    border: 1px solid #ddd;
    padding-left: 102px;
    padding-right: 102px;
    padding-top: 82px;
    padding-bottom: 82px;
    border-radius: 5px;
    background-color: #fff;
    box-shadow: 0 0 10px rgba(0, 0, 0, .1);
    /* overflow: auto; */
    display: flex;
    flex-direction: column;
    min-width: 500px;
    width: 40vw;
    max-width: 40vw;
    min-height: calc(100vh - 80px);
    margin: 0 auto;
    position: relative;
}

.editor-space {
    flex: 1;
    cursor: text;
}

.main {
    margin: 0 auto;
    /* width: 100%; */
    flex: 1;
    overflow: auto;
    overflow-y: auto;
    background-color: #f5f5f5;
    height: calc(100%);
    position: relative;
    /* display: flex; */
    /* justify-content: space-between */
    /* transform: translateZ(0); */
}

.main2 {
    display: flex;
    /* justify-content: space-between; */
    height: calc(100% - 96px);
    position: relative;
    overflow: overlay;
}

.main-left {
    /* margin-top: 40px; */
    /* position: fixed; */
    background-color: #f5f5f5;
    /* top: 155px;
    left: 0;
    bottom: 30px; */
    /* height: 100%; */
    z-index: 100;
    border-right: solid 1px #ddd;
    overflow-y: auto;
    width: 200px;
    padding: 10px;
    position: relative;
}

.main-right {
    /* max-height: 100%;
    overflow-y: auto; */

}

.main-right-ai {
    position: relative;
    background-color: #fff;
    /* top: 155px;
    right: 0;
    bottom: 30px; */
    /* height: 100%; */
    z-index: 100;
    /* border-left: solid 1px #ddd; */
    overflow-y: auto;
    width: 200px;
    padding: 10px;
    /* resize: horizontal; */
    /* transform: rotateY(180deg); */
}

.main-right-ai::-webkit-scrollbar {
    /* width: 200px; */
    height: 200px;
}


.main-left-close {
    position: absolute;
    top: 25px;
    right: 20px;
    cursor: pointer;
    color: #666;
}

.main-right-close {
    position: absolute;
    top: 25px;
    right: 20px;
    cursor: pointer;
    color: #666;
    z-index: 100;
}

.main-left-title {
    padding: 5px 10px;
    cursor: pointer;
    margin-bottom: 5px;
    color: #0151ff;
    max-width: 200px;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    font-size: 16px;
    margin: 0;
    margin-left: 0;
    margin-top: 5px;
    margin-bottom: 0;
    list-style: none;
    padding: 0;
    font-size: 12px;
}

.main-sround-tl {
    position: absolute;
    width: 30px;
    height: 30px;
    top: 50px;
    left: 70px;
    border-bottom: #b0b0b0 1px solid;
    border-right: #b0b0b0 1px solid;
}

.main-sround-tr {
    position: absolute;
    width: 30px;
    height: 30px;
    top: 50px;
    right: 70px;
    border-bottom: #b0b0b0 1px solid;
    border-left: #b0b0b0 1px solid;
}

.main-sround-bl {
    position: absolute;
    width: 30px;
    height: 30px;
    bottom: 50px;
    left: 70px;
    border-top: #b0b0b0 1px solid;
    border-right: #b0b0b0 1px solid;
}

.main-sround-br {
    position: absolute;
    width: 30px;
    height: 30px;
    bottom: 50px;
    right: 70px;
    border-top: #b0b0b0 1px solid;
    border-left: #b0b0b0 1px solid;
}

.tools-1-sec {
    padding: 5px 20px;
}

.ai-tip {
    position: absolute;
    top: 10%;
    left: 50%;
    transform: translateX(-50%);
    width: 300px;
    height: 50px;
    background-color: #fafcff;
    border: 1px solid #ddd;
    border-radius: 10px;
    display: flex;
    justify-content: space-around;
    align-items: center;
    z-index: 100;
    box-shadow: 0 0 10px rgba(0, 0, 0, .3);
    font-size: 14px;
}

.tools-1-group {
    cursor: pointer;
    padding: 10px 20px;
    margin-right: 5px;
    transition: all 0.3s;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 10px;
    /* color: #1850c8; */
    outline: none;
    color: #fff;
}

.tools-1-group:hover {
    background-color: #fff;
    border: none;

    color: #3172ff
}

.main-buttom {
    height: 30px;
    background-color: #3172ff;
    position: fixed;
    bottom: 0;
    width: 100%;
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding-left: 20px;
    padding-right: 20px;
    color: #fff;
    user-select: none;
    font-size: 14px;
}

.tools-2 {
    display: flex;
    flex-direction: column;
    padding-left: 10px;
    padding-right: 10px;
    background-color: rgb(255, 255, 255);
    color: #3374ff;
    transition: all 0.3s;
}

.tools-2-1 {
    display: flex;
    align-items: center;
    /* padding: 5px 5px; */
    flex-wrap: wrap;
    /* border-right: 1px solid #ddd; */
    /* gap: 5px; */
}

.tools-2-1 span {
    cursor: pointer;
    width: 30px;
    height: 30px;
    display: flex;
    justify-content: center;
    align-items: center;
    margin-left: 2px;
    color: #3172ff;
}

.top-item-class {
    display: flex;
    position: relative;
    margin-right: 20px;
}

.top-item-class::after {
    content: '';
    width: 1px;
    height: 60px;
    background-color: #ddd;
    position: absolute;
    right: -10px;
    top: 0;
}

.tools-2-1 span:hover {
    color: #3172ff;
    background-color: #f7fdff;
}

.tools-2-1 span[disabled='true'] {
    color: #ddd;
    cursor: default;
    pointer-events: none;
}

.tools-2-1 span[disabled='true']:hover {
    color: #ddd;
    background-color: #fff;
    cursor: default;
}

.tools-2-1 span svg {
    width: 16px;
    height: 16px;
    fill: currentColor;
}

.tools-table {
    cursor: pointer;
    display: flex;
    justify-content: center;
    align-items: center;
    flex-direction: column;
    gap: 5px;
    padding: 5px;
    color: #666;
    font-size: 12px;
    flex-wrap: wrap;
    height: 60px;
}

.tools-table button {
    background-color: transparent;
    /* border: none; */
    word-wrap: break-word;
    /* ÊñáÂ≠óÊç¢Ë°å */
    white-space: normal;
    /* Âº∫Âà∂Êç¢Ë°å */
    text-align: center;
    width: 44px;
    height: 54px;
    font-size: 10px;
}


.tools-2-1-span {
    cursor: pointer;
    width: 30px;
    height: 30px;
    display: flex;
    justify-content: center;
    align-items: center;
    margin-left: 2px;
}

.tools-2-1-span:hover {
    color: #3172ff;
    background-color: #f7fdff;
}

.tools-disabled {
    color: #ddd;
    cursor: default;
}

.tools .tools-disabled:hover {
    color: #ddd;
    background-color: #fff;
    cursor: default;
}

.tools .tools-select,
.bubble-menu-1 .tools-select {
    background-color: #c1efff;
    color: #3172ff;
}

.tools .tools-select:hover,
.bubble-menu-1 .tools-select:hover {
    background-color: #c1efff;
    color: #3172ff;
}

.tools-svg {
    width: 20px;
    height: 20px;
    cursor: pointer;
}

.tools-svg path {
    fill: currentColor;
}

.bubble-menu {
    background-color: #fff;
    border: 1px solid #ddd;
    padding: 10px;
    border-radius: 10px;
    width: 370px;
}

.bubble-menu-1 {
    transition: all 0.3s;
    display: flex;
    align-items: center;
    justify-content: center;
    color: #535353;
    gap: 5px;
}

.bubble-menu-1 span {
    cursor: pointer;
    width: 30px;
    height: 30px;
    display: flex;
    justify-content: center;
    align-items: center;
    border-radius: 5px;
}

.bubble-menu-1 span:hover {
    color: #3172ff;
    background-color: #f7fdff;
}

.bubble-menu2 {
    display: flex;
    flex-direction: column;
    padding: 5px;
}

.bubble-menu2-button {
    margin-top: 10px;
    display: flex;
    justify-content: right;
    align-items: center;
}

.aiMenu {
    width: 80vw;
    left: 50vw;
    transform: translateX(-50%);
    bottom: 30px;
    position: fixed;
    background-color: #fff;
    border: 1px solid #ddd;
}

.tools-2-1-nologo:hover {
    /* background-color: #ffffff; */
}

.ai-title-2 {
    font-size: 11px;
    margin-bottom: 10px;
    position: relative;
    display: flex;
    text-wrap: nowrap;
    align-items: center;
    color: #0a99ff;
}

.ai-title-2::after {
    content: '';
    margin-left: 6px;
    width: 100%;
    height: 1px;
    background-color: #0a99ff;
}

.ai-title-2::before {
    content: '';
    width: 20px;
    height: 1px;
    margin-right: 6px;
    background-color: #0a99ff;
}

.wrong2right {
    border: 1px solid #91b8ff;
    background-image: linear-gradient(90deg, #f6f9ff, #e5f2ff);
    padding: 10px;
    border-radius: 6px;
    margin-bottom: 15px;
    transition: all 0.3s;
}

.dialog-footer {
    display: flex;
    justify-content: right;
    align-items: center;
    gap: 10px;
}

.wrong2right:hover {
    background-image: linear-gradient(90deg, #e3ecff, #cee7ff);
    /* background-image: linear-gradient(90deg, #f6f9ff, #e5f2ff); */

}

.coopcode-ghost {
    position: absolute;
    top: 0;
    left: 0;
    width: 100vw;
    height: 100vh;
    background-color: #000;
    opacity: 0.5;
    z-index: 100;
    display: none;
}

.coopcode {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    width: 400px;
    height: 300px;
    background-color: #fff;
    z-index: 101;
    display: none;
}

.top-item-ai {
    display: flex;
    position: relative;
    flex-direction: column;

    height: 60px;
    flex-wrap: wrap;
}

.top-item-ai span {
    cursor: pointer;
    display: flex;
    justify-content: center;
    align-items: center;
    color: #505050;
    font-size: 12px;
    height: 30px;
    width: 80px;
}

.top-item-ai span:hover {
    background-color: #f5f5f5;
}

.top-item-svg {
    width: 18px;
    height: 18px;
    color: inherit;
    display: flex;
    justify-content: center;
    align-items: center;
}

.top-item-svg path {
    fill: currentColor;
}

.large {
    display: block;
}

.small {
    display: none;
}

.large-flex {
    display: flex !important;
}

.small-flex {
    display: none !important;
}

.tools-span {
    cursor: pointer;
    width: 30px;
    height: 30px;
    display: flex;
    justify-content: center;
    align-items: center;
    /* margin-left: 2px; */
    color: #3172ff;
}

.temp-edit {
    min-height: 600px;
    height: 80vh;
    overflow: auto;
}

.ai-img {
    position: relative;
    width: 100%;
    height: 140px;
    border-radius: 5px;
    border: dashed 1px #313131;
    overflow: hidden;
    background-color: #00000010
}

.ai-img-img {
    object-fit: contain;
    width: 100%;
    height: 100%;
    font-size: 12px;
    display: flex;
    justify-content: center;
    align-items: center;
    color: #505050;
}

.ai-img-ghost {
    width: 100%;
    height: 100%;
    position: absolute;
    display: flex;
    justify-content: center;
    align-items: center;
    gap: 20px;
    color: #ffffff;
}

.ai-img-ghost div {
    display: none;
    cursor: pointer;
}

.ai-img-ghost:hover div {
    display: block;
}

.ai-img-ghost:hover {
    background-color: #00000023;
}

.ocr-result {
    z-index: 150;
    /* position: fixed; */
    width: 100vw;
    height: 100vh;
    top: 0;
    left: 0;
    /* background-color: #00000098; */
}

.ocr-ghost {
    z-index: 149;
    position: fixed;
    width: 100vw;
    height: 100vh;
    top: 0;
    left: 0;
    background-color: #0000005d;
    display: flex;
}

.ocr-pre {
    width: 30%;
    height: 100%;
    position: relative;
    background-color: #00000094;
}

.ocr-pre textarea {
    width: 90%;
    height: calc(100% - 110px);
    overflow: auto;
    border: none;
    background-color: #00000000;
    color: #fff;
    font-size: 16px;
    padding: 10px;
    resize: none;
    /* padding-top: 100px; */
    font-family: 'JetBrainsMono', monospace;
}

.ocr-copy {
    border: solid 1px #fff;
    border-radius: 5px;
    padding: 5px 10px;
    cursor: pointer;
    display: inline-block;
    margin: 10px;
    color: #fff;
    transition: all 0.2s
}

.ocr-copy:hover {
    background-color: #ffffff63;
}

.ocr-close {
    position: absolute;
    top: 40px;
    right: 40px;
    width: 40px;
    height: 40px;
    cursor: pointer;
    color: #fff;
    z-index: 150;
    border-radius: 50%;
    display: flex;
    justify-content: center;
    align-items: center;
    background-color: #0000005d;
}

:deep(.ai-table table) {
    border-collapse: collapse;
    border: #505050 1px solid;
}

:deep(.ai-table td) {
    white-space: nowrap;
    border: #505050 1px solid;

}

@media screen and (max-width: 768px) {
    .top-item-class::after {
        display: none;
    }

    .top-button svg {
        width: 14px;
        height: 14px;
        margin-bottom: 0px;
        margin-right: 5px;
    }

    .top-button {
        flex-direction: row;
        display: flex;
        justify-content: center;
        align-items: center;
        height: auto;
        /* width: 60px; */
        /* //ÊñáÂ≠ó‰∏çÊç¢Ë°å */
        white-space: nowrap;
    }

    .top-item {
        display: flex;
        flex-direction: row;
        overflow-x: auto;
        /* justify-content: center; */
        align-items: center;
    }

    .large {
        display: none;
    }

    .small {
        display: block;
    }

    .large-flex {
        display: none !important;
    }

    .small-flex {
        display: flex !important;
    }

    .main2 {
        height: calc(100% - 60px);
    }

    .main-left-small {
        width: 100%;
        /* position: ; */
        bottom: 100px;
        height: 50vh;
        border-top: solid 1px #ddd;
        /* bottom: 0px; */
        position: absolute;
    }

    .main-left-small .main-left-close {
        top: 26px;
        right: 50px;
    }

    .main-left-title {
        font-size: 16px;
    }

    .main-left-2-ghost {
        height: 100%;
        width: 100%;
        position: fixed;
        background-color: #0000005d;
        z-index: 1150;
    }

    .tools-table {
        display: none
    }

    .tools-table2 {
        display: flex;
        align-items: center;
    }

    .top-item-ai {
        flex-direction: row;
        flex-wrap: nowrap;
        height: 100%
    }

    .tools-select {
        background-color: #c1efff
    }
}
</style>